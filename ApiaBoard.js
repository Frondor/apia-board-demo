!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ApiaBoard=e():t.ApiaBoard=e()}(window,function(){return(r={},i.m=n=[function(t,e,n){if(function(e,a,n,E){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a,n=n&&n.hasOwnProperty("default")?n.default:n,E=E&&E.hasOwnProperty("default")?E.default:E,Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0==r)return!1;var i,o,s=0|e,a=Math.max(0<=s?s:r-Math.abs(s),0);for(;a<r;){if((i=n[a])===(o=t)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return o;i++}}}),Array.from||(Array.from=function(){var e=Object.prototype.toString,u=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1,l=function(t){var e=function(t){var e=Number(t);if(isNaN(e)){return 0}return 0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),n)};return function(t){var e=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,r=1<arguments.length?arguments[1]:void 0;if(void 0!==r){if(!u(r))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=arguments[2])}for(var i,o=l(e.length),s=u(this)?Object(new this(o)):new Array(o),a=0;a<o;)i=e[a],s[a]=r?void 0===n?r(i,a):r.call(n,i,a):i,a+=1;return s.length=o,s}}()),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return i;i++}return-1}}),function(){var t=void 0!==e?e:this,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u(t){this.message=t}(u.prototype=new Error).name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var e,n,r=String(t),i=0,o=a,s="";r.charAt(0|i)||(o="=",i%1);s+=o.charAt(63&e>>8-i%1*8)){if(255<(n=r.charCodeAt(i+=.75)))throw new u("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|n}return s}),t.atob||(t.atob=function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new u("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,o=0,s="";r=e.charAt(o++);~r&&(n=i%4?64*n+r:r,i++%4)&&(s+=String.fromCharCode(255&n>>(-2*i&6))))r=a.indexOf(r);return s})}(),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isNaN=Number.isNaN||function(t){return t!=t},String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),function(){function r(t,e){return this.slice(t,e)}function i(t,e){arguments.length<2&&(e=0);for(var n=0,r=t.length;n<r;++n,++e)this[e]=255&t[n]}function t(t){var e;if("number"==typeof t){e=new Array(t);for(var n=0;n<t;++n)e[n]=0}else e=t.slice(0);return e.subarray=r,(e.buffer=e).byteLength=e.length,e.set=i,"object"==typeof t&&t.buffer&&(e.buffer=t.buffer),e}"undefined"==typeof Uint8Array&&"undefined"!=typeof window&&(window.Uint8Array=t,window.Uint32Array=t,window.Int32Array=t)}(),"undefined"!=typeof XMLHttpRequest&&("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype||Object.defineProperty(XMLHttpRequest.prototype,"response",{get:function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}}));var r=Math,O=r.abs,l=r.cos,c=r.sin,R=r.sqrt,D=r.min,j=r.max,h=r.atan2,i=r.round,o=r.floor,s=r.PI,M=r.pow,t={curveThroughPoints:function(t){return console.warn("deprecated"),new C(v.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e,n=[],r=[],i=t.length-1;if(1==i)return n[0]=new S((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),r[0]=new S(2*n[0].x-t[0].x,2*n[0].y-t[0].y),[n,r];var o=[];for(e=1;e<i-1;e++)o[e]=4*t[e].x+2*t[e+1].x;o[0]=t[0].x+2*t[1].x,o[i-1]=(8*t[i-1].x+t[i].x)/2;var s=this.getFirstControlPoints(o);for(e=1;e<i-1;++e)o[e]=4*t[e].y+2*t[e+1].y;o[0]=t[0].y+2*t[1].y,o[i-1]=(8*t[i-1].y+t[i].y)/2;var a=this.getFirstControlPoints(o);for(e=0;e<i;e++)n.push(new S(s[e],a[e])),e<i-1?r.push(new S(2*t[e+1].x-s[e+1],2*t[e+1].y-a[e+1])):r.push(new S((t[i].x+s[i-1])/2,(t[i].y+a[i-1])/2));return[n,r]},getCurveDivider:function(t,e,n,r){console.warn("deprecated");var i=new v(t,e,n,r);return function(t){var e=i.divide(t);return[{p0:e[0].start,p1:e[0].controlPoint1,p2:e[0].controlPoint2,p3:e[0].end},{p0:e[1].start,p1:e[1].controlPoint1,p2:e[1].controlPoint2,p3:e[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,n=[],r=[],i=2;n[0]=t[0]/i;for(var o=1;o<e;o++)r[o]=1/i,i=(o<e-1?4:3.5)-r[o],n[o]=(t[o]-n[o-1])/i;for(o=1;o<e;o++)n[e-o-1]-=r[e-o]*n[e-o];return n},getInversionSolver:function(t,e,n,r){console.warn("deprecated");var i=new v(t,e,n,r);return function(t){return i.closestPointT(t)}}},v=function(t,e,n,r){return this instanceof v?t instanceof v?new v(t.start,t.controlPoint1,t.controlPoint2,t.end):(this.start=new S(t),this.controlPoint1=new S(e),this.controlPoint2=new S(n),void(this.end=new S(r))):new v(t,e,n,r)};v.throughPoints=function(){function u(t){var e=t.length,n=[],r=[],i=2;n[0]=t[0]/i;for(var o=1;o<e;o++)r[o]=1/i,i=(o<e-1?4:3.5)-r[o],n[o]=(t[o]-n[o-1])/i;for(o=1;o<e;o++)n[e-o-1]-=r[e-o]*n[e-o];return n}return function(t){if(!t||Array.isArray(t)&&t.length<2)throw new Error("At least 2 points are required");for(var e=function(t){var e,n=[],r=[],i=t.length-1;if(1==i)return n[0]=new S((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),r[0]=new S(2*n[0].x-t[0].x,2*n[0].y-t[0].y),[n,r];var o=[];for(e=1;e<i-1;e++)o[e]=4*t[e].x+2*t[e+1].x;o[0]=t[0].x+2*t[1].x,o[i-1]=(8*t[i-1].x+t[i].x)/2;var s=u(o);for(e=1;e<i-1;++e)o[e]=4*t[e].y+2*t[e+1].y;o[0]=t[0].y+2*t[1].y,o[i-1]=(8*t[i-1].y+t[i].y)/2;var a=u(o);for(e=0;e<i;e++)n.push(new S(s[e],a[e])),e<i-1?r.push(new S(2*t[e+1].x-s[e+1],2*t[e+1].y-a[e+1])):r.push(new S((t[i].x+s[i-1])/2,(t[i].y+a[i-1])/2));return[n,r]}(t),n=[],r=e[0].length,i=0;i<r;i++){var o=new S(e[0][i].x,e[0][i].y),s=new S(e[1][i].x,e[1][i].y);n.push(new v(t[i],o,s,t[i+1]))}return n}}(),v.prototype={bbox:function(){for(var t,e,n,r,i,o,s,a,u=this.start,l=this.controlPoint1,c=this.controlPoint2,h=this.end,f=u.x,d=u.y,p=l.x,g=l.y,v=c.x,m=c.y,y=h.x,b=h.y,w=new Array,x=new Array,A=[new Array,new Array],_=0;_<2;++_)if(n=0===_?(e=6*f-12*p+6*v,t=-3*f+9*p-9*v+3*y,3*p-3*f):(e=6*d-12*g+6*m,t=-3*d+9*g-9*m+3*b,3*g-3*d),O(t)<1e-12){if(O(e)<1e-12)continue;0<(r=-n/e)&&r<1&&x.push(r)}else a=R(s=e*e-4*n*t),s<0||(0<(i=(-e+a)/(2*t))&&i<1&&x.push(i),0<(o=(-e-a)/(2*t))&&o<1&&x.push(o));for(var S,k,P,E=x.length,C=E;E--;)r=x[E],k=(S=1-r)*S*S*f+3*S*S*r*p+3*S*r*r*v+r*r*r*y,A[0][E]=k,P=S*S*S*d+3*S*S*r*g+3*S*r*r*m+r*r*r*b,A[1][E]=P,w[E]={X:k,Y:P};x[C]=0,x[C+1]=1,w[C]={X:f,Y:d},w[C+1]={X:y,Y:b},A[0][C]=f,A[1][C]=d,A[0][C+1]=y,A[1][C+1]=b,x.length=C+2,A[0].length=C+2,A[1].length=C+2,w.length=C+2;var T=D.apply(null,A[0]),N=D.apply(null,A[1]),L=j.apply(null,A[0]),M=j.apply(null,A[1]);return new G(T,N,L-T,M-N)},clone:function(){return new v(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions,i={precision:n,subdivisions:r};return this.lengthAtT(this.closestPointT(t,i),i)},closestPointNormalizedLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions,i={precision:n,subdivisions:r},o=this.closestPointLength(t,i);if(!o)return 0;var s=this.length(i);return 0===s?0:o/s},closestPointT:function(t,e){for(var n,r,i,o,s,a,u,l=void 0===(e=e||{}).precision?this.PRECISION:e.precision,c=void 0===e.subdivisions?this.getSubdivisions({precision:l}):e.subdivisions,h=c.length,f=h?1/h:0,d=0;d<h;d++){var p=c[d],g=p.start.distance(t),v=p.end.distance(t),m=g+v;(!u||m<u)&&(r=d*f,i=(d+1)*f,o=g,s=v,a=(n=p).start.distance(p.end),u=m)}for(var y=M(10,-l);;){var b=o?O(o-s)/o:0,w=s?O(o-s)/s:0,x=b<y||w<y,A=!o||o<a*y,_=!s||s<a*y,S=A||_;if(x||S)return o<=s?r:i;var k=n.divide(.5);f/=2;var P=k[0].start.distance(t),E=k[0].end.distance(t),C=P+E,T=k[1].start.distance(t),N=k[1].end.distance(t),L=T+N;s=C<=L?(n=k[0],i-=f,o=P,E):(n=k[1],r+=f,o=T,N)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){var n=this.toPolyline(e);return n.containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(1<=t)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},divideAtLength:function(t,e){var n=this.tAtLength(t,e);return this.divideAtT(n)},divideAtT:function(t){var e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(t<=0)return[new v(e,e,e,e),new v(e,n,r,i)];if(1<=t)return[new v(e,n,r,i),new v(i,i,i,i)];var o=this.getSkeletonPoints(t),s=o.startControlPoint1,a=o.startControlPoint2,u=o.divider,l=o.dividerControlPoint1,c=o.dividerControlPoint2;return[new v(e,s,a,u),new v(u,l,c,i)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()};if(1<=t)return{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()};var o=new A(e,n).pointAt(t),s=new A(n,r).pointAt(t),a=new A(r,i).pointAt(t),u=new A(o,s).pointAt(t),l=new A(s,a).pointAt(t),c=new A(u,l).pointAt(t),h={startControlPoint1:o,startControlPoint2:u,divider:c,dividerControlPoint1:l,dividerControlPoint2:a};return h},getSubdivisions:function(t){var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=[new v(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===e)return n;for(var r=this.endpointDistance(),i=M(10,-e),o=0;;){o+=1;for(var s=[],a=n.length,u=0;u<a;u++){var l=n[u],c=l.divide(.5);s.push(c[0],c[1])}for(var h=0,f=s.length,d=0;d<f;d++){var p=s[d];h+=p.endpointDistance()}var g=0!==h?(h-r)/h:0;if(1<o&&g<i)return s;n=s,r=h}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(r))},length:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,r=0,i=n.length,o=0;o<i;o++){var s=n[o];r+=s.endpointDistance()}return r},lengthAtT:function(t,e){if(t<=0)return 0;var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=this.divide(t)[0],i=r.length({precision:n});return i},pointAt:function(t,e){if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},pointAtLength:function(t,e){var n=this.tAtLength(t,e);return this.pointAtT(n)},pointAtT:function(t){return t<=0?this.start.clone():1<=t?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,scale:function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:1<t&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,r=e.dividerControlPoint1,i=e.divider,o=new A(n,r);return o.translate(i.x-n.x,i.y-n.y),o},tAt:function(t,e){if(t<=0)return 0;if(1<=t)return 1;var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=void 0===e.subdivisions?this.getSubdivisions({precision:n}):e.subdivisions,i={precision:n,subdivisions:r},o=this.length(i),s=o*t;return this.tAtLength(s,i)},tAtLength:function(t,e){var n=!0;t<0&&(n=!1,t=-t);for(var r,i,o,s,a,u=void 0===(e=e||{}).precision?this.PRECISION:e.precision,l=void 0===e.subdivisions?this.getSubdivisions({precision:u}):e.subdivisions,c={precision:u,subdivisions:l},h=0,f=l.length,d=1/f,p=0;p<f;p++){var g=n?p:f-1-p,v=l[p],m=v.endpointDistance();if(t<=h+m){r=v,i=g*d,o=(g+1)*d,s=n?t-h:m+h-t,a=n?m+h-t:t-h;break}h+=m}if(!r)return n?1:0;for(var y=this.length(c),b=M(10,-u);;){var w,x;if((0!==y?s/y:0)<b)return i;if((0!==y?a/y:0)<b)return o;var A=r.divide(.5);d/=2;var _=A[0].endpointDistance(),S=A[1].endpointDistance();x=s<=_?(r=A[0],o-=d,_-(w=s)):(r=A[1],i+=d,S-(w=s-_)),s=w,a=x}},toPoints:function(t){for(var e=void 0===(t=t||{}).precision?this.PRECISION:t.precision,n=void 0===t.subdivisions?this.getSubdivisions({precision:e}):t.subdivisions,r=[n[0].start.clone()],i=n.length,o=0;o<i;o++){var s=n[o];r.push(s.end.clone())}return r},toPolyline:function(t){return new T(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}},v.prototype.divide=v.prototype.divideAtT;var x=function(t,e,n){return this instanceof x?t instanceof x?new x(new S(t.x,t.y),t.a,t.b):(t=new S(t),this.x=t.x,this.y=t.y,this.a=e,void(this.b=n)):new x(t,e,n)};x.fromRect=function(t){return t=new G(t),new x(t.center(),t.width/2,t.height/2)},x.prototype={bbox:function(){return new G(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new S(this.x,this.y)},clone:function(){return new x(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],n=t.start,r=t.end,i=this.a,o=this.b,s=t.vector(),a=n.difference(new S(this)),u=new S(s.x/(i*i),s.y/(o*o)),l=new S(a.x/(i*i),a.y/(o*o)),c=s.dot(u),h=s.dot(l),f=a.dot(l)-1,d=h*h-c*f;if(d<0)return null;if(0<d){var p=R(d),g=(-h-p)/c,v=(-h+p)/c;if((g<0||1<g)&&(v<0||1<v))return null;0<=g&&g<=1&&e.push(n.lerp(r,g)),0<=v&&v<=1&&e.push(n.lerp(r,v))}else{var m=-h/c;if(!(0<=m&&m<=1))return null;e.push(n.lerp(r,m))}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new S(t),e&&t.rotate(new S(this.x,this.y),e);var n,r=t.x-this.x,i=t.y-this.y;if(0==r)return n=this.bbox().pointNearestToPoint(t),e?n.rotate(new S(this.x,this.y),-e):n;var o=i/r,s=o*o,a=this.a*this.a,u=this.b*this.b,l=R(1/(1/a+s/u)),c=o*(l=r<0?-l:l);return n=new S(this.x+l,this.y+c),e?n.rotate(new S(this.x,this.y),-e):n},normalizedDistance:function(t){var e=t.x,n=t.y,r=this.a,i=this.b,o=this.x,s=this.y;return(e-o)*(e-o)/(r*r)+(n-s)*(n-s)/(i*i)},tangentTheta:function(t){var e,n,r=t.x,i=t.y,o=this.a,s=this.b,a=this.bbox().center(),u=a.x,l=a.y,c=r>a.x+o/2,h=r<a.x-o/2;return c||h?(e=r>a.x?i-30:i+30,n=o*o/(r-u)-o*o*(i-l)*(e-l)/(s*s*(r-u))+u):(n=i>a.y?r+30:r-30,e=s*s/(i-l)-s*s*(r-u)*(n-u)/(o*o*(i-l))+l),new S(n,e).theta(t)},toString:function(){return new S(this.x,this.y).toString()+" "+this.a+" "+this.b}};var A=function(t,e){return this instanceof A?t instanceof A?new A(t.start,t.end):(this.start=new S(t),void(this.end=new S(e))):new A(t,e)};A.prototype={angle:function(){var t=new S(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=D(this.start.x,this.end.x),e=D(this.start.y,this.end.y),n=j(this.start.x,this.end.x),r=j(this.start.y,this.end.y);return new G(t,e,n-t,r-e)},bearing:function(){var t=_(this.start.y),e=_(this.end.y),n=this.start.x,r=this.end.x,i=_(r-n),o=c(i)*l(e),s=l(t)*c(e)-c(t)*l(e)*l(i),a=p(h(o,s)),u=a-22.5;return u<0&&(u+=360),["NE","E","SE","S","SW","W","NW","N"][u=parseInt(u/45)]},clone:function(){return new A(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new A(this.start,t).vector()),n=D(1,j(0,e/this.squaredLength()));return n!=n?0:n},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,n=this.end;if(0!==e.cross(t,n))return!1;var r=this.length();return!(new A(e,t).length()>r)&&!(new A(t,n).length()>r)},divideAt:function(t){var e=this.pointAt(t);return[new A(this.start,e),new A(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new A(this.start,e),new A(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t instanceof A||t instanceof G||t instanceof T||t instanceof x||t instanceof C){var n=t.intersectionWithLine(this,e);return n&&t instanceof A&&(n=n[0]),n}return null},intersectionWithLine:function(t){var e=new S(this.end.x-this.start.x,this.end.y-this.start.y),n=new S(t.end.x-t.start.x,t.end.y-t.start.y),r=e.x*n.y-e.y*n.x,i=new S(t.start.x-this.start.x,t.start.y-this.start.y),o=i.x*n.y-i.y*n.x,s=i.x*e.y-i.y*e.x;if(0==r||o*r<0||s*r<0)return null;if(0<r){if(r<o||r<s)return null}else if(o<r||s<r)return null;return[new S(this.start.x+o*e.x/r,this.start.y+o*e.y/r)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return R(this.squaredLength())},midpoint:function(){return new S((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},pointAt:function(t){var e=this.start,n=this.end;return t<=0?e.clone():1<=t?n.clone():e.lerp(n,t)},pointAtLength:function(t){var e=this.start,n=this.end,r=!0;t<0&&(r=!1,t=-t);var i=this.length();return i<=t?r?n.clone():e.clone():this.pointAt((r?t:i-t)/i)},pointOffset:function(t){t=new S(t);var e=this.start,n=this.end,r=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x);return r/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){var e=M(10,t||0);return this.start.x=i(this.start.x*e)/e,this.start.y=i(this.start.y*e)/e,this.end.x=i(this.end.x*e)/e,this.end.y=i(this.end.y*e)/e,this},scale:function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},setLength:function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},squaredLength:function(){var t=this.start.x,e=this.start.y,n=this.end.x,r=this.end.y;return(t-=n)*t+(e-=r)*e},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,r=this.pointAt(t),i=new A(e,n);return i.translate(r.x-e.x,r.y-e.y),i},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,r=this.pointAtLength(t),i=new A(e,n);return i.translate(r.x-e.x,r.y-e.y),i},toString:function(){return this.start.toString()+" "+this.end.toString()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new S(this.end.x-this.start.x,this.end.y-this.start.y)}},A.prototype.intersection=A.prototype.intersect;var C=function(t){if(!(this instanceof C))return new C(t);if("string"==typeof t)return new C.parse(t);var e,n;if(this.segments=[],t)if(Array.isArray(t)&&0!==t.length)if(t=t.reduce(function(t,e){return t.concat(e)},[]),n=t.length,t[0].isSegment)for(e=0;e<n;e++){var r=t[e];this.appendSegment(r)}else{var i=null;for(e=0;e<n;e++){var o=t[e];if(!(o instanceof A||o instanceof v))throw new Error("Cannot construct a path segment from the provided object.");0===e&&this.appendSegment(C.createSegment("M",o.start)),i&&!i.end.equals(o.start)&&this.appendSegment(C.createSegment("M",o.start)),o instanceof A?this.appendSegment(C.createSegment("L",o.end)):o instanceof v&&this.appendSegment(C.createSegment("C",o.controlPoint1,o.controlPoint2,o.end)),i=o}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof A)this.appendSegment(C.createSegment("M",t.start)),this.appendSegment(C.createSegment("L",t.end));else if(t instanceof v)this.appendSegment(C.createSegment("M",t.start)),this.appendSegment(C.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else{if(!(t instanceof T))throw new Error("Cannot construct a path from the provided object.");if(!t.points||0===t.points.length)return;for(n=t.points.length,e=0;e<n;e++){var s=t.points[e];0===e?this.appendSegment(C.createSegment("M",s)):this.appendSegment(C.createSegment("L",s))}}else;};C.parse=function(t){if(!t)return new C;for(var e=new C,n=t.match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g),r=n.length,i=0;i<r;i++){var o=n[i],s=o.match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g),a=C.createSegment.apply(this,s);e.appendSegment(a)}return e},C.createSegment=function(t){var e=arguments;if(!t)throw new Error("Type must be provided.");var n=C.segmentTypes[t];if(!n)throw new Error(t+" is not a recognized path segment type.");for(var r=[],i=arguments.length,o=1;o<i;o++)r.push(e[o]);return m(n,r)},C.prototype={appendSegment:function(t){var e,n=this.segments,r=n.length,i=0!==r?n[r-1]:null;if(Array.isArray(t)){if(!(t=t.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var o=t.length,s=0;s<o;s++){var a=t[s];e=this.prepareSegment(a,i,null),n.push(e),i=e}}else{if(!t||!t.isSegment)throw new Error("Segment required.");e=this.prepareSegment(t,i,null),n.push(e)}},bbox:function(){var t,e=this.segments,n=e.length;if(0===n)return null;for(var r=0;r<n;r++){var i=e[r];if(i.isVisible){var o=i.bbox();t=t?t.union(o):o}}if(t)return t;var s=e[n-1];return new G(s.end.x,s.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,n=new C,r=0;r<e;r++){var i=t[r].clone();n.appendSegment(i)}return n},closestPoint:function(t,e){var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},closestPointLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,i={precision:n,segmentSubdivisions:r},o=this.closestPointT(t,i);return o?this.lengthAtT(o,i):0},closestPointNormalizedLength:function(t,e){var n=void 0===(e=e||{}).precision?this.PRECISION:e.precision,r=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,i={precision:n,segmentSubdivisions:r},o=this.closestPointLength(t,i);if(0===o)return 0;var s=this.length(i);return 0===s?0:o/s},closestPointT:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;for(var i,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,u=0;u<r;u++){var l=n[u],c=s[u];if(l.isVisible){var h=l.closestPointT(t,{precision:o,subdivisions:c}),f=l.pointAtT(h),d=new A(f,t).squaredLength();d<a&&(i={segmentIndex:u,value:h},a=d)}}return i||{segmentIndex:r-1,value:1}},closestPointTangent:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;for(var i,o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,u=0;u<r;u++){var l=n[u],c=s[u];if(l.isDifferentiable()){var h=l.closestPointT(t,{precision:o,subdivisions:c}),f=l.pointAtT(h),d=new A(f,t).squaredLength();d<a&&(i=l.tangentAtT(h),a=d)}}return i||null},containsPoint:function(t,e){var n=this.toPolylines(e);if(!n)return!1;for(var r=n.length,i=0,o=0;o<r;o++){var s=n[o];s.containsPoint(t)&&i++}return i%2==1},divideAt:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions,s={precision:i,segmentSubdivisions:o},a=this.length(s),u=a*t;return this.divideAtLength(u,s)},divideAtLength:function(t,e){var n=this.segments.length;if(0===n)return null;var r=!0;t<0&&(r=!1,t=-t);var i,o,s,a,u,l,c,h=void 0===(e=e||{}).precision?this.PRECISION:e.precision,f=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:h}):e.segmentSubdivisions,d=0;for(i=0;i<n;i++){var p=r?i:n-1-i;o=this.getSegment(p);var g=f[p],v=o.length({precision:h,subdivisions:g});if(o.isDifferentiable()&&(u=o,l=p,t<=d+v)){a=p,s=o.divideAtLength((r?1:-1)*(t-d),{precision:h,subdivisions:g});break}d+=v}if(!u)return null;s||(a=l,c=r?1:0,s=u.divideAtT(c));var m=this.clone();m.replaceSegment(a,s);var y=a,b=a+1,w=a+2;s[0].isDifferentiable()||(m.removeSegment(y),b-=1,w-=1);var x=m.getSegment(b).start;m.insertSegment(b,C.createSegment("M",x)),w+=1,s[1].isDifferentiable()||(m.removeSegment(w-1),w-=1);var A=w-y-1;for(i=w;i<m.segments.length;i++){var _=this.getSegment(i-A);if("Z"===(o=m.getSegment(i)).type&&!_.subpathStartSegment.end.equals(o.subpathStartSegment.end)){var S=C.createSegment("L",_.end);m.replaceSegment(i,S)}}var k=new C(m.segments.slice(0,b)),P=new C(m.segments.slice(b));return[k,P]},equals:function(t){if(!t)return!1;var e=this.segments,n=t.segments,r=e.length;if(n.length!==r)return!1;for(var i=0;i<r;i++){var o=e[i],s=n[i];if(o.type!==s.type||!o.equals(s))return!1}return!0},getSegment:function(t){var e=this.segments,n=e.length;if(0===n)throw new Error("Path has no segments.");if(t<0&&(t=n+t),n<=t||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){for(var e=this.segments,n=e.length,r=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=[],o=0;o<n;o++){var s=e[o],a=s.getSubdivisions({precision:r});i.push(a)}return i},insertSegment:function(t,e){var n,r=this.segments,i=r.length;if(t<0&&(t=i+t+1),i<t||t<0)throw new Error("Index out of range.");var o=null,s=null;if(0!==i&&(s=1<=t?(o=r[t-1]).nextSegment:r[0]),Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");for(var a=e.length,u=0;u<a;u++){var l=e[u];n=this.prepareSegment(l,o,s),r.splice(t+u,0,n),o=n}}else{if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,o,s),r.splice(t,0,n)}},intersectionWithLine:function(t,e){var n=null,r=this.toPolylines(e);if(!r)return null;for(var i=0,o=r.length;i<o;i++){var s=r[i],a=t.intersect(s);a&&(n=n||[],Array.isArray(a)?Array.prototype.push.apply(n,a):n.push(a))}return n},isDifferentiable:function(){for(var t=this.segments,e=t.length,n=0;n<e;n++){var r=t[n];if(r.isDifferentiable())return!0}return!1},isValid:function(){var t=this.segments,e=0===t.length||"M"===t[0].type;return e},length:function(t){var e=this.segments,n=e.length;if(0===n)return 0;for(var r=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:r}):t.segmentSubdivisions,o=0,s=0;s<n;s++){var a=e[s],u=i[s];o+=a.length({subdivisions:u})}return o},lengthAtT:function(t,e){var n=this.segments,r=n.length;if(0===r)return 0;var i=t.segmentIndex;if(i<0)return 0;var o=t.value;r<=i?(i=r-1,o=1):o<0?o=0:1<o&&(o=1);for(var s,a=void 0===(e=e||{}).precision?this.PRECISION:e.precision,u=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:a}):e.segmentSubdivisions,l=0,c=0;c<i;c++){var h=n[c];s=u[c],l+=h.length({precisison:a,subdivisions:s})}return h=n[i],s=u[i],l+=h.lengthAtT(o,{precisison:a,subdivisions:s})},pointAt:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;if(t<=0)return this.start.clone();if(1<=t)return this.end.clone();var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions,s={precision:i,segmentSubdivisions:o},a=this.length(s),u=a*t;return this.pointAtLength(u,s)},pointAtLength:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;if(0===t)return this.start.clone();var i=!0;t<0&&(i=!1,t=-t);for(var o,s=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,u=0,l=0;l<r;l++){var c=i?l:r-1-l,h=n[c],f=a[c],d=h.length({precision:s,subdivisions:f});if(h.isVisible){if(t<=u+d)return h.pointAtLength((i?1:-1)*(t-u),{precision:s,subdivisions:f});o=h}u+=d}if(o)return i?o.end:o.start;var p=n[r-1];return p.end.clone()},pointAtT:function(t){var e=this.segments,n=e.length;if(0===n)return null;var r=t.segmentIndex;if(r<0)return e[0].pointAtT(0);if(n<=r)return e[n-1].pointAtT(1);var i=t.value;return i<0?i=0:1<i&&(i=1),e[r].pointAtT(i)},PRECISION:3,prepareSegment:function(t,e,n){t.previousSegment=e,t.nextSegment=n,e&&(e.nextSegment=t),n&&(n.previousSegment=t);var r=t;return t.isSubpathStart&&(t.subpathStartSegment=t,r=n),r&&this.updateSubpathStartSegment(r),t},removeSegment:function(t){var e=this.segments,n=e.length;if(0===n)throw new Error("Path has no segments.");if(t<0&&(t=n+t),n<=t||t<0)throw new Error("Index out of range.");var r=e.splice(t,1)[0],i=r.previousSegment,o=r.nextSegment;i&&(i.nextSegment=o),o&&(o.previousSegment=i),r.isSubpathStart&&o&&this.updateSubpathStartSegment(o)},replaceSegment:function(t,e){var n,r=this.segments,i=r.length;if(0===i)throw new Error("Path has no segments.");if(t<0&&(t=i+t),i<=t||t<0)throw new Error("Index out of range.");var o=r[t],s=o.previousSegment,a=o.nextSegment,u=o.isSubpathStart;if(Array.isArray(e)){if(!(e=e.reduce(function(t,e){return t.concat(e)},[]))[0].isSegment)throw new Error("Segments required.");r.splice(t,1);for(var l=e.length,c=0;c<l;c++){var h=e[c];n=this.prepareSegment(h,s,a),r.splice(t+c,0,n),s=n,u&&n.isSubpathStart&&(u=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");n=this.prepareSegment(e,s,a),r.splice(t,1,n),u&&n.isSubpathStart&&(u=!1)}u&&a&&this.updateSubpathStartSegment(a)},scale:function(t,e,n){for(var r=this.segments,i=r.length,o=0;o<i;o++){var s=r[o];s.scale(t,e,n)}return this},segmentAt:function(t,e){var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},segmentAtLength:function(t,e){var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},segmentIndexAt:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions,s={precision:i,segmentSubdivisions:o},a=this.length(s),u=a*t;return this.segmentIndexAtLength(u,s)},segmentIndexAtLength:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;var i=!0;t<0&&(i=!1,t=-t);for(var o=void 0===(e=e||{}).precision?this.PRECISION:e.precision,s=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=null,u=0,l=0;l<r;l++){var c=i?l:r-1-l,h=n[c],f=s[c],d=h.length({precision:o,subdivisions:f});if(h.isVisible){if(t<=u+d)return c;a=c}u+=d}return a},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;t<0&&(t=0),1<t&&(t=1);var i=void 0===(e=e||{}).precision?this.PRECISION:e.precision,o=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions,s={precision:i,segmentSubdivisions:o},a=this.length(s),u=a*t;return this.tangentAtLength(u,s)},tangentAtLength:function(t,e){var n=this.segments,r=n.length;if(0===r)return null;var i=!0;t<0&&(i=!1,t=-t);for(var o,s=void 0===(e=e||{}).precision?this.PRECISION:e.precision,a=void 0===e.segmentSubdivisions?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,u=0,l=0;l<r;l++){var c=i?l:r-1-l,h=n[c],f=a[c],d=h.length({precision:s,subdivisions:f});if(h.isDifferentiable()){if(t<=u+d)return h.tangentAtLength((i?1:-1)*(t-u),{precision:s,subdivisions:f});o=h}u+=d}if(o){var p=i?1:0;return o.tangentAtT(p)}return null},tangentAtT:function(t){var e=this.segments,n=e.length;if(0===n)return null;var r=t.segmentIndex;if(r<0)return e[0].tangentAtT(0);if(n<=r)return e[n-1].tangentAtT(1);var i=t.value;return i<0?i=0:1<i&&(i=1),e[r].tangentAtT(i)},toPoints:function(t){var e=this.segments,n=e.length;if(0===n)return null;for(var r=void 0===(t=t||{}).precision?this.PRECISION:t.precision,i=void 0===t.segmentSubdivisions?this.getSegmentSubdivisions({precision:r}):t.segmentSubdivisions,o=[],s=[],a=0;a<n;a++){var u=e[a];if(u.isVisible){var l=i[a];if(0<l.length){var c=l.map(function(t){return t.start});Array.prototype.push.apply(s,c)}else s.push(u.start)}else 0<s.length&&(s.push(e[a-1].end),o.push(s),s=[])}return 0<s.length&&(s.push(this.end),o.push(s)),o},toPolylines:function(t){var e=[],n=this.toPoints(t);if(!n)return null;for(var r=0,i=n.length;r<i;r++)e.push(new T(n[r]));return e},toString:function(){for(var t=this.segments,e=t.length,n="",r=0;r<e;r++){var i=t[r];n+=i.serialize()+" "}return n.trim()},translate:function(t,e){for(var n=this.segments,r=n.length,i=0;i<r;i++){var o=n[i];o.translate(t,e)}return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)t.subpathStartSegment=e?e.subpathStartSegment:null,t=(e=t).nextSegment}},Object.defineProperty(C.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=0;n<e;n++){var r=t[n];if(r.isVisible)return r.start}return t[e-1].end}}),Object.defineProperty(C.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=e-1;0<=n;n--){var r=t[n];if(r.isVisible)return r.end}return t[e-1].end}});var S=function(t,e){if(!(this instanceof S))return new S(t,e);if("string"==typeof t){var n=t.split(-1===t.indexOf("@")?" ":"@");t=parseFloat(n[0]),e=parseFloat(n[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=void 0===t?0:t,this.y=void 0===e?0:e};S.fromPolar=function(t,e,n){n=n&&new S(n)||new S(0,0);var r=O(t*l(e)),i=O(t*c(e)),o=w(p(e));return o<90?i=-i:o<180?(r=-r,i=-i):o<270&&(r=-r),new S(n.x+r,n.y+i)},S.random=function(t,e,n,r){return new S(u(t,e),u(n,r))},S.prototype={chooseClosest:function(t){var e=t.length;if(1===e)return new S(t[0]);for(var n=null,r=1/0,i=0;i<e;i++){var o=new S(t[i]),s=this.squaredDistance(o);s<r&&(n=o,r=s)}return n},adhereToRect:function(t){return t.containsPoint(this)||(this.x=D(j(this.x,t.x),t.x+t.width),this.y=D(j(this.y,t.y),t.y+t.height)),this},angleBetween:function(t,e){var n=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return n<0&&(n+=360),n},bearing:function(t){return new A(this,t).bearing()},changeInAngle:function(t,e,n){return this.clone().offset(-t,-e).theta(n)-this.theta(n)},clone:function(){return new S(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new S(this.x-(t||0),this.y-(e||0))},distance:function(t){return new A(this,t).length()},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var n=this.x,r=this.y;return new S((1-e)*n+e*t.x,(1-e)*r+e*t.y)},magnitude:function(){return R(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return O(t.x-this.x)+O(t.y-this.y)},move:function(t,e){var n=_(new S(t).theta(this)),r=this.offset(l(n)*e,-c(n)*e);return r},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new S(t).move(this,this.distance(t))},rotate:function(t,e){t=t||new S(0,0),e=_(w(-e));var n=l(e),r=c(e),i=n*(this.x-t.x)-r*(this.y-t.y)+t.x,o=r*(this.x-t.x)+n*(this.y-t.y)+t.y;return this.x=i,this.y=o,this},round:function(t){var e=M(10,t||0);return this.x=i(this.x*e)/e,this.y=i(this.y*e)/e,this},scale:function(t,e,n){return n=n&&new S(n)||new S(0,0),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this},snapToGrid:function(t,e){return this.x=f(this.x,t),this.y=f(this.y,e||t),this},squaredDistance:function(t){return new A(this,t).squaredLength()},theta:function(t){var e=-((t=new S(t)).y-this.y),n=t.x-this.x,r=h(e,n);return r<0&&(r=2*s+r),180*r/s},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new S(t)||new S(0,0);var e=this.x,n=this.y;return this.x=R((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y)),this.y=_(t.theta(new S(e,n))),this},toString:function(){return this.x+"@"+this.y},update:function(t,e){return this.x=t||0,this.y=e||0,this},vectorAngle:function(t){var e=new S(0,0);return e.angleBetween(this,t)}},S.prototype.translate=S.prototype.offset;var T=function(t){return this instanceof T?"string"==typeof t?new T.parse(t):void(this.points=Array.isArray(t)?t.map(S):[]):new T(t)};T.parse=function(t){if(""===(t=t.trim()))return new T;for(var e=[],n=t.split(/\s*,\s*|\s+/),r=n.length,i=0;i<r;i+=2)e.push({x:+n[i],y:+n[i+1]});return new T(e)},T.prototype={bbox:function(){var t=1/0,e=-1/0,n=1/0,r=-1/0,i=this.points,o=i.length;if(0===o)return null;for(var s=0;s<o;s++){var a=i[s],u=a.x,l=a.y;u<t&&(t=u),e<u&&(e=u),l<n&&(n=l),r<l&&(r=l)}return new G(t,n,e-t,r-n)},clone:function(){var t=this.points,e=t.length;if(0===e)return new T;for(var n=[],r=0;r<e;r++){var i=t[r].clone();n.push(i)}return new T(n)},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e,n=this.points,r=n.length;if(0===r)return 0;if(1===r)return 0;for(var i=1/0,o=0,s=r-1,a=0;a<s;a++){var u=new A(n[a],n[a+1]),l=u.length(),c=u.closestPointNormalizedLength(t),h=u.pointAt(c),f=h.squaredDistance(t);f<i&&(i=f,e=o+c*l),o+=l}return e},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(0===e)return 0;var n=this.length();return 0===n?0:e/n},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,n=e.length;if(0===n)return!1;for(var r=t.x,i=t.y,o=n-1,s=0,a=0;s<n;s++){var u=e[o],l=e[s];if(t.equals(u))return!0;var c=new A(u,l);if(c.containsPoint(t))return!0;if(i<=u.y&&i>l.y||i>u.y&&i<=l.y){var h=u.x-r>l.x-r?u.x-r:l.x-r;if(0<=h){var f=new S(r+h,i),d=new A(t,f);c.intersect(d)&&a++}}o=s}return a%2==1},convexHull:function(){var t,e,n,r=this.points,i=r.length;if(0===i)return new T;for(t=0;t<i;t++)void 0===n?n=r[t]:r[t].y<n.y?n=r[t]:r[t].y===n.y&&r[t].x>n.x&&(n=r[t]);var o=[];for(t=0;t<i;t++){var s=n.theta(r[t]);0===s&&(s=360);var a=[r[t],t,s];o.push(a)}if(o.sort(function(t,e){var n=t[2]-e[2];return 0===n&&(n=e[1]-t[1]),n}),2<o.length){var u=o[o.length-1];o.unshift(u)}for(var l,c,h,f,d,p,g,v={},m=[];0!==o.length;)if(l=o.pop(),c=l[0],!v.hasOwnProperty(l[0]+"@@"+l[1]))for(var y=!1;!y;)if(m.length<2)m.push(l),y=!0;else{h=m.pop(),f=h[0],d=m.pop();var b=(p=d[0]).cross(f,c);if(b<0)m.push(d),m.push(h),m.push(l),y=!0;else if(0===b){var w=f.angleBetween(p,c);O(w-180)<1e-10?(v[h[0]+"@@"+h[1]]=f,m.push(d)):f.equals(c)||p.equals(f)?(v[h[0]+"@@"+h[1]]=f,m.push(d)):O((w+1)%360-1)<1e-10&&(m.push(d),o.push(h))}else v[h[0]+"@@"+h[1]]=f,m.push(d)}2<m.length&&m.pop();var x=-1;for(e=m.length,t=0;t<e;t++){var A=m[t][1];(void 0===g||A<g)&&(g=A,x=t)}var _=[];if(0<x){var S=m.slice(x),k=m.slice(0,x);_=S.concat(k)}else _=m;var P=[];for(e=_.length,t=0;t<e;t++)P.push(_[t][0]);return new T(P)},equals:function(t){if(!t)return!1;var e=this.points,n=t.points,r=e.length;if(n.length!==r)return!1;for(var i=0;i<r;i++){var o=e[i],s=t.points[i];if(!o.equals(s))return!1}return!0},intersectionWithLine:function(t){for(var e=new A(t),n=[],r=this.points,i=0,o=r.length-1;i<o;i++){var s=r[i],a=r[i+1],u=new A(s,a),l=e.intersectionWithLine(u);l&&n.push(l[0])}return 0<n.length?n:null},isDifferentiable:function(){var t=this.points,e=t.length;if(0===e)return!1;for(var n=e-1,r=0;r<n;r++){var i=t[r],o=t[r+1],s=new A(i,o);if(s.isDifferentiable())return!0}return!1},length:function(){var t=this.points,e=t.length;if(0===e)return 0;for(var n=0,r=e-1,i=0;i<r;i++)n+=t[i].distance(t[i+1]);return n},pointAt:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();if(t<=0)return e[0].clone();if(1<=t)return e[n-1].clone();var r=this.length(),i=r*t;return this.pointAtLength(i)},pointAtLength:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();var r=!0;t<0&&(r=!1,t=-t);for(var i=0,o=n-1,s=0;s<o;s++){var a=r?s:o-1-s,u=e[a],l=e[a+1],c=new A(u,l),h=u.distance(l);if(t<=i+h)return c.pointAtLength((r?1:-1)*(t-i));i+=h}var f=r?e[n-1]:e[0];return f.clone()},scale:function(t,e,n){var r=this.points,i=r.length;if(0===i)return this;for(var o=0;o<i;o++)r[o].scale(t,e,n);return this},tangentAt:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return null;t<0&&(t=0),1<t&&(t=1);var r=this.length(),i=r*t;return this.tangentAtLength(i)},tangentAtLength:function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return null;var r,i=!0;t<0&&(i=!1,t=-t);for(var o=0,s=n-1,a=0;a<s;a++){var u=i?a:s-1-a,l=e[u],c=e[u+1],h=new A(l,c),f=l.distance(c);if(h.isDifferentiable()){if(t<=o+f)return h.tangentAtLength((i?1:-1)*(t-o));r=h}o+=f}if(r){var d=i?1:0;return r.tangentAt(d)}return null},toString:function(){return this.points+""},translate:function(t,e){var n=this.points,r=n.length;if(0===r)return this;for(var i=0;i<r;i++)n[i].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(0===e)return"";for(var n="",r=0;r<e;r++){var i=t[r];n+=i.x+","+i.y+" "}return n.trim()}},Object.defineProperty(T.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return 0===e?null:this.points[0]}}),Object.defineProperty(T.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return 0===e?null:this.points[e-1]}});var G=function(t,e,n,r){if(!(this instanceof G))return new G(t,e,n,r);Object(t)===t&&(e=t.y,n=t.width,r=t.height,t=t.x),this.x=void 0===t?0:t,this.y=void 0===e?0:e,this.width=void 0===n?0:n,this.height=void 0===r?0:r};G.fromEllipse=function(t){return t=new x(t),new G(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},G.prototype={bbox:function(t){if(!t)return this.clone();var e=_(t),n=O(c(e)),r=O(l(e)),i=this.width*r+this.height*n,o=this.width*n+this.height*r;return new G(this.x+(this.width-i)/2,this.y+(this.height-o)/2,i,o)},bottomLeft:function(){return new S(this.x,this.y+this.height)},bottomLine:function(){return new A(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new S(this.x+this.width/2,this.y+this.height)},center:function(){return new S(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new G(this)},containsPoint:function(t){return(t=new S(t)).x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new G(this).normalize(),n=new G(t).normalize(),r=e.width,i=e.height,o=n.width,s=n.height;if(!(r&&i&&o&&s))return!1;var a=e.x,u=e.y,l=n.x,c=n.y;return o+=l,r+=a,s+=c,i+=u,a<=l&&o<=r&&u<=c&&s<=i},corner:function(){return new S(this.x+this.width,this.y+this.height)},equals:function(t){var e=new G(this).normalize(),n=new G(t).normalize();return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height},inflate:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),n=this.corner(),r=t.origin(),i=t.corner();if(i.x<=e.x||i.y<=e.y||r.x>=n.x||r.y>=n.y)return null;var o=j(e.x,r.x),s=j(e.y,r.y);return new G(o,s,D(n.x,i.x)-o,D(n.y,i.y)-s)},intersectionWithLine:function(t){var e,n,r=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],i=[],o=[],s=r.length;for(n=0;n<s;n++)null!==(e=t.intersect(r[n]))&&o.indexOf(e.toString())<0&&(i.push(e),o.push(e.toString()));return 0<i.length?i:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new S(t);var n,r=new S(this.x+this.width/2,this.y+this.height/2);e&&t.rotate(r,e);for(var i=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],o=new A(r,t),s=i.length-1;0<=s;--s){var a=i[s].intersection(o);if(null!==a){n=a;break}}return n&&e&&n.rotate(r,-e),n},leftLine:function(){return new A(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new S(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){var n,r,i,o,s,a,u,l;t=new G(t);var c=(e=e||t.center()).x,h=e.y;n=r=i=o=s=a=u=l=1/0;var f=t.topLeft();f.x<c&&(n=(this.x-c)/(f.x-c)),f.y<h&&(s=(this.y-h)/(f.y-h));var d=t.bottomRight();d.x>c&&(r=(this.x+this.width-c)/(d.x-c)),d.y>h&&(a=(this.y+this.height-h)/(d.y-h));var p=t.topRight();p.x>c&&(i=(this.x+this.width-c)/(p.x-c)),p.y<h&&(u=(this.y-h)/(p.y-h));var g=t.bottomLeft();return g.x<c&&(o=(this.x-c)/(g.x-c)),g.y>h&&(l=(this.y+this.height-h)/(g.y-h)),{sx:D(n,r,i,o),sy:D(s,a,u,l)}},maxRectUniformScaleToFit:function(t,e){var n=this.maxRectScaleToFit(t,e);return D(n.sx,n.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=n,this.height=r,this},offset:function(t,e){return S.prototype.offset.call(this,t,e)},origin:function(){return new S(this.x,this.y)},pointNearestToPoint:function(t){if(t=new S(t),this.containsPoint(t)){var e=this.sideNearestToPoint(t);switch(e){case"right":return new S(this.x+this.width,t.y);case"left":return new S(this.x,t.y);case"bottom":return new S(t.x,this.y+this.height);case"top":return new S(t.x,this.y)}}return t.adhereToRect(this)},rightLine:function(){return new A(this.topRight(),this.bottomRight())},rightMiddle:function(){return new S(this.x+this.width,this.y+this.height/2)},round:function(t){var e=M(10,t||0);return this.x=i(this.x*e)/e,this.y=i(this.y*e)/e,this.width=i(this.width*e)/e,this.height=i(this.height*e)/e,this},scale:function(t,e,n){return n=this.origin().scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){var e=(t=new S(t)).x-this.x,n=this.x+this.width-t.x,r=t.y-this.y,i=this.y+this.height-t.y,o=e,s="left";return n<o&&(o=n,s="right"),r<o&&(o=r,s="top"),i<o&&(s="bottom"),s},snapToGrid:function(t,e){var n=this.origin().snapToGrid(t,e),r=this.corner().snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=r.x-n.x,this.height=r.y-n.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new A(this.topLeft(),this.topRight())},topMiddle:function(){return new S(this.x+this.width/2,this.y)},topRight:function(){return new S(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){t=new G(t);var e=this.origin(),n=this.corner(),r=t.origin(),i=t.corner(),o=D(e.x,r.x),s=D(e.y,r.y),a=j(n.x,i.x),u=j(n.y,i.y);return new G(o,s,a-o,u-s)}},G.prototype.bottomRight=G.prototype.corner,G.prototype.topLeft=G.prototype.origin,G.prototype.translate=G.prototype.offset;var w=function(t){return t%360+(t<0?360:0)},f=function(t,e){return e*i(t/e)},p=function(t){return 180*t/s%360},_=function(t,e){return(t=(e=e||!1)?t:t%360)*s/180},u=function(t,e){if(void 0===e)e=void 0===t?1:t,t=0;else if(e<t){var n=t;t=e,e=n}return o(r.random()*(e-t+1)+t)},d=x,k=A,P=S,g=G;function m(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}function y(t){var e,n,r=arguments,i=[];for(n=arguments.length,e=1;e<n;e++)i.push(r[e]);if(!t)throw new Error("Missing a parent object.");var o=Object.create(t);for(n=i.length,e=0;e<n;e++){var s,a,u=i[e];for(a in u)u.hasOwnProperty(a)&&(delete o[a],s=Object.getOwnPropertyDescriptor(u,a),Object.defineProperty(o,a,s))}return o}var b={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return 1<=t?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(b,"end",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}}),Object.defineProperty(b,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var N=function(){for(var t,e,n=arguments,r=[],i=arguments.length,o=0;o<i;o++)r.push(n[o]);if(!(this instanceof N))return m(N,r);if(0===i)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");if(r[0]instanceof A){if(1===i)return this.end=r[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+i+" lines provided).")}if("string"==typeof r[0]||"number"==typeof r[0]){if(2===i)return this.end=new S(+r[0],+r[1]),this;if(i<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+i+" coordinates provided).");var s;for(t=[],o=0;o<i;o+=2)s=r.slice(o,o+2),t.push(m(N,s));return t}if(1===i)return this.end=new S(r[0]),this;for(t=[],o=0;o<i;o+=1)e=r[o],t.push(new N(e));return t},L={clone:function(){return new N(this.end)},divideAt:function(t){var e=new A(this.start,this.end),n=e.divideAt(t);return[new N(n[0]),new N(n[1])]},divideAtLength:function(t){var e=new A(this.start,this.end),n=e.divideAtLength(t);return[new N(n[0]),new N(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!!this.previousSegment&&!this.start.equals(this.end)},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(L,"type",{configurable:!0,enumerable:!0,value:"L"}),N.prototype=y(b,A.prototype,L);var F=function(){for(var t,e,n=arguments,r=[],i=arguments.length,o=0;o<i;o++)r.push(n[o]);if(!(this instanceof F))return m(F,r);if(0===i)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");if(r[0]instanceof v){if(1===i)return this.controlPoint1=r[0].controlPoint1.clone(),this.controlPoint2=r[0].controlPoint2.clone(),this.end=r[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+i+" curves provided).")}if("string"==typeof r[0]||"number"==typeof r[0]){if(6===i)return this.controlPoint1=new S(+r[0],+r[1]),this.controlPoint2=new S(+r[2],+r[3]),this.end=new S(+r[4],+r[5]),this;if(i<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+i+" coordinates provided).");var s;for(t=[],o=0;o<i;o+=6)s=r.slice(o,o+6),t.push(m(F,s));return t}if(3===i)return this.controlPoint1=new S(r[0]),this.controlPoint2=new S(r[1]),this.end=new S(r[2]),this;if(i<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+i+" points provided).");for(t=[],o=0;o<i;o+=3)e=r.slice(o,o+3),t.push(m(F,e));return t},B={clone:function(){return new F(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var n=new v(this.start,this.controlPoint1,this.controlPoint2,this.end),r=n.divideAt(t,e);return[new F(r[0]),new F(r[1])]},divideAtLength:function(t,e){var n=new v(this.start,this.controlPoint1,this.controlPoint2,this.end),r=n.divideAtLength(t,e);return[new F(r[0]),new F(r[1])]},divideAtT:function(t){var e=new v(this.start,this.controlPoint1,this.controlPoint2,this.end),n=e.divideAtT(t);return[new F(n[0]),new F(n[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(r))},scale:function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+n.x+" "+n.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(B,"type",{configurable:!0,enumerable:!0,value:"C"}),F.prototype=y(b,v.prototype,B);var V=function(){for(var t,e,n=arguments,r=[],i=arguments.length,o=0;o<i;o++)r.push(n[o]);if(!(this instanceof V))return m(V,r);if(0===i)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");if(r[0]instanceof A){if(1===i)return this.end=r[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+i+" lines provided).")}if(r[0]instanceof v){if(1===i)return this.end=r[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+i+" curves provided).")}if("string"==typeof r[0]||"number"==typeof r[0]){if(2===i)return this.end=new S(+r[0],+r[1]),this;if(i<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+i+" coordinates provided).");var s;for(t=[],o=0;o<i;o+=2)s=r.slice(o,o+2),0===o?t.push(m(V,s)):t.push(m(N,s));return t}if(1===i)return this.end=new S(r[0]),this;for(t=[],o=0;o<i;o+=1)e=r[o],0===o?t.push(new V(e)):t.push(new N(e));return t},I={bbox:function(){return null},clone:function(){return new V(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(I,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}}),Object.defineProperty(I,"type",{configurable:!0,enumerable:!0,value:"M"}),V.prototype=y(b,I);var z=function(){for(var t=arguments,e=[],n=arguments.length,r=0;r<n;r++)e.push(t[r]);if(!(this instanceof z))return m(z,e);if(0<n)throw new Error("Closepath constructor expects no arguments.");return this},q={clone:function(){return new z},divideAt:function(t){var e=new A(this.start,this.end),n=e.divideAt(t);return[n[1].isDifferentiable()?new N(n[0]):this.clone(),new N(n[1])]},divideAtLength:function(t){var e=new A(this.start,this.end),n=e.divideAtLength(t);return[n[1].isDifferentiable()?new N(n[0]):this.clone(),new N(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(q,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}}),Object.defineProperty(q,"type",{configurable:!0,enumerable:!0,value:"Z"}),z.prototype=y(b,A.prototype,q);var H=C.segmentTypes={L:N,C:F,M:V,Z:z,z:z};C.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(H).join("")+",.]*$"),C.isDataSupported=function(t){return"string"==typeof t&&this.regexSupportedData.test(t)};var U={bezier:t,Curve:v,Ellipse:x,Line:A,Path:C,Point:S,Polyline:T,Rect:G,scale:{linear:function(t,e,n){var r=t[1]-t[0];var i=e[1]-e[0];return(n-t[0])/r*i+e[0]||0}},normalizeAngle:w,snapToGrid:f,toDeg:p,toRad:_,random:u,ellipse:d,line:k,point:P,rect:g},$=function(){var t="object"==typeof window&&!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"));if(!t)return function(){throw new Error("SVG is required to use Vectorizer.")};var N={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},e=Math,g=e.PI,o=e.atan2,s=e.sqrt,h=e.min,f=e.max,v=e.cos,m=e.sin,L=function(t,e,n){if(!(this instanceof L))return L.apply(Object.create(L.prototype),arguments);if(t){if(L.isV(t)&&(t=t.node),e=e||{},L.isString(t)){if("svg"===t.toLowerCase())t=L.createSvgDocument();else if("<"===t[0]){var r=L.createSvgDocument(t);if(1<r.childNodes.length){var i,o,s=[];for(i=0,o=r.childNodes.length;i<o;i++){var a=r.childNodes[i];s.push(new L(document.importNode(a,!0)))}return s}t=document.importNode(r.firstChild,!0)}else t=document.createElementNS(N.svg,t);L.ensureId(t)}return this.node=t,this.setAttributes(e),n&&this.append(n),this}},n=L.prototype;function M(t,e,n){for(var r=(n=n||{}).includeAnnotationIndices,i=n.eol,o=n.lineHeight,s=n.baseSize,a=0,u={},l=e.length-1,c=0;c<=l;c++){var h=e[c],f=null;if(L.isObject(h)){var d=h.attrs,p=L("tspan",d),g=p.node,v=h.t;i&&c===l&&(v+=i),g.textContent=v;var m=d.class;m&&p.addClass(m),r&&p.attr("annotations",h.annotations),void 0===(f=parseFloat(d["font-size"]))&&(f=s),f&&a<f&&(a=f)}else i&&c===l&&(h+=i),g=document.createTextNode(h||" "),s&&a<s&&(a=s);t.appendChild(g)}return a&&(u.maxFontSize=a),o?u.lineHeight=o:a&&(u.lineHeight=1.2*a),u}Object.defineProperty(n,"id",{enumerable:!0,get:function(){return this.node.id},set:function(t){this.node.id=t}}),n.getTransformToElement=function(t){var e=this.node;if(L.isSVGGraphicsElement(t)&&L.isSVGGraphicsElement(e)){var n=L.toNode(t).getScreenCTM(),r=e.getScreenCTM();if(n&&r)return n.inverse().multiply(r)}return L.createSVGMatrix()},n.transform=function(t,e){var n=this.node;if(L.isUndefined(t))return L.transformStringToMatrix(this.attr("transform"));if(e&&e.absolute)return this.attr("transform",L.matrixToTransformString(t));var r=L.createSVGTransform(t);return n.transform.baseVal.appendItem(r),this},n.translate=function(t,e,n){n=n||{},e=e||0;var r=this.attr("transform")||"",i=L.parseTransformString(r);if(r=i.value,L.isUndefined(t))return i.translate;r=r.replace(/translate\([^)]*\)/g,"").trim();var o=n.absolute?t:i.translate.tx+t,s=n.absolute?e:i.translate.ty+e,a="translate("+o+","+s+")";return this.attr("transform",(a+" "+r).trim()),this},n.rotate=function(t,e,n,r){r=r||{};var i=this.attr("transform")||"",o=L.parseTransformString(i);if(i=o.value,L.isUndefined(t))return o.rotate;i=i.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var s=r.absolute?t:o.rotate.angle+t,a=void 0!==e&&void 0!==n?","+e+","+n:"",u="rotate("+s+a+")";return this.attr("transform",(i+" "+u).trim()),this},n.scale=function(t,e){e=L.isUndefined(e)?t:e;var n=this.attr("transform")||"",r=L.parseTransformString(n);if(n=r.value,L.isUndefined(t))return r.scale;n=n.replace(/scale\([^)]*\)/g,"").trim();var i="scale("+t+","+e+")";return this.attr("transform",(n+" "+i).trim()),this},n.bbox=function(t,e){var n,r=this.node,i=r.ownerSVGElement;if(!i)return new G(0,0,0,0);try{n=r.getBBox()}catch(t){n={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(t)return new G(n);var o=this.getTransformToElement(e||i);return L.transformRect(n,o)},n.getBBox=function(t){var e,n={},r=this.node,i=r.ownerSVGElement;if(!i||!L.isSVGGraphicsElement(r))return new G(0,0,0,0);if(t&&(t.target&&(n.target=L.toNode(t.target)),t.recursive&&(n.recursive=t.recursive)),n.recursive){var o=this.children(),s=o.length;if(0===s)return this.getBBox({target:n.target,recursive:!1});n.target||(n.target=this);for(var a=0;a<s;a++){var u,l=o[a];u=0===l.children().length?l.getBBox({target:n.target,recursive:!1}):l.getBBox({target:n.target,recursive:!0}),e=e?e.union(u):u}return e}try{e=r.getBBox()}catch(t){e={x:r.clientLeft,y:r.clientTop,width:r.clientWidth,height:r.clientHeight}}if(n.target){var c=this.getTransformToElement(n.target);return L.transformRect(e,c)}return new G(e)};var O=/em$/;function R(t,e){var n=parseFloat(t);return O.test(t)?n*e:n}n.text=function(t,e){if(t&&"string"!=typeof t)throw new Error("Vectorizer: text() expects the first argument to be a string.");t=L.sanitizeText(t);var n=(e=e||{}).eol,r=e.textPath,i=e.textVerticalAnchor,o="middle"===i||"bottom"===i||"top"===i,s=e.x;void 0===s&&(s=this.attr("x")||0);var a=e.includeAnnotationIndices,u=e.annotations;u&&!L.isArray(u)&&(u=[u]);var l=e.lineHeight,c="auto"===l,h=c?"1.5em":l||"1em";this.empty(),this.attr({"xml:space":"preserve",display:t?null:"none"});var f=parseFloat(this.attr("font-size"));f||(f=16,(o||u)&&this.attr("font-size",f));var d,p=document;d=r?("string"==typeof r&&(r={d:r}),function(t,e){t=t||{};var n=L("textPath"),r=t.d;if(r&&void 0===t["xlink:href"]){var i=L("path").attr("d",r).appendTo(e.defs());n.attr("xlink:href","#"+i.id)}L.isObject(t)&&n.attr(t);return n.node}(r,this)):p.createDocumentFragment();for(var g,v=0,m=t.split("\n"),y=[],b=0,w=m.length-1;b<=w;b++){var x,A=h,_="v-line",S=p.createElementNS(N.svg,"tspan"),k=m[b];if(k)if(u){var P=L.annotateString(k,u,{offset:-v,includeAnnotationIndices:a}),E=(x=M(S,P,{includeAnnotationIndices:a,eol:b!==w&&n,lineHeight:c?null:h,baseSize:f})).lineHeight;E&&c&&0!==b&&(A=E),0===b&&(g=.8*x.maxFontSize)}else n&&b!==w&&(k+=n),S.textContent=k;else{S.textContent="-",_+=" v-empty-line";var C=S.style;C.fillOpacity=0,C.strokeOpacity=0,u&&(x={})}x&&y.push(x),0<b&&S.setAttribute("dy",A),(0<b||r)&&S.setAttribute("x",s),S.className.baseVal=_,d.appendChild(S),v+=k.length+1}if(o)if(u)A=function(t,e,n,r){if(!Array.isArray(e))return 0;var i=e.length;if(!i)return 0;for(var o=e[0],s=R(o.maxFontSize,n)||n,a=0,u=R(r,n),l=1;l<i;l++){var c=R((o=e[l]).lineHeight,n)||u;a+=c}var h,f=R(o.maxFontSize,n)||n;switch(t){case"middle":h=s/2-.15*f-a/2;break;case"bottom":h=-.25*f-a;break;default:case"top":h=.8*s}return h}(i,y,f,h);else if("top"===i)A="0.8em";else{var T;switch(0<w?(T=parseFloat(h)||1,T*=w,O.test(h)||(T/=f)):T=0,i){case"middle":A=.3-T/2+"em";break;case"bottom":A=-T-.3+"em"}}else 0===i?A="0em":i?A=i:(A=0,null===this.attr("y")&&this.attr("y",g||"0.8em"));return d.firstChild.setAttribute("dy",A),this.append(d),this},n.removeAttr=function(t){var e=L.qualifyAttr(t),n=this.node;return e.ns?n.hasAttributeNS(e.ns,e.local)&&n.removeAttributeNS(e.ns,e.local):n.hasAttribute(t)&&n.removeAttribute(t),this},n.attr=function(t,e){if(L.isUndefined(t)){for(var n=this.node.attributes,r={},i=0;i<n.length;i++)r[n[i].name]=n[i].value;return r}if(L.isString(t)&&L.isUndefined(e))return this.node.getAttribute(t);if("object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&this.setAttribute(o,t[o]);else this.setAttribute(t,e);return this},n.normalizePath=function(){var t=this.tagName();return"PATH"===t&&this.attr("d",L.normalizePathData(this.attr("d"))),this},n.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},n.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},n.setAttributes=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setAttribute(e,t[e]);return this},n.append=function(t){L.isArray(t)||(t=[t]);for(var e=0,n=t.length;e<n;e++)this.node.appendChild(L.toNode(t[e]));return this},n.prepend=function(t){var e=this.node.firstChild;return e?L(e).before(t):this.append(t)},n.before=function(t){var e=this.node,n=e.parentNode;if(n){L.isArray(t)||(t=[t]);for(var r=0,i=t.length;r<i;r++)n.insertBefore(L.toNode(t[r]),e)}return this},n.appendTo=function(t){return L.toNode(t).appendChild(this.node),this},n.svg=function(){return this.node instanceof window.SVGSVGElement?this:L(this.node.ownerSVGElement)},n.tagName=function(){return this.node.tagName.toUpperCase()},n.defs=function(){var t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?L(e):L("defs").appendTo(t)},n.clone=function(){var t=L(this.node.cloneNode(!0));return t.node.id=L.uniqueId(),t},n.findOne=function(t){var e=this.node.querySelector(t);return e?L(e):void 0},n.find=function(t){var e=[],n=this.node.querySelectorAll(t);if(n)for(var r=0;r<n.length;r++)e.push(L(n[r]));return e},n.children=function(){for(var t=this.node.childNodes,e=[],n=0;n<t.length;n++){var r=t[n];1===r.nodeType&&e.push(L(t[n]))}return e},n.index=function(){for(var t=0,e=this.node.previousSibling;e;)1===e.nodeType&&t++,e=e.previousSibling;return t},n.findParentByClass=function(t,e){for(var n=this.node.ownerSVGElement,r=this.node.parentNode;r&&r!==e&&r!==n;){var i=L(r);if(i.hasClass(t))return i;r=r.parentNode}return null},n.contains=function(t){var e=this.node,n=L.toNode(t),r=n&&n.parentNode;return e===r||!!(r&&1===r.nodeType&&16&e.compareDocumentPosition(r))},n.toLocalPoint=function(t,e){var n=this.svg().node,r=n.createSVGPoint();r.x=t,r.y=e;try{var i=r.matrixTransform(n.getScreenCTM().inverse()),o=this.getTransformToElement(n).inverse()}catch(t){return r}return i.matrixTransform(o)},n.translateCenterToPoint=function(t){var e=this.getBBox({target:this.svg()}),n=e.center();return this.translate(t.x-n.x,t.y-n.y),this},n.translateAndAutoOrient=function(t,e,n){t=new S(t),e=new S(e),n=n||this.svg();var r=this.scale();this.attr("transform","");var i=this.getBBox({target:n}).scale(r.sx,r.sy),o=L.createSVGTransform();o.setTranslate(-i.x-i.width/2,-i.y-i.height/2);var s=L.createSVGTransform(),a=t.angleBetween(e,t.clone().offset(1,0));a&&s.setRotate(a,0,0);var u=L.createSVGTransform(),l=t.clone().move(e,i.width/2);u.setTranslate(2*t.x-l.x,2*t.y-l.y);var c=this.getTransformToElement(n),h=L.createSVGTransform();return h.setMatrix(u.matrix.multiply(s.matrix.multiply(o.matrix.multiply(c.scale(r.sx,r.sy))))),this.attr("transform",L.matrixToTransformString(h.matrix)),this},n.animateAlongPath=function(t,e){e=L.toNode(e);var n=L.ensureId(e),r=L("animateMotion",t),i=L("mpath",{"xlink:href":"#"+n});r.append(i),this.append(r);try{r.node.beginElement()}catch(t){if("fake"===document.documentElement.getAttribute("smiling")){var o=r.node;o.animators=[];var s=o.getAttribute("id");s&&(id2anim[s]=o);for(var a=getTargets(o),u=0,l=a.length;u<l;u++){var c=a[u],h=new Animator(o,c,u);animators.push(h),(o.animators[u]=h).register()}}}return this},n.hasClass=function(t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(this.node.getAttribute("class"))},n.addClass=function(t){if(t&&!this.hasClass(t)){var e=this.node.getAttribute("class")||"";this.node.setAttribute("class",(e+" "+t).trim())}return this},n.removeClass=function(t){if(t&&this.hasClass(t)){var e=this.node.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");this.node.setAttribute("class",e)}return this},n.toggleClass=function(t,e){var n=L.isUndefined(e)?this.hasClass(t):!e;return n?this.removeClass(t):this.addClass(t),this},n.sample=function(t){t=t||1;for(var e,n=this.node,r=n.getTotalLength(),i=[],o=0;o<r;)e=n.getPointAtLength(o),i.push({x:e.x,y:e.y,distance:o}),o+=t;return i},n.convertToPath=function(){var t=L("path");t.attr(this.attr());var e=this.convertToPathData();return e&&t.attr("d",e),t},n.convertToPathData=function(){var t=this.tagName();switch(t){case"PATH":return this.attr("d");case"LINE":return L.convertLineToPathData(this.node);case"POLYGON":return L.convertPolygonToPathData(this.node);case"POLYLINE":return L.convertPolylineToPathData(this.node);case"ELLIPSE":return L.convertEllipseToPathData(this.node);case"CIRCLE":return L.convertCircleToPathData(this.node);case"RECT":return L.convertRectToPathData(this.node)}throw new Error(t+" cannot be converted to PATH.")},L.prototype.toGeometryShape=function(){var t,e,n,r,i,o,s,a,u,l,c,h,f,d,p;switch(this.tagName()){case"RECT":return t=parseFloat(this.attr("x"))||0,e=parseFloat(this.attr("y"))||0,n=parseFloat(this.attr("width"))||0,r=parseFloat(this.attr("height"))||0,new G(t,e,n,r);case"CIRCLE":return i=parseFloat(this.attr("cx"))||0,o=parseFloat(this.attr("cy"))||0,s=parseFloat(this.attr("r"))||0,new x({x:i,y:o},s,s);case"ELLIPSE":return i=parseFloat(this.attr("cx"))||0,o=parseFloat(this.attr("cy"))||0,a=parseFloat(this.attr("rx"))||0,u=parseFloat(this.attr("ry"))||0,new x({x:i,y:o},a,u);case"POLYLINE":return l=L.getPointsFromSvgNode(this),new T(l);case"POLYGON":return 1<(l=L.getPointsFromSvgNode(this)).length&&l.push(l[0]),new T(l);case"PATH":return c=this.attr("d"),C.isDataSupported(c)||(c=L.normalizePathData(c)),new C(c);case"LINE":return h=parseFloat(this.attr("x1"))||0,d=parseFloat(this.attr("y1"))||0,f=parseFloat(this.attr("x2"))||0,p=parseFloat(this.attr("y2"))||0,new A({x:h,y:d},{x:f,y:p})}return this.getBBox()},n.findIntersection=function(t,e){var n=this.svg().node;e=e||n;var r=this.getBBox({target:e}),i=r.center();if(r.intersectionWithLineFromCenterToPoint(t)){var o,s=this.tagName();if("RECT"===s){var a=new G(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),u=this.getTransformToElement(e),l=L.decomposeMatrix(u),c=n.createSVGTransform();c.setRotate(-l.rotation,i.x,i.y);var h=L.transformRect(a,c.matrix.multiply(u));o=new G(h).intersectionWithLineFromCenterToPoint(t,l.rotation)}else if("PATH"===s||"POLYGON"===s||"POLYLINE"===s||"CIRCLE"===s||"ELLIPSE"===s){var f,d,p,g,v,m,y="PATH"===s?this:this.convertToPath(),b=y.sample(),w=1/0,x=[];for(f=0;f<b.length;f++)d=b[f],p=(p=L.createSVGPoint(d.x,d.y)).matrixTransform(this.getTransformToElement(e)),d=new S(p),g=d.distance(i),v=1.1*d.distance(t),(m=g+v)<w?(w=m,x=[{sample:d,refDistance:v}]):m<w+1&&x.push({sample:d,refDistance:v});x.sort(function(t,e){return t.refDistance-e.refDistance}),x[0]&&(o=x[0].sample)}return o}},n.setAttribute=function(t,e){var n=this.node;if(null===e)return this.removeAttr(t),this;var r=L.qualifyAttr(t);return r.ns?n.setAttributeNS(r.ns,t,e):"id"===t?n.id=e:n.setAttribute(t,e),this},L.createSvgDocument=function(t){if(t){var e='<svg xmlns="'+N.svg+'" xmlns:xlink="'+N.xlink+'" version="1.1">'+t+"</svg>",n=L.parseXML(e,{async:!1}),r=n.documentElement;return r}var i=document.createElementNS(N.svg,"svg");return i.setAttributeNS(N.xmlns,"xmlns:xlink",N.xlink),i.setAttribute("version","1.1"),i},L.idCounter=0,L.uniqueId=function(){return"v-"+ ++L.idCounter},L.toNode=function(t){return L.isV(t)?t.node:t.nodeName&&t||t[0]},L.ensureId=function(t){return(t=L.toNode(t)).id||(t.id=L.uniqueId())},L.sanitizeText=function(t){return(t||"").replace(/ /g,"")},L.isUndefined=function(t){return void 0===t},L.isString=function(t){return"string"==typeof t},L.isObject=function(t){return t&&"object"==typeof t},L.isArray=Array.isArray,L.parseXML=function(t,e){var n;e=e||{};try{var r=new DOMParser;L.isUndefined(e.async)||(r.async=e.async),n=r.parseFromString(t,"text/xml")}catch(t){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return n},L.qualifyAttr=function(t){if(-1===t.indexOf(":"))return{ns:null,local:t};var e=t.split(":");return{ns:N[e[0]],local:e[1]}},L.transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,L.transformSeparatorRegex=/[ ,]+/,L.transformationListRegex=/^(\w+)\((.*)\)/,L.transformStringToMatrix=function(t){var e=L.createSVGMatrix(),n=t&&t.match(L.transformRegex);if(!n)return e;for(var r=0,i=n.length;r<i;r++){var o=n[r],s=o.match(L.transformationListRegex);if(s){var a,u,l,c,h,f=L.createSVGMatrix(),d=s[2].split(L.transformSeparatorRegex);switch(s[1].toLowerCase()){case"scale":a=parseFloat(d[0]),u=void 0===d[1]?a:parseFloat(d[1]),f=f.scaleNonUniform(a,u);break;case"translate":l=parseFloat(d[0]),c=parseFloat(d[1]),f=f.translate(l,c);break;case"rotate":h=parseFloat(d[0]),l=parseFloat(d[1])||0,c=parseFloat(d[2])||0,f=0!==l||0!==c?f.translate(l,c).rotate(h).translate(-l,-c):f.rotate(h);break;case"skewx":h=parseFloat(d[0]),f=f.skewX(h);break;case"skewy":h=parseFloat(d[0]),f=f.skewY(h);break;case"matrix":f.a=parseFloat(d[0]),f.b=parseFloat(d[1]),f.c=parseFloat(d[2]),f.d=parseFloat(d[3]),f.e=parseFloat(d[4]),f.f=parseFloat(d[5]);break;default:continue}e=e.multiply(f)}}return e},L.matrixToTransformString=function(t){return"matrix("+(void 0!==(t=t||!0).a?t.a:1)+","+(void 0!==t.b?t.b:0)+","+(void 0!==t.c?t.c:0)+","+(void 0!==t.d?t.d:1)+","+(void 0!==t.e?t.e:0)+","+(void 0!==t.f?t.f:0)+")"},L.parseTransformString=function(t){var e,n,r;if(t){var i=L.transformSeparatorRegex;if(0<=t.trim().indexOf("matrix")){var o=L.transformStringToMatrix(t),s=L.decomposeMatrix(o);e=[s.translateX,s.translateY],r=[s.scaleX,s.scaleY],n=[s.rotation];var a=[];0===e[0]&&0===e[1]||a.push("translate("+e+")"),1===r[0]&&1===r[1]||a.push("scale("+r+")"),0!==n[0]&&a.push("rotate("+n+")"),t=a.join(" ")}else{var u=t.match(/translate\((.*?)\)/);u&&(e=u[1].split(i));var l=t.match(/rotate\((.*?)\)/);l&&(n=l[1].split(i));var c=t.match(/scale\((.*?)\)/);c&&(r=c[1].split(i))}}var h=r&&r[0]?parseFloat(r[0]):1;return{value:t,translate:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotate:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:h,sy:r&&r[1]?parseFloat(r[1]):h}}},L.deltaTransformPoint=function(t,e){var n=e.x*t.a+e.y*t.c+0,r=e.x*t.b+e.y*t.d+0;return{x:n,y:r}},L.decomposeMatrix=function(t){var e=L.deltaTransformPoint(t,{x:0,y:1}),n=L.deltaTransformPoint(t,{x:1,y:0}),r=180/g*o(e.y,e.x)-90,i=180/g*o(n.y,n.x);return{translateX:t.e,translateY:t.f,scaleX:s(t.a*t.a+t.b*t.b),scaleY:s(t.c*t.c+t.d*t.d),skewX:r,skewY:i,rotation:r}},L.matrixToScale=function(t){var e,n,r,i;return t?(e=L.isUndefined(t.a)?1:t.a,i=L.isUndefined(t.d)?1:t.d,n=t.b,r=t.c):e=i=1,{sx:n?s(e*e+n*n):e,sy:r?s(r*r+i*i):i}},L.matrixToRotate=function(t){var e={x:0,y:1};return t&&(e=L.deltaTransformPoint(t,e)),{angle:w(p(o(e.y,e.x))-90)}},L.matrixToTranslate=function(t){return{tx:t&&t.e||0,ty:t&&t.f||0}},L.isV=function(t){return t instanceof L},L.isVElement=L.isV,L.isSVGGraphicsElement=function(t){return!!t&&((t=L.toNode(t))instanceof SVGElement&&"function"==typeof t.getScreenCTM)};var d=L("svg").node;return L.createSVGMatrix=function(t){var e=d.createSVGMatrix();for(var n in t)e[n]=t[n];return e},L.createSVGTransform=function(t){return L.isUndefined(t)?d.createSVGTransform():(t instanceof SVGMatrix||(t=L.createSVGMatrix(t)),d.createSVGTransformFromMatrix(t))},L.createSVGPoint=function(t,e){var n=d.createSVGPoint();return n.x=t,n.y=e,n},L.transformRect=function(t,e){var n=d.createSVGPoint();n.x=t.x,n.y=t.y;var r=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y;var i=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y+t.height;var o=n.matrixTransform(e);n.x=t.x,n.y=t.y+t.height;var s=n.matrixTransform(e),a=h(r.x,i.x,o.x,s.x),u=f(r.x,i.x,o.x,s.x),l=h(r.y,i.y,o.y,s.y),c=f(r.y,i.y,o.y,s.y);return new G(a,l,u-a,c-l)},L.transformPoint=function(t,e){return new S(L.createSVGPoint(t.x,t.y).matrixTransform(e))},L.transformLine=function(t,e){return new A(L.transformPoint(t.start,e),L.transformPoint(t.end,e))},L.transformPolyline=function(t,e){var n=t instanceof T?t.points:t;L.isArray(n)||(n=[]);for(var r=[],i=0,o=n.length;i<o;i++)r[i]=L.transformPoint(n[i],e);return new T(r)},L.styleToObject=function(t){for(var e={},n=t.split(";"),r=0;r<n.length;r++){var i=n[r],o=i.split("=");e[o[0].trim()]=o[1].trim()}return e},L.createSlicePathData=function(t,e,n,r){var i=2*g-1e-6,o=t,s=e,a=n,u=r,l=(u<a&&(l=a,a=u,u=l),u-a),c=l<g?"0":"1",h=v(a),f=m(a),d=v(u),p=m(u);return i<=l?o?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+o+"A"+o+","+o+" 0 1,0 0,"+-o+"A"+o+","+o+" 0 1,0 0,"+o+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":o?"M"+s*h+","+s*f+"A"+s+","+s+" 0 "+c+",1 "+s*d+","+s*p+"L"+o*d+","+o*p+"A"+o+","+o+" 0 "+c+",0 "+o*h+","+o*f+"Z":"M"+s*h+","+s*f+"A"+s+","+s+" 0 "+c+",1 "+s*d+","+s*p+"L0,0Z"},L.mergeAttrs=function(t,e){for(var n in e)"class"===n?t[n]=t[n]?t[n]+" "+e[n]:e[n]:"style"===n?L.isObject(t[n])&&L.isObject(e[n])?t[n]=L.mergeAttrs(t[n],e[n]):L.isObject(t[n])?t[n]=L.mergeAttrs(t[n],L.styleToObject(e[n])):L.isObject(e[n])?t[n]=L.mergeAttrs(L.styleToObject(t[n]),e[n]):t[n]=L.mergeAttrs(L.styleToObject(t[n]),L.styleToObject(e[n])):t[n]=e[n];return t},L.annotateString=function(t,e,n){e=e||[];for(var r,i,o,s=(n=n||{}).offset||0,a=[],u=[],l=0;l<t.length;l++){i=u[l]=t[l];for(var c=0;c<e.length;c++){var h=e[c],f=h.start+s,d=h.end+s;f<=l&&l<d&&(L.isObject(i)?i.attrs=L.mergeAttrs(L.mergeAttrs({},i.attrs),h.attrs):i=u[l]={t:t[l],attrs:h.attrs},n.includeAnnotationIndices&&(i.annotations||(i.annotations=[])).push(c))}(o=u[l-1])?L.isObject(i)&&L.isObject(o)?JSON.stringify(i.attrs)===JSON.stringify(o.attrs)?r.t+=i.t:(a.push(r),r=i):r=L.isObject(i)?(a.push(r),i):L.isObject(o)?(a.push(r),i):(r||"")+i:r=i}return r&&a.push(r),a},L.findAnnotationsAtIndex=function(t,e){var n=[];return t&&t.forEach(function(t){t.start<e&&e<=t.end&&n.push(t)}),n},L.findAnnotationsBetweenIndexes=function(t,e,n){var r=[];return t&&t.forEach(function(t){(e>=t.start&&e<t.end||n>t.start&&n<=t.end||t.start>=e&&t.end<n)&&r.push(t)}),r},L.shiftAnnotations=function(t,e,n){return t&&t.forEach(function(t){t.start<e&&t.end>=e?t.end+=n:t.start>=e&&(t.start+=n,t.end+=n)}),t},L.convertLineToPathData=function(t){var e=["M",(t=L(t)).attr("x1"),t.attr("y1"),"L",t.attr("x2"),t.attr("y2")].join(" ");return e},L.convertPolygonToPathData=function(t){var e=L.getPointsFromSvgNode(t);return 0===e.length?null:L.svgPointsToPath(e)+" Z"},L.convertPolylineToPathData=function(t){var e=L.getPointsFromSvgNode(t);return 0===e.length?null:L.svgPointsToPath(e)},L.svgPointsToPath=function(t){for(var e=0,n=t.length;e<n;e++)t[e]=t[e].x+" "+t[e].y;return"M "+t.join(" L")},L.getPointsFromSvgNode=function(t){t=L.toNode(t);var e=[],n=t.points;if(n)for(var r=0,i=n.numberOfItems;r<i;r++)e.push(n.getItem(r));return e},L.KAPPA=.551784,L.convertCircleToPathData=function(t){t=L(t);var e=parseFloat(t.attr("cx"))||0,n=parseFloat(t.attr("cy"))||0,r=parseFloat(t.attr("r")),i=r*L.KAPPA,o=["M",e,n-r,"C",e+i,n-r,e+r,n-i,e+r,n,"C",e+r,n+i,e+i,n+r,e,n+r,"C",e-i,n+r,e-r,n+i,e-r,n,"C",e-r,n-i,e-i,n-r,e,n-r,"Z"].join(" ");return o},L.convertEllipseToPathData=function(t){t=L(t);var e=parseFloat(t.attr("cx"))||0,n=parseFloat(t.attr("cy"))||0,r=parseFloat(t.attr("rx")),i=parseFloat(t.attr("ry"))||r,o=r*L.KAPPA,s=i*L.KAPPA,a=["M",e,n-i,"C",e+o,n-i,e+r,n-s,e+r,n,"C",e+r,n+s,e+o,n+i,e,n+i,"C",e-o,n+i,e-r,n+s,e-r,n,"C",e-r,n-s,e-o,n-i,e,n-i,"Z"].join(" ");return a},L.convertRectToPathData=function(t){return t=L(t),L.rectToPath({x:parseFloat(t.attr("x"))||0,y:parseFloat(t.attr("y"))||0,width:parseFloat(t.attr("width"))||0,height:parseFloat(t.attr("height"))||0,rx:parseFloat(t.attr("rx"))||0,ry:parseFloat(t.attr("ry"))||0})},L.rectToPath=function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=h(t.rx||t["top-rx"]||0,r/2),s=h(t.rx||t["bottom-rx"]||0,r/2),a=h(t.ry||t["top-ry"]||0,i/2),u=h(t.ry||t["bottom-ry"]||0,i/2);return(o||s||a||u?["M",e,n+a,"v",i-a-u,"a",s,u,0,0,0,s,u,"h",r-2*s,"a",s,u,0,0,0,s,-u,"v",-(i-u-a),"a",o,a,0,0,0,-o,-a,"h",-(r-2*o),"a",o,a,0,0,0,-o,a,"Z"]:["M",e,n,"H",e+r,"V",n+i,"H",e,"V",n,"Z"]).join(" ")},L.normalizePathData=function(){var t="\t\n\v\f\r \u2028\u2029",g=new RegExp("([a-z])["+t+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+t+"]*,?["+t+"]*)+)","ig"),v=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+t+"]*,?["+t+"]*","ig"),e=Math,U=e.PI,$=e.sin,G=e.cos,W=e.tan,X=e.asin,Y=e.sqrt,J=e.abs;function f(t,e,n,r,i,o){return[1/3*t+2/3*n,1/3*e+2/3*r,1/3*i+2/3*n,1/3*o+2/3*r,i,o]}function d(t){if(Array.isArray(t)&&Array.isArray(t&&t[0])||(t=function(t){if(!t)return null;var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return String(t).replace(g,function(t,e,n){var r=[],i=e.toLowerCase();for(n.replace(v,function(t,e){e&&r.push(+e)}),"m"===i&&2<r.length&&(s.push([e].concat(r.splice(0,2))),i="l",e="m"===e?"l":"L");r.length>=o[i]&&(s.push([e].concat(r.splice(0,o[i]))),o[i]););}),s}(t)),!t||!t.length)return[["M",0,0]];for(var e,n=[],r=0,i=0,o=0,s=0,a=t.length,u=0;u<a;u++){var l=[];n.push(l);var c,h,f=t[u];if((e=f[0])!=e.toUpperCase())switch(l[0]=e.toUpperCase(),l[0]){case"A":l[1]=f[1],l[2]=f[2],l[3]=f[3],l[4]=f[4],l[5]=f[5],l[6]=+f[6]+r,l[7]=+f[7]+i;break;case"V":l[1]=+f[1]+i;break;case"H":l[1]=+f[1]+r;break;case"M":for(o=+f[1]+r,s=+f[2]+i,c=f.length,h=1;h<c;h++)l[h]=+f[h]+(h%2?r:i);break;default:for(c=f.length,h=1;h<c;h++)l[h]=+f[h]+(h%2?r:i)}else for(var d=f.length,p=0;p<d;p++)l[p]=f[p];switch(l[0]){case"Z":r=+o,i=+s;break;case"H":r=l[1];break;case"V":i=l[1];break;case"M":o=l[l.length-2],s=l[l.length-1],r=l[l.length-2],i=l[l.length-1];break;default:r=l[l.length-2],i=l[l.length-1]}}return n}function n(t){var r=d(t),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function n(t,e,n){var r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat(function t(e,n,r,i,o,s,a,u,l,c){var h=120*U/180;var f=U/180*(+o||0);var d=[];var p;var g=function(t,e,n){var r=t*G(n)-e*$(n),i=t*$(n)+e*G(n);return{x:r,y:i}};if(c)S=c[0],k=c[1],A=c[2],_=c[3];else{p=g(e,n,-f),e=p.x,n=p.y,p=g(u,l,-f),u=p.x,l=p.y;var v=(e-u)/2,m=(n-l)/2,y=v*v/(r*r)+m*m/(i*i);1<y&&(y=Y(y),r*=y,i*=y);var b=r*r,w=i*i,x=(s==a?-1:1)*Y(J((b*w-b*m*m-w*v*v)/(b*m*m+w*v*v))),A=x*r*m/i+(e+u)/2,_=x*-i*v/r+(n+l)/2,S=X(((n-_)/i).toFixed(9)),k=X(((l-_)/i).toFixed(9));(S=e<A?U-S:S)<0&&(S=2*U+S),(k=u<A?U-k:k)<0&&(k=2*U+k),k<(a&&S)&&(S-=2*U),S<(!a&&k)&&(k-=2*U)}var P=k-S;if(J(P)>h){var E=k,C=u,T=l;u=A+r*G(k=S+h*(S<(a&&k)?1:-1)),l=_+i*$(k),d=t(u,l,r,i,o,0,a,C,T,[k,E,A,_])}P=k-S;var N=G(S);var L=$(S);var M=G(k);var O=$(k);var R=W(P/4);var D=4/3*(r*R);var j=4/3*(i*R);var F=[e,n];var B=[e+D*L,n-j*N];var V=[u+D*O,l-j*M];var I=[u,l];B[0]=2*F[0]-B[0];B[1]=2*F[1]-B[1];{if(c)return[B,V,I].concat(d);d=[B,V,I].concat(d).join().split(",");for(var z=[],q=d.length,H=0;H<q;H++)z[H]=H%2?g(d[H-1],d[H],f).y:g(d[H],d[H+1],f).x;return z}}.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":i="C"===n||"S"===n?(r=2*e.x-e.bx,2*e.y-e.by):(r=e.x,e.y),t=["C",r,i].concat(t.slice(1));break;case"T":"Q"===n||"T"===n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(f(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(f(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"H":t=["L"].concat(t[1],e.y);break;case"V":t=["L"].concat(e.x,t[1])}return t}function i(t,e){if(7<t[e].length){t[e].shift();for(var n=t[e];n.length;)o[e]="A",t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),u=r.length}}for(var o=[],s="",a="",u=r.length,l=0;l<u;l++){r[l]&&(s=r[l][0]),"C"!==s&&(o[l]=s,0<l&&(a=o[l-1])),r[l]=n(r[l],e,a),"A"!==o[l]&&"C"===s&&(o[l]="C"),i(r,l);var c=r[l],h=c.length;e.x=c[h-2],e.y=c[h-1],e.bx=parseFloat(c[h-4])||e.x,e.by=parseFloat(c[h-3])||e.y}return r[0][0]&&"M"===r[0][0]||r.unshift(["M",0,0]),r}return function(t){return n(t).join(",").split(",").join(" ")}}(),L.namespace=N,L.g=U,L}(),W={useCSSSelectors:!0,classNamePrefix:"joint-",defaultTheme:"default"},X=function(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,W.classNamePrefix.length)!==W.classNamePrefix&&(t=W.classNamePrefix+t),t}).join(" "):t},Y=function(t){return t?t.toString().split(" ").map(function(t){return t.substr(0,W.classNamePrefix.length)===W.classNamePrefix&&(t=t.substr(W.classNamePrefix.length)),t}).join(" "):t},J=function(t,e){for(var n={},r={},i=$.namespace.svg,o=e||i,s=document.createDocumentFragment(),a=[t,s,o];0<a.length;){o=a.pop();for(var u=a.pop(),l=a.pop(),c=0,h=l.length;c<h;c++){var f=l[c];if(!f.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var d=f.tagName;f.hasOwnProperty("namespaceURI")&&(o=f.namespaceURI);var p=document.createElementNS(o,d),g=o===i,v=g?$:E,m=f.attributes;m&&v(p).attr(m);var y=f.style;if(y&&E(p).css(y),f.hasOwnProperty("className")){var b=f.className;g?p.className.baseVal=b:p.className=b}if(f.hasOwnProperty("textContent")&&(p.textContent=f.textContent),f.hasOwnProperty("selector")){var w=f.selector;if(n[w])throw new Error("json-dom-parser: selector must be unique");n[w]=p,v(p).attr("joint-selector",w)}if(f.hasOwnProperty("groupSelector")){var x=f.groupSelector;Array.isArray(x)||(x=[x]);for(var A=0,_=x.length;A<_;A++){var S=x[A],k=r[S];(k=k||(r[S]=[])).push(p)}}u.appendChild(p);var P=f.children;Array.isArray(P)&&a.push(P,p,o)}}return{fragment:s,selectors:n,groupSelectors:r}},Z=function(t){var e=0;if(0===t.length)return e;for(var n=0;n<t.length;n++){var r=t.charCodeAt(n);e=(e<<5)-e+r,e&=e}return e},K=function(t,e,n){for(var r,i=Array.isArray(e)?e.slice():e.split(n||"/");i.length;){if(r=i.shift(),!(Object(t)===t&&r in t))return;t=t[r]}return t},Q=function(t,e,n,r){for(var i=Array.isArray(e)?e:e.split(r||"/"),o=t,s=0,a=i.length;s<a-1;s++)o=o[i[s]]||(o[i[s]]={});return o[i[a-1]]=n,t},tt=function(t,e,n){n=n||"/";var r=Array.isArray(e)?e.slice():e.split(n),i=r.pop();if(0<r.length){var o=K(t,r,n);o&&delete o[i]}else delete t[i];return t},et=function(t,e,n){e=e||"/";var r={};for(var i in t)if(t.hasOwnProperty(i)){var o="object"==typeof t[i];if(o&&n&&n(t[i])&&(o=!1),o){var s=et(t[i],e,n);for(var a in s)s.hasOwnProperty(a)&&(r[i+e+a]=s[a])}else r[i]=t[i]}return r},nt=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},rt=function(t){return rt.id=rt.id||1,t.id=void 0===t.id?"j_"+rt.id++:t.id,t.id},it=function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},ot=function(t){var e=t,n=t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0];if(n){for(var r in t)void 0===n[r]&&(n[r]=t[r]);e=n}var i=e.target;if(i){var o=i.correspondingUseElement;o&&(e.target=o)}return e},st=function(){var i;if("undefined"!=typeof window&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!i){var o=0;i=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-o)),r=setTimeout(function(){t(e+n)},n);return o=e+n,r}}return function(t,e){for(var n=[],r=arguments.length-2;0<r--;)n[r]=arguments[r+2];return i(void 0!==e?t.bind.apply(t,[e].concat(n)):t)}}(),at=function(){var t,e="undefined"!=typeof window;return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?t.bind(window):t}(),ut=function(t){return ie(t)&&"%"===t.slice(-1)},lt=function(n,t){var e=parseFloat(n);if(Number.isNaN(e))return null;var r,i={};if(i.value=e,null==t)r="[A-Za-z]*";else if(Array.isArray(t)){if(0===t.length)return null;r=t.join("|")}else ie(t)&&(r=t);var o=function(t){var e=new RegExp("(?:\\d+(?:\\.\\d+)*)("+t+")$").exec(n);return e?e[1]:null}(r);return null===o?null:(i.unit=o,i)},ct=function(t,e,n,r){r=r||{},n=n||{};var i=e.width,o=e.height,s=r.svgDocument||$("svg").node,a=$("tspan").node,u=$("text").attr(n).append(a).node,l=document.createTextNode("");u.style.opacity=0,u.style.display="block",a.style.display="block",a.appendChild(l),s.appendChild(u),r.svgDocument||document.body.appendChild(s);for(var c,h,f,d=r.separator||" ",p=r.eol||"\n",g=r.hyphen?new RegExp(r.hyphen):/[^\w\d]/,v=t.split(d),m=[],y=[],b=0,w=0,x=v.length;b<x;b++){var A=v[b];if(A)if(p&&0<=A.indexOf(p))if(1<A.length){for(var _=A.split(p),S=0,k=_.length-1;S<k;S++)_.splice(2*S+1,0,p);Array.prototype.splice.apply(v,[b,1].concat(_)),b--,x+=_.length-1}else w++;else{if(l.data=y[w]?y[w]+" "+A:A,a.getComputedTextLength()<=i)y[w]=l.data,(c||h)&&(m[w++]=!0,h=c=0);else{if(!y[w]||c){var P=!!c;if(c=A.length-1,P||!c){if(!c){if(!y[w]){y=[];break}v.splice(b,2,A+v[b+1]),x--,m[w++]=!0,b--;continue}v[b]=A.substring(0,c),v[b+1]=A.substring(c)+v[b+1]}else{if(h)v.splice(b,2,v[b]+v[b+1]),h=0;else{var E=A.search(g);-1<E&&E!==A.length-1&&0!==E&&(h=E+1,c=0),v.splice(b,1,A.substring(0,h||c),A.substring(h||c)),x++}w&&!m[w-1]&&w--}b--;continue}w++,b--}if(void 0!==o){var C;if(void 0===f)C="auto"===n.lineHeight?{value:1.5,unit:"em"}:lt(n.lineHeight,["em"])||{value:1,unit:"em"},f=C.value,"em"===C.unit&&(f*=u.getBBox().height);if(f*y.length>o){var T=Math.floor(o/f)-1;y.splice(1+T);var N=r.ellipsis;if(!N||T<0)break;"string"!=typeof N&&(N="");var L,M,O=y[T],R=O.length;do{if(M=O[R],L=O.substring(0,R),M?M.match(d)&&(L+=M):L+="string"==typeof d?d:" ",L+=N,l.data=L,a.getComputedTextLength()<=i){y[T]=L;break}R--}while(0<=R);break}}}}return r.svgDocument?s.removeChild(u):document.body.removeChild(s),y.join(p)},ht=function(t){var e=E(E.parseHTML("<div>"+t+"</div>",null,!1));return e.find("*").each(function(){var n=this;E.each(n.attributes,function(){var t=this.name,e=this.value;0!==t.indexOf("on")&&0!==e.indexOf("javascript:")||E(n).removeAttr(t)})}),e.html()},ft=function(t,e){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,e);else{var n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}},dt=function(t){t=t.replace(/\s/g,"");var e,n=(t=decodeURIComponent(t)).indexOf(","),r=t.slice(0,n),i=r.split(":")[1].split(";")[0],o=t.slice(n+1);e=0<=r.indexOf("base64")?atob(o):unescape(encodeURIComponent(o));for(var s=new Uint8Array(e.length),a=0;a<e.length;a++)s[a]=e.charCodeAt(a);return new Blob([s],{type:i})},pt=function(t,e){var n=E(t),r=n.map(function(){var t=this.parentNode,e=t.insertBefore(document.createTextNode(""),this.nextSibling);return function(){if(t===this)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(this,e),t.removeChild(e)}});return Array.prototype.sort.call(n,e).each(function(t){r[t].call(this)})},gt=function(t){if(Object(t)===t)return e=n=r=i=0,isFinite(t.vertical)&&(e=r=+t.vertical),isFinite(t.horizontal)&&(n=i=+t.horizontal),isFinite(t.top)&&(e=+t.top),isFinite(t.right)&&(n=+t.right),isFinite(t.bottom)&&(r=+t.bottom),isFinite(t.left)&&(i=+t.left),{top:e,right:n,bottom:r,left:i};var e,n,r,i,o=0;return isFinite(t)&&(o=+t),{top:o,right:o,bottom:o,left:o}},vt={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(1<=t)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if((7-4*e)/11<=t){var r=(11-6*e-11*t)/4;return-r*r+n*n}},reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}},clamp:function(n,r,i){return r=r||0,i=i||1,function(t){var e=n(t);return e<r?r:i<e?i:e}},back:function(e){return e=e||1.70158,function(t){return t*t*((e+1)*t-e)}},elastic:function(e){return e=e||1.5,function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}},mt={number:function(e,t){var n=t-e;return function(t){return e+n*t}},object:function(i,o){var s=Object.keys(i);return function(t){var e,n,r={};for(e=s.length-1;-1!=e;e--)n=s[e],r[n]=i[n]+(o[n]-i[n])*t;return r}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),r=parseInt(e.slice(1),16),i=255&n,o=(255&r)-i,s=65280&n,a=(65280&r)-s,u=16711680&n,l=(16711680&r)-u;return function(t){var e=i+o*t&255,n=s+a*t&65280,r=u+l*t&16711680;return"#"+(1<<24|e|n|r).toString(16).slice(1)}},unit:function(e,t){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(e),i=n.exec(t),o=i[1].indexOf("."),s=0<o?i[1].length-o-1:0;e=+r[1];var a=+i[1]-e,u=r[2];return function(t){return(e+a*t).toFixed(s)+u}}},yt={outline:function(t){var e=Number.isFinite(t.margin)?t.margin:2,n=Number.isFinite(t.width)?t.width:1;return wt('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>')({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:e+n,innerRadius:e})},highlight:function(t){return wt('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>')({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return wt('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return wt(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return wt('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return wt('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return wt('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return wt('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return wt('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return wt('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return wt('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},bt={number:function(t,e,o){o=o||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var n=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i.exec(t),r=n[1]||" ",i=n[2]||">",s=n[3]||"",a=n[4]||"",u=n[5],l=+n[6],c=n[7],h=n[8],f=n[9],d=1,p="",g="",v=!1;switch(h=h&&+h.substring(1),(u||"0"===r&&"="===i)&&(u=r="0",i="=",c&&(l-=Math.floor((l-1)/4))),f){case"n":c=!0,f="g";break;case"%":d=100,g="%",f="f";break;case"p":d=100,g="%",f="r";break;case"b":case"o":case"x":case"X":"#"===a&&(p="0"+f.toLowerCase());break;case"c":case"d":v=!0,h=0;break;case"s":d=-1,f="r"}"$"===a&&(p=o.currency[0],g=o.currency[1]),"r"!=f||h||(f="g"),null!=h&&("g"==f?h=Math.max(1,Math.min(21,h)):"e"!=f&&"f"!=f||(h=Math.max(0,Math.min(20,h))));var m=u&&c;if(v&&e%1)return"";var y=e<0||0===e&&1/e<0?(e=-e,"-"):s,b=g;if(d<0){var w=this.prefix(e,h);e=w.scale(e),b=w.symbol+g}else e*=d;var x=(e=this.convert(f,e,h)).lastIndexOf("."),A=x<0?e:e.substring(0,x),_=x<0?"":o.decimal+e.substring(x+1);function S(t){for(var e=t.length,n=[],r=0,i=o.grouping[0];0<e&&0<i;)n.push(t.substring(e-=i,e+i)),i=o.grouping[r=(r+1)%o.grouping.length];return n.reverse().join(o.thousands)}!u&&c&&o.grouping&&(A=S(A));var k=p.length+A.length+_.length+(m?0:y.length),P=k<l?new Array(k=l-k+1).join(r):"";return m&&(A=S(P+A)),y+=p,e=A+_,("<"===i?y+e+P:">"===i?P+y+e:"^"===i?P.substring(0,k>>=1)+y+e+P.substring(k):y+(m?e:P+e))+b},string:function(t,e){for(var n,r="{",i=!1,o=[];-1!==(n=t.indexOf(r));){var s,a,u;if(s=t.slice(0,n),i){a=s.split(":"),u=a.shift().split("."),s=e;for(var l=0;l<u.length;l++)s=s[u[l]];a.length&&(s=this.number(a,s))}o.push(s),t=t.slice(n+1),r=(i=!i)?"}":"{"}return o.push(t),o.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*Math.abs(8-e));return{scale:8<e?function(t){return t/n}:function(t){return t*n},symbol:t}}),r=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r<=0?r+1:r-1)/3)))),n[8+r/3]}},wt=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(o){return o=o||{},t.replace(e,function(t){for(var e=Array.from(arguments),n=e.slice(1,4).find(function(t){return!!t}),r=n.split("."),i=o[r.shift()];void 0!==i&&r.length;)i=i[r.shift()];return void 0!==i?i:""})}},xt=n.assign,At=n.defaults,_t=xt,St=n.defaultsDeep,kt=n.assign,Pt=n.defaults,Et=n.defaultsDeep,Ct=n.invokeMap||n.invoke,Tt=n.sortedIndexBy||n.sortedIndex,Nt=n.uniqBy||n.uniq,Lt=n.clone,Mt=n.cloneDeep,Ot=n.isEmpty,Rt=n.isEqual,Dt=n.isFunction,jt=n.isPlainObject,Ft=n.toArray,Bt=n.debounce,Vt=n.groupBy,It=n.sortBy,zt=n.flattenDeep,qt=n.without,Ht=n.difference,Ut=n.intersection,$t=n.union,Gt=n.has,Wt=n.result,Xt=n.omit,Yt=n.pick,Jt=n.bindAll,Zt=n.forIn,Kt=n.camelCase,Qt=n.uniqueId,te=function(){if(n.mergeWith){var t=Array.from(arguments),e=t[t.length-1],r=Dt(e)?e:oe;return t.push(function(t,e){var n=r(t,e);return void 0!==n?n:Array.isArray(t)&&!Array.isArray(e)?e:void 0}),n.mergeWith.apply(this,t)}return n.merge.apply(this,arguments)},ee=function(t){var e=Object.prototype.toString;return!0===t||!1===t||!!t&&"object"==typeof t&&"[object Boolean]"===e.call(t)},ne=function(t){return!!t&&("object"==typeof t||"function"==typeof t)},re=function(t){var e=Object.prototype.toString;return"number"==typeof t||!!t&&"object"==typeof t&&"[object Number]"===e.call(t)},ie=function(t){var e=Object.prototype.toString;return"string"==typeof t||!!t&&"object"==typeof t&&"[object String]"===e.call(t)},oe=function(){};function se(t){t=Nt(t);var s=Ft(t).reduce(function(t,e){return t[e.id]=e.clone(),t},{});return Ft(t).forEach(function(t){var e=s[t.id];if(e.isLink()){var n=e.source(),r=e.target();n.id&&s[n.id]&&e.prop("source/id",s[n.id].id),r.id&&s[r.id]&&e.prop("target/id",s[r.id].id)}var i=t.get("parent");i&&s[i]&&e.set("parent",s[i].id);var o=Ft(t.get("embeds")).reduce(function(t,e){return s[e]&&t.push(s[e].id),t},[]);Ot(o)||e.set("embeds",o)}),s}function ae(o,s){return function(t,e){var n=ut(t);t=parseFloat(t),n&&(t/=100);var r={};if(isFinite(t)){var i=n||0<=t&&t<=1?t*e[s]:Math.max(t+e[s],0);r[o]=i}return r}}function ue(s,a,u){return function(t,e){var n,r=ut(t);if(t=parseFloat(t),r&&(t/=100),isFinite(t)){var i=e[u]();n=r||0<t&&t<1?i[s]+e[a]*t:i[s]+t}var o=S();return o[s]=n||0,o}}function le(i,o,s){return function(t,e){var n;n="middle"===t?e[o]/2:t===s?e[o]:isFinite(t)?-1<t&&t<1?-e[o]*t:-t:ut(t)?e[o]*parseFloat(t)/100:0;var r=S();return r[i]=-(e[i]+n),r}}function ce(d,t){var p="joint-shape",g=t&&t.resetOffset;return function(t,e,n){var r=E(n),i=r.data(p);if(!i||i.value!==t){var o=d(t);i={value:t,shape:o,shapeBBox:o.bbox()},r.data(p,i)}var s=i.shape.clone(),a=i.shapeBBox.clone(),u=a.origin(),l=e.origin();a.x=l.x,a.y=l.y;var c=e.maxRectScaleToFit(a,l),h=0===a.width||0===e.width?1:c.sx,f=0===a.height||0===e.height?1:c.sy;return s.scale(h,f,u),g&&s.translate(-u.x,-u.y),s}}function he(t){var i=ce(function(t){return new C($.normalizePathData(t))},t);return function(t,e,n){var r=i(t,e,n);return{d:r.serialize()}}}function fe(t){var i=ce(T,t);return function(t,e,n){var r=i(t,e,n);return{points:r.serialize()}}}function de(i,o){var s=new S(1,0);return function(t){var e,n,r=this[i](t);return r?(n=o.rotate?r.vector().vectorAngle(s):0,e=r.start):(e=this.path.start,n=0),0===n?{transform:"translate("+e.x+","+e.y+")"}:{transform:"translate("+e.x+","+e.y+") rotate("+n+")"}}}function pe(t,e,n){return void 0!==n.text}function ge(){return this.model.isLink()}function ve(t){var e={},n=t.stroke;"string"==typeof n&&(e.stroke=n,e.fill=n);var r=t.strokeOpacity;return void 0===r&&(r=t["stroke-opacity"]),void 0===r&&(r=t.opacity),void 0!==r&&(e["stroke-opacity"]=r,e["fill-opacity"]=r),e}var me={xlinkHref:{set:"xlink:href"},xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},filter:{qualify:jt,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:jt,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},stroke:{qualify:jt,set:function(t){return"url(#"+this.paper.defineGradient(t)+")"}},sourceMarker:{qualify:jt,set:function(t,e,n,r){return t=kt(ve(r),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:jt,set:function(t,e,n,r){return t=kt(ve(r),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:jt,set:function(t,e,n,r){return t=kt(ve(r),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,n){return!n.textWrap||!jt(n.textWrap)},set:function(t,e,n,r){var i=E(n),o="joint-text",s=i.data(o),a=Yt(r,"lineHeight","annotations","textPath","x","textVerticalAnchor","eol"),u=a.fontSize=r["font-size"]||r.fontSize,l=JSON.stringify([t,a]);if(void 0===s||s!==l){u&&n.setAttribute("font-size",u);var c=a.textPath;if(ne(c)){var h=c.selector;if("string"==typeof h){var f=this.findBySelector(h)[0];f instanceof SVGPathElement&&(a.textPath=kt({"xlink:href":"#"+f.id},c))}}$(n).text(""+t,a),i.data(o,l)}}},textWrap:{qualify:jt,set:function(t,e,n,r){var i=t.width||0;ut(i)?e.width*=parseFloat(i)/100:i<=0?e.width+=i:e.width=i;var o,s=t.height||0;ut(s)?e.height*=parseFloat(s)/100:s<=0?e.height+=s:e.height=s;var a=t.text;void 0===a&&(a=r.text),o=void 0!==a?ct(""+a,e,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen}):"",me.text.set.call(this,o,e,n,r)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,n){var r=E(n),i="joint-title",o=r.data(i);if(void 0===o||o!==t){r.data(i,t);var s=n.firstChild;if(s&&"TITLE"===s.tagName.toUpperCase())s.textContent=t;else{var a=document.createElementNS(n.namespaceURI,"title");a.textContent=t,n.insertBefore(a,s)}}}},lineHeight:{qualify:pe},textVerticalAnchor:{qualify:pe},textPath:{qualify:pe},annotations:{qualify:pe},port:{set:function(t){return null===t||void 0===t.id?t:t.id}},style:{qualify:jt,set:function(t,e,n){E(n).css(t)}},html:{set:function(t,e,n){E(n).html(t+"")}},ref:{},refX:{position:ue("x","width","origin")},refY:{position:ue("y","height","origin")},refDx:{position:ue("x","width","corner")},refDy:{position:ue("y","height","corner")},refWidth:{set:ae("width","width")},refHeight:{set:ae("height","height")},refRx:{set:ae("rx","width")},refRy:{set:ae("ry","height")},refRInscribed:{set:function(){var r=ae("r","width"),i=ae("r","height");return function(t,e){var n=e.height>e.width?r:i;return n(t,e)}}()},refRCircumscribed:{set:function(t,e){var n=ut(t);t=parseFloat(t),n&&(t/=100);var r,i=Math.sqrt(e.height*e.height+e.width*e.width);return isFinite(t)&&(r=n||0<=t&&t<=1?t*i:Math.max(t+i,0)),{r:r}}},refCx:{set:ae("cx","width")},refCy:{set:ae("cy","height")},xAlignment:{offset:le("x","width","right")},yAlignment:{offset:le("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:he({resetOffset:!0})},refDKeepOffset:{set:he({resetOffset:!1})},refPointsResetOffset:{set:fe({resetOffset:!0})},refPointsKeepOffset:{set:fe({resetOffset:!1})},connection:{qualify:ge,set:function(){return{d:this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:ge,set:de("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient:{qualify:ge,set:de("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient:{qualify:ge,set:de("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient:{qualify:ge,set:de("getTangentAtRatio",{rotate:!1})}};me.refR=me.refRInscribed,me.refD=me.refDResetOffset,me.refPoints=me.refPointsResetOffset,me.atConnectionLength=me.atConnectionLengthKeepGradient,me.atConnectionRatio=me.atConnectionRatioKeepGradient,me.refX2=me.refX,me.refY2=me.refY,me.refWidth2=me.refWidth,me.refHeight2=me.refHeight,me["ref-x"]=me.refX,me["ref-y"]=me.refY,me["ref-dy"]=me.refDy,me["ref-dx"]=me.refDx,me["ref-width"]=me.refWidth,me["ref-height"]=me.refHeight,me["x-alignment"]=me.xAlignment,me["y-alignment"]=me.yAlignment;var ye=me,be=a.Model.extend({constructor:function(t,e){var n,r=t||{};this.cid=Qt("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(r=this.parse(r,e)||{}),(n=Wt(this,"defaults"))&&(r=te({},n,r)),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,n){throw new Error("Must define a translate() method.")},toJSON:function(){var e=this.constructor.prototype.defaults.attrs||{},t=this.attributes.attrs,o={};Zt(t,function(t,r){var i=e[r];Zt(t,function(t,n){ne(t)&&!Array.isArray(t)?Zt(t,function(t,e){i&&i[n]&&Rt(i[n][e],t)||(o[r]=o[r]||{},(o[r][n]||(o[r][n]={}))[e]=t)}):i&&Rt(i[n],t)||(o[r]=o[r]||{},o[r][n]=t)})});var n=Mt(Xt(this.attributes,"attrs"));return n.attrs=o,n},initialize:function(t){t&&t.id||this.set("id",this.generateId(),{silent:!0}),this._transitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},generateId:function(){return nt()},processPorts:function(){var t=this.ports,n={};Zt(this.get("attrs"),function(t,e){t&&t.port&&(void 0!==t.port.id?n[t.port.id]=t.port:n[t.port]={id:t.port})});var r={};if(Zt(t,function(t,e){n[e]||(r[e]=!0)}),this.graph&&!Ot(r)){var e=this.graph.getConnectedLinks(this,{inbound:!0});e.forEach(function(t){r[t.get("target").port]&&t.remove()});var i=this.graph.getConnectedLinks(this,{outbound:!0});i.forEach(function(t){r[t.get("source").port]&&t.remove()})}this.ports=n},remove:function(t){t=t||{};var e=this.graph;if(!e)return this.collection&&this.collection.remove(this,t),this;e.startBatch("remove");var n=this.getParentCell();n&&n.unembed(this);for(var r=this.getEmbeddedCells(),i=0,o=r.length;i<o;i++){var s=r[i];s&&s.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(n){var t=this.graph;if(t){n=n||{};var e,r=t.maxZIndex();n.deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):e=[this],r=r-e.length+1;var i=t.get("cells"),o=i.indexOf(this)!==i.length-e.length;(o=o||e.some(function(t,e){return t.get("z")!==r+e}))&&(this.startBatch("to-front"),r+=e.length,e.forEach(function(t,e){t.set("z",r+e,n)}),this.stopBatch("to-front"))}return this},toBack:function(n){var t=this.graph;if(t){n=n||{};var e,r=t.minZIndex();n.deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).unshift(this):e=[this];var i=t.get("cells"),o=0!==i.indexOf(this);(o=o||e.some(function(t,e){return t.get("z")!==r+e}))&&(this.startBatch("to-back"),r-=e.length,e.forEach(function(t,e){t.set("z",r+e,n)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return void 0===t?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){if(this===t||this.isEmbeddedIn(t))throw new Error("Recursive embedding not allowed.");this.startBatch("embed");var n=kt([],this.get("embeds"));return n[t.isLink()?"unshift":"push"](t.id),t.parent(this.id,e),this.set("embeds",Nt(n),e),this.stopBatch("embed"),this},unembed:function(t,e){return this.startBatch("unembed"),t.unset("parent",e),this.set("embeds",qt(this.get("embeds"),t.id),e),this.stopBatch("unembed"),this},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(e){if(e=e||{},this.graph){var n;if(e.deep)if(e.breadthFirst){n=[];for(var t=this.getEmbeddedCells();0<t.length;){var r=t.shift();n.push(r),t.push.apply(t,r.getEmbeddedCells())}}else(n=this.getEmbeddedCells()).forEach(function(t){n.push.apply(n,t.getEmbeddedCells(e))});else n=Ft(this.get("embeds")).map(this.graph.getCell,this.graph);return n}return[]},isEmbeddedIn:function(t,e){var n=ie(t)?t:t.id,r=this.parent();if(e=Pt({deep:!0},e),this.graph&&e.deep){for(;r;){if(r===n)return!0;r=this.graph.getCell(r).parent()}return!1}return r===n},isEmbedded:function(){return!!this.parent()},clone:function(t){if((t=t||{}).deep)return Ft(se([this].concat(this.getEmbeddedCells({deep:!0}))));var e=a.Model.prototype.clone.apply(this,arguments);return e.set("id",this.generateId()),e.unset("embeds"),e.unset("parent"),e},prop:function(t,e,n){var r=ie(t);if(r||Array.isArray(t)){if(1<arguments.length){var i,o,s=(o=r?(i=t).split("/"):(i=t.join("/"),t.slice()))[0],a=o.length;if((n=n||{}).propertyPath=i,n.propertyValue=e,n.propertyPathArray=o,1===a)return this.set(s,e,n);for(var u={},l=u,c=s,h=1;h<a;h++){var f=o[h],d=Number.isFinite(r?Number(f):f);l=l[c]=d?[]:{},c=f}u=Q(u,o,e,"/");var p=te({},this.attributes);n.rewrite&&tt(p,i,"/");var g=te(p,u);return this.set(s,g[s],n)}return K(this.attributes,t,"/")}return this.set(te({},this.attributes,t),e)},removeProp:function(t,e){e=e||{};var n=Array.isArray(t)?t:t.split("/"),r=n[0];if("attrs"===r&&(e.dirty=!0),1===n.length)return this.unset(t,e);var i=n.slice(1),o=Mt(this.get(r));return tt(o,i,"/"),this.set(r,o,e)},attr:function(t,e,n){var r=Array.from(arguments);return 0===r.length?this.get("attrs"):(Array.isArray(t)?r[0]=["attrs"].concat(t):ie(t)?r[0]="attrs/"+t:r[0]={attrs:t},this.prop.apply(this,r))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(i,e,o,n){n=n||"/";var t={duration:100,delay:10,timingFunction:vt.linear,valueFunction:mt.number};o=kt(t,o);var s,a=0,u=function(t){var e,n,r;(n=(t-=a=a||t)/o.duration)<1?this._transitionIds[i]=e=st(u):(n=1,delete this._transitionIds[i]),r=s(o.timingFunction(n)),o.transitionId=e,this.prop(i,r,o),e||this.trigger("transition:end",this,i)}.bind(this),r=function(t){this.stopTransitions(i),s=o.valueFunction(K(this.attributes,i,n),e),this._transitionIds[i]=st(t),this.trigger("transition:start",this,i)}.bind(this);return setTimeout(r,o.delay,u)},getTransitions:function(){return Object.keys(this._transitionIds)},stopTransitions:function(t,e){e=e||"/";var n=t&&t.split(e);return Object.keys(this._transitionIds).filter(n&&function(t){return Rt(n,t.split(e).slice(0,n.length))}).forEach(function(t){at(this._transitionIds[t]),delete this._transitionIds[t],this.trigger("transition:end",this,t)},this),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,kt({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,kt({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var n in t)t.hasOwnProperty(n)&&this.hasChanged(n)&&(e|=t[n]);return e},angle:function(){return 0},position:function(){return new S(0,0)},getPointFromConnectedLink:function(){return new S},getBBox:function(){return new G(0,0,0,0)}},{getAttributeDefinition:function(t){var e=this.attributes,n=ye;return e&&e[t]||n[t]},define:function(t,e,n,r){n=kt({defaults:Et({type:t},e,this.prototype.defaults)},n);var i=this.extend(n,r);return"undefined"!=typeof joint&&Gt(joint,"shapes")&&Q(joint.shapes,t,i,"."),i}}),we=function(e,t,n){if(ie(n)){if(!xe[n])throw new Error('Unknown wrapper: "'+n+'"');n=xe[n]}if(!Dt(n))throw new Error("Wrapper must be a function.");Ft(t).forEach(function(t){e[t]=n(e[t])})},xe={cells:function(i){return function(){var t=Array.from(arguments),e=t.length,n=0<e&&t[0]||[],r=1<e&&t[e-1]||{};return Array.isArray(n)||(r instanceof be?n=t:n instanceof be&&(1<t.length&&t.pop(),n=t)),r instanceof be&&(r={}),i.call(this,n,r)}}},Ae={wrapWith:we,wrappers:xe,addClassNamePrefix:X,removeClassNamePrefix:Y,parseDOMJSON:J,hashCode:Z,getByPath:K,setByPath:Q,unsetByPath:tt,flattenObject:et,uuid:nt,guid:rt,toKebabCase:it,normalizeEvent:ot,nextFrame:st,cancelFrame:at,shapePerimeterConnectionPoint:function(t,e,n,r){var i,o;if(!n){var s=e.$(".scalable")[0];var a=e.$(".rotatable")[0];if(s&&s.firstChild){n=s.firstChild}else if(a&&a.firstChild){n=a.firstChild}}if(n){o=$(n).findIntersection(r,t.paper.cells);if(!o){i=$(n).getBBox({target:t.paper.cells})}}else{i=e.model.getBBox();o=i.intersectionWithLineFromCenterToPoint(r)}return o||i.center()},isPercentage:ut,parseCssNumeric:lt,breakText:ct,sanitizeHTML:ht,downloadBlob:ft,downloadDataUri:function(t,e){var n=dt(t);ft(n,e)},dataUriToBlob:dt,imageToDataUri:function(u,t){if(!u||u.substr(0,"data:".length)==="data:"){return setTimeout(function(){t(null,u)},0)}var e=function(t,n){if(t.status===200){var e=new FileReader;e.onload=function(t){var e=t.target.result;n(null,e)};e.onerror=function(){n(new Error("Failed to load image "+u))};e.readAsDataURL(t.response)}else{n(new Error("Failed to load image "+u))}},n=function(t,e){var n=function(t){for(var e=32768,n=[],r=0;r<t.length;r+=e){n.push(String.fromCharCode.apply(null,t.subarray(r,r+e)))}return n.join("")};if(t.status===200){var r=new Uint8Array(t.response);var i=u.split(".").pop()||"png";var o={svg:"svg+xml"};var s="data:image/"+(o[i]||i)+";base64,";var a=s+btoa(n(r));e(null,a)}else{e(new Error("Failed to load image "+u))}},r=new XMLHttpRequest;r.open("GET",u,true),r.addEventListener("error",function(){t(new Error("Failed to load image "+u))}),r.responseType=window.FileReader?"blob":"arraybuffer",r.addEventListener("load",function(){if(window.FileReader){e(r,t)}else{n(r,t)}}),r.send()},getElementBBox:function(t){var e=E(t);if(e.length===0){throw new Error("Element not found")}var n=e[0],r=n.ownerDocument,i=n.getBoundingClientRect(),o=0,s=0;if(n.ownerSVGElement){var a=$(n);var u=a.getBBox({target:a.svg()});o=i.width-u.width;s=i.height-u.height}return{x:i.left+window.pageXOffset-r.documentElement.offsetLeft+o/2,y:i.top+window.pageYOffset-r.documentElement.offsetTop+s/2,width:i.width-o,height:i.height-s}},sortElements:pt,setAttributesBySelector:function(t,e){var r=E(t);Zt(e,function(t,e){var n=r.find(e).addBack().filter(e);if(Gt(t,"class")){n.addClass(t["class"]);t=Xt(t,"class")}n.attr(t)})},normalizeSides:gt,timing:vt,interpolate:mt,filter:yt,format:bt,template:wt,toggleFullScreen:function(t){var e=window.top.document;function n(t,e){var n=["webkit","moz","ms","o",""];for(var r=0;r<n.length;r++){var i=n[r];var o=i?i+e:e.substr(0,1).toLowerCase()+e.substr(1);if(t[o]!==undefined){return Dt(t[o])?t[o]():t[o]}}}if(t=t||e.body,n(e,"FullscreenElement")||n(e,"FullScreenElement")){n(e,"ExitFullscreen")||n(e,"CancelFullScreen")}else{n(t,"RequestFullscreen")||n(t,"RequestFullScreen")}},mixin:xt,supplement:At,deepMixin:_t,deepSupplement:St,assign:kt,defaults:Pt,defaultsDeep:Et,invoke:Ct,sortedIndex:Tt,uniq:Nt,clone:Lt,cloneDeep:Mt,isEmpty:Ot,isEqual:Rt,isFunction:Dt,isPlainObject:jt,toArray:Ft,debounce:Bt,groupBy:Vt,sortBy:It,flattenDeep:zt,without:qt,difference:Ht,intersection:Ut,union:$t,has:Gt,result:Wt,omit:Xt,pick:Yt,bindAll:Jt,forIn:Zt,camelCase:Kt,uniqueId:Qt,merge:te,isBoolean:ee,isObject:ne,isNumber:re,isString:ie,noop:oe,cloneCells:se};function _e(t,e,n){var r=t.toJSON();return r.angle=e||0,Pt({},n,r)}function Se(t,e,n){return t.map(function(t,e,n){var r=this.pointAt((e+.5)/n.length);return(t.dx||t.dy)&&r.offset(t.dx||0,t.dy||0),_e(r.round(),0,t)},k(e,n))}function ke(t,e,s,a){var u=e.center(),l=e.width/e.height,c=e.topMiddle(),h=x.fromRect(e);return t.map(function(t,e,n){var r=s+a(e,n.length),i=c.clone().rotate(u,-r).scale(l,1,u),o=t.compensateRotation?-h.tangentTheta(i):0;return(t.dx||t.dy)&&i.offset(t.dx||0,t.dy||0),t.dr&&i.move(u,t.dr),_e(i.round(),o,t)})}function Pe(t,e){var n=e.x;ie(n)&&(n=parseFloat(n)/100*t.width);var r=e.y;return ie(r)&&(r=parseFloat(r)/100*t.height),P(n||0,r||0)}var Ee={absolute:function(t,e,n){return t.map(Pe.bind(null,e))},fn:function(t,e,n){return n.fn(t,e,n)},line:function(t,e,n){var r=Pe(e,n.start||e.origin()),i=Pe(e,n.end||e.corner());return Se(t,r,i)},left:function(t,e,n){return Se(t,e.origin(),e.bottomLeft())},right:function(t,e,n){return Se(t,e.topRight(),e.corner())},top:function(t,e,n){return Se(t,e.origin(),e.topRight())},bottom:function(t,e,n){return Se(t,e.bottomLeft(),e.corner())},ellipseSpread:function(t,e,n){var r=n.startAngle||0,i=n.step||360/t.length;return ke(t,e,r,function(t){return t*i})},ellipse:function(t,e,n){var r=n.startAngle||0,i=n.step||20;return ke(t,e,r,function(t,e){return(t+.5-e/2)*i})}};function Ce(t,e){return Et({},t,e,{x:0,y:0,angle:0,attrs:{".":{y:"0","text-anchor":"start"}}})}function Te(t,e,n,r){r=Pt({},r,{offset:15});var i,o,s,a,u=e.center().theta(t),l=Ne(e),c=r.offset,h=0;a=u<l[1]||u>l[2]?(s=".3em",i=c,o=0,"start"):u<l[0]?(s="0",i=0,o=-c,n?(h=-90,"start"):"middle"):u<l[3]?(s=".3em",i=-c,o=0,"end"):(s=".6em",i=0,o=c,n?(h=90,"start"):"middle");var f=Math.round;return Ce({x:f(i),y:f(o),angle:h,attrs:{".":{y:s,"text-anchor":a}}})}function Ne(t){var e=t.center(),n=e.theta(t.origin()),r=e.theta(t.bottomLeft()),i=e.theta(t.corner()),o=e.theta(t.topRight());return[n,o,i,r]}function Le(t,e,n,r){var i,o,s,a,u=e.center().theta(t),l=(r=Pt({},r,{offset:15})).offset,c=0,h=Ne(e);a=u<h[1]||u>h[2]?(s=".3em",i=-l,o=0,"end"):u<h[0]?(s=".6em",i=0,o=l,n?(c=90,"start"):"middle"):u<h[3]?(s=".3em",i=l,o=0,"start"):(s="0em",i=0,o=-l,n?(c=-90,"start"):"middle");var f=Math.round;return Ce({x:f(i),y:f(o),angle:c,attrs:{".":{y:s,"text-anchor":a}}})}function Me(t,e,n){n=Pt({},n,{offset:20});var r,i=P(0,0),o=-t.theta(i),s=o,a=t.clone().move(i,n.offset).difference(t).round(),u=".3em";(90+o)%180==0?(r=e?"end":"middle",e||-270!=o||(u="0em")):-270<o&&o<-90?(r="start",s=o-180):r="end";var l=Math.round;return Ce({x:l(a.x),y:l(a.y),angle:e?s:0,attrs:{".":{y:u,"text-anchor":r}}})}var Oe={manual:function(t,e,n){return Ce(n,e)},left:function(t,e,n){return Ce(n,{x:-15,attrs:{".":{y:".3em","text-anchor":"end"}}})},right:function(t,e,n){return Ce(n,{x:15,attrs:{".":{y:".3em","text-anchor":"start"}}})},top:function(t,e,n){return Ce(n,{y:-15,attrs:{".":{"text-anchor":"middle"}}})},bottom:function(t,e,n){return Ce(n,{y:15,attrs:{".":{y:".6em","text-anchor":"middle"}}})},outsideOriented:function(t,e,n){return Te(t,e,!0,n)},outside:function(t,e,n){return Te(t,e,!1,n)},insideOriented:function(t,e,n){return Le(t,e,!0,n)},inside:function(t,e,n){return Le(t,e,!1,n)},radial:function(t,e,n){return Me(t.difference(e.center()),!1,n)},radialOriented:function(t,e,n){return Me(t.difference(e.center()),!0,n)}},Re=function(t){var e=Mt(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=Ee,this.portLabelLayoutNamespace=Oe,this._init(e)};Re.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(e){return this.ports.filter(function(t){return t.group===e})},getGroupPortsMetrics:function(t,i){var e=this.getGroup(t),n=this.getPortsByGroup(t),r=e.position||{},o=r.name,s=this.portLayoutNamespace;s[o]||(o="left");var a=r.args||{},u=n.map(function(t){return t&&t.position&&t.position.args}),l=s[o](u,i,a),c={ports:n,result:[]};return Ft(l).reduce(function(t,e,n){var r=t.ports[n];return t.result.push({portId:r.id,portTransformation:e,labelTransformation:this._getPortLabelLayout(r,S(e),i),portAttrs:r.attrs,portSize:r.size,labelSize:r.label.size}),t}.bind(this),c),c.result},_getPortLabelLayout:function(t,e,n){var r=this.portLabelLayoutNamespace,i=t.label.position.name||"left";return r[i]?r[i](e,n,t.label.position.args):null},_init:function(t){if(ne(t.groups))for(var e=Object.keys(t.groups),n=0,r=e.length;n<r;n++){var i=e[n];this.groups[i]=this._evaluateGroup(t.groups[i])}for(var o=Ft(t.items),s=0,a=o.length;s<a;s++)this.ports.push(this._evaluatePort(o[s]))},_evaluateGroup:function(t){return te(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=kt({},t),n=this.getGroup(t.group);return e.markup=e.markup||n.markup,e.attrs=te({},n.attrs,e.attrs),e.position=this._createPositionNode(n,e),e.label=te({},n.label,this._getLabel(e)),e.z=this._getZIndex(n,e),e.size=kt({},n.size,e.size),e},_getZIndex:function(t,e){return re(e.z)?e.z:re(t.z)||"auto"===t.z?t.z:"auto"},_createPositionNode:function(t,e){return te({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var n,r={};Dt(t)?(n="fn",r.fn=t):ie(t)?n=t:void 0===t?n=e?"left":null:Array.isArray(t)?(n="absolute",r.x=t[0],r.y=t[1]):ne(t)&&(n=t.name,kt(r,t.args));var i={args:r};return n&&(i.name=n),i},_getLabel:function(t,e){var n=t.label||{},r=n;return r.position=this._getPosition(n.position,e),r}};var De={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};Ft(t.items).forEach(function(t){e[t.id]=!0});var n=this.previous("ports")||{},r={};Ft(n.items).forEach(function(t){e[t.id]||(r[t.id]=!0)});var i=this.graph;if(i&&!Ot(r)){var o=i.getConnectedLinks(this,{inbound:!0});o.forEach(function(t){r[t.get("target").port]&&t.remove()});var s=i.getConnectedLinks(this,{outbound:!0});s.forEach(function(t){r[t.get("source").port]&&t.remove()})}},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&0<t.length},hasPort:function(t){return-1!==this.getPortIndex(t)},getPorts:function(){return Mt(this.prop("ports/items"))||[]},getPort:function(e){return Mt(Ft(this.prop("ports/items")).find(function(t){return t.id&&t.id===e}))},getPortsPositions:function(t){var e=this._portSettingsData.getGroupPortsMetrics(t,G(this.size()));return e.reduce(function(t,e){var n=e.portTransformation;return t[e.portId]={x:n.x,y:n.y,angle:n.angle},t},{})},getPortIndex:function(t){var e=ne(t)?t.id:t;return this._isValidPortId(e)?Ft(this.prop("ports/items")).findIndex(function(t){return t.id===e}):-1},addPort:function(t,e){if(!ne(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var n=kt([],this.prop("ports/items"));return n.push(t),this.prop("ports/items",n,e),this},portProp:function(t,e,n,r){var i=this.getPortIndex(t);if(-1===i)throw new Error("Element: unable to find port with id "+t);var o=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?o[0]=["ports","items",i].concat(e):ie(e)?o[0]=["ports/items/",i,"/",e].join(""):(o=["ports/items/"+i],jt(e)&&(o.push(e),o.push(n))),this.prop.apply(this,o)},_validatePorts:function(){var t=this.get("ports")||{},e=[],n=Ft((t=t||{}).items);return n.forEach(function(t){"object"!=typeof t&&e.push("Element: invalid port ",t),this._isValidPortId(t.id)||(t.id=this.generatePortId())},this),Nt(n,"id").length!==n.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return null!=t&&!ne(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",kt([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){var n=e||{},r=kt([],this.prop("ports/items")),i=this.getPortIndex(t);return-1!==i&&(r.splice(i,1),n.rewrite=!0,this.prop("ports/items",r,n)),this},removePorts:function(t,e){var n;if(Array.isArray(t)){if(n=e||{},t.length){n.rewrite=!0;var r=kt([],this.prop("ports/items")),i=r.filter(function(n){return!t.some(function(t){var e=ne(t)?t.id:t;return n.id===e})});this.prop("ports/items",i,n)}}else(n=t||{}).rewrite=!0,this.prop("ports/items",[],n);return this},_createPortData:function(){var t,e=this._validatePorts();if(0<e.length)throw this.set("ports",this.previous("ports")),new Error(e.join(" "));this._portSettingsData&&(t=this._portSettingsData.getPorts()),this._portSettingsData=new Re(this.get("ports"));var n=this._portSettingsData.getPorts();if(t){var r=n.filter(function(e){if(!t.find(function(t){return t.id===e.id}))return e}),i=t.filter(function(e){if(!n.find(function(t){return t.id===e.id}))return e});0<i.length&&this.trigger("ports:remove",this,i),0<r.length&&this.trigger("ports:add",this,r)}}},je={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var n=[],r=this._getContainerElement(),t=0,e=r.node.childNodes.length;t<e;t++)n.push(r.node.childNodes[t]);var i=Vt(this.model._portSettingsData.getPorts(),"z");Ft(i.auto).forEach(function(t){var e=this._getPortElement(t);r.append(e),n.push(e)},this);for(var o=Object.keys(i),s=0;s<o.length;s++){var a=o[s];if("auto"!==a){var u=parseInt(a,10);this._appendPorts(i[a],u,n)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,n){var r=this._getContainerElement(),i=Ft(t).map(this._getPortElement,this);n[e]||e<0?$(n[Math.max(e,0)]).before(i):r.append(i)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNode:function(t,e){var n=this._portElementsCache[t];if(!n)return null;var r=n.portContentElement.node,i=n.portContentSelectors;return this.findBySelector(e,r,i)[0]},_updatePorts:function(){this._updatePortGroup(void 0);var t=Object.keys(this.model._portSettingsData.groups);t.forEach(this._updatePortGroup,this)},_removePorts:function(){Ct(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){var e,n,r,i=$(this.portContainerMarkup).addClass("joint-port"),o=this._getPortMarkup(t);if(Array.isArray(o)){var s=this.parseDOMJSON(o,i.node),a=s.fragment;e=1<a.childNodes.length?$("g").append(a):$(a.firstChild),r=s.selectors}else e=$(o),Array.isArray(e)&&(e=$("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group});var u,l,c=this._getPortLabelMarkup(t.label);if(Array.isArray(c)){var h=this.parseDOMJSON(c,i.node),f=h.fragment;n=1<f.childNodes.length?$("g").append(f):$(f.firstChild),u=h.selectors}else n=$(c),Array.isArray(n)&&(n=$("g").append(n));if(!n)throw new Error("ElementView: Invalid port label markup.");if(r&&u){for(var d in u)if(r[d]&&d!==this.selector)throw new Error("ElementView: selectors within port must be unique.");l=kt({},r,u)}else l=r||u;return i.append([e.addClass("joint-port-body"),n.addClass("joint-port-label")]),this._portElementsCache[t.id]={portElement:i,portLabelElement:n,portSelectors:l,portLabelSelectors:u,portContentElement:e,portContentSelectors:r},i},_updatePortGroup:function(t){for(var e=G(this.model.size()),n=this.model._portSettingsData.getGroupPortsMetrics(t,e),r=0,i=n.length;r<i;r++){var o=n[r],s=o.portId,a=this._portElementsCache[s]||{},u=o.portTransformation;this.applyPortTransform(a.portElement,u),this.updateDOMSubtreeAttributes(a.portElement.node,o.portAttrs,{rootBBox:new G(o.portSize),selectors:a.portSelectors});var l=o.labelTransformation;l&&(this.applyPortTransform(a.portLabelElement,l,-u.angle||0),this.updateDOMSubtreeAttributes(a.portLabelElement.node,l.attrs,{rootBBox:new G(o.labelSize),selectors:a.portLabelSelectors}))}},applyPortTransform:function(t,e,n){var r=$.createSVGMatrix().rotate(n||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(r,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},Fe=be.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),be.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,n){var r=re(e);if((n=(r?n:t)||{}).parentRelative){if(!this.graph)throw new Error("Element must be part of a graph.");var i=this.getParentCell(),o=i&&!i.isLink()?i.get("position"):{x:0,y:0}}if(r){if(n.parentRelative&&(t+=o.x,e+=o.y),n.deep){var s=this.get("position");this.translate(t-s.x,e-s.y,n)}else this.set("position",{x:t,y:e},n);return this}var a=S(this.get("position"));return n.parentRelative?a.difference(o):a},translate:function(t,e,n){if(e=e||0,0===(t=t||0)&&0===e)return this;(n=n||{}).translateBy=n.translateBy||this.id;var r=this.get("position")||{x:0,y:0};if(n.restrictedArea&&n.translateBy===this.id){var i=this.getBBox({deep:!0}),o=n.restrictedArea,s=r.x-i.x,a=r.y-i.y,u=Math.max(o.x+s,Math.min(o.x+o.width+s-i.width,r.x+t)),l=Math.max(o.y+a,Math.min(o.y+o.height+a-i.height,r.y+e));t=u-r.x,e=l-r.y}var c={x:r.x+t,y:r.y+e};return n.tx=t,n.ty=e,n.transition?(ne(n.transition)||(n.transition={}),this.transition("position",c,kt({},n.transition,{valueFunction:mt.object})),Ct(this.getEmbeddedCells(),"translate",t,e,n)):(this.startBatch("translate",n),this.set("position",c,n),Ct(this.getEmbeddedCells(),"translate",t,e,n),this.stopBatch("translate",n)),this},size:function(t,e,n){var r=this.get("size");return void 0===t?{width:r.width,height:r.height}:(ne(t)&&(n=e,e=re(t.height)?t.height:r.height,t=re(t.width)?t.width:r.width),this.resize(t,e,n))},resize:function(t,e,n){if(n=n||{},this.startBatch("resize",n),n.direction){var r=this.get("size");switch(n.direction){case"left":case"right":e=r.height;break;case"top":case"bottom":t=r.width}var i=w(this.get("angle")||0),o={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[n.direction];n.absolute&&(o+=Math.floor((i+45)/90),o%=4);var s=this.getBBox(),a=s[["bottomLeft","corner","topRight","origin"][o]](),u=S(a).rotate(s.center(),-i),l=Math.sqrt(t*t+e*e)/2,c=o*Math.PI/2;c+=Math.atan(o%2==0?e/t:t/e),c-=_(i);var h=S.fromPolar(l,c,u),f=S(h).offset(t/-2,e/-2);this.set("size",{width:t,height:e},n),this.position(f.x,f.y,n)}else this.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this},scale:function(t,e,n,r){var i=this.getBBox().scale(t,e,n);return this.startBatch("scale",r),this.position(i.x,i.y,r),this.resize(i.width,i.height,r),this.stopBatch("scale"),this},fitEmbeds:function(t){if(t=t||{},!this.graph)throw new Error("Element must be part of a graph.");var e=this.getEmbeddedCells();if(0<e.length){this.startBatch("fit-embeds",t),t.deep&&Ct(e,"fitEmbeds",t);var n=this.graph.getCellsBBox(e),r=gt(t.padding);n.moveAndExpand({x:-r.left,y:-r.top,width:r.right+r.left,height:r.bottom+r.top}),this.set({position:{x:n.x,y:n.y},size:{width:n.width,height:n.height}},t),this.stopBatch("fit-embeds")}return this},rotate:function(t,e,n,r){if(n){var i=this.getBBox().center(),o=this.get("size"),s=this.get("position");i.rotate(n,this.get("angle")-t);var a=i.x-o.width/2-s.x,u=i.y-o.height/2-s.y;this.startBatch("rotate",{angle:t,absolute:e,origin:n}),this.position(s.x+a,s.y+u,r),this.rotate(t,e,null,r),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,r);return this},angle:function(){return w(this.get("angle")||0)},getBBox:function(t){if((t=t||{}).deep&&this.graph){var e=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return e.push(this),this.graph.getCellsBBox(e)}var n=this.get("position"),r=this.get("size");return new G(n.x,n.y,r.width,r.height)},getPointFromConnectedLink:function(t,e){var n=this.getBBox(),r=n.center(),i=t.get(e);if(!i)return r;var o=i.port;if(!o)return r;var s=this.portProp(o,["group"]),a=this.getPortsPositions(s),u=new S(a[o]).offset(n.origin()),l=this.angle();return l&&u.rotate(r,-l),u}});kt(Fe.prototype,De);var Be={},Ve=a.View.extend({options:{},theme:null,themeClassNamePrefix:X("theme-"),requireSetThemeOverride:!1,defaultTheme:W.defaultTheme,children:null,childNodes:null,UPDATE_PRIORITY:2,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=kt({},this.options,t),a.View.call(this,t)},initialize:function(){(Be[this.cid]=this).setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},renderChildren:function(t){if(t=t||Wt(this,"children")){var e=this.svgElement,n=$.namespace[e?"svg":"xhtml"],r=J(t,n);(e?this.vel:this.$el).empty().append(r.fragment),this.childNodes=r.selectors}return this},findAttribute:function(t,e){for(var n=e;n&&1===n.nodeType;){var r=n.getAttribute(t);if(r)return r;if(n===this.el)return null;n=n.parentNode}return null},_ensureElement:function(){if(this.el)this.setElement(Wt(this,"el"));else{var t=Wt(this,"tagName"),e=kt({},Wt(this,"attributes")),n=kt({},Wt(this,"style"));this.id&&(e.id=Wt(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(n)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS($.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof a.$?t:a.$(t),this.el=this.$el[0],this.svgElement&&(this.vel=$(this.el))},_ensureElClassName:function(){var t=Wt(this,"className");if(t){var e=X(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override||(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t),this},addThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),Be[this.cid]=null,a.View.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,n){if(!e)return this;n=n||{};var r=this.getEventNamespace();for(var i in e){var o=e[i];"function"!=typeof o&&(o=this[o]),o&&E(t).on(i+r,n,o.bind(this))}return this},undelegateElementEvents:function(t){return E(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t=t||Wt(this,"documentEvents"),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var n=t.data,r="__"+this.cid+"__";return void 0===e?n&&n[r]||{}:((n=n||(t.data={}))[r]||(n[r]={}),kt(n[r],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),e=t[0]&&kt({},t[0])||{},n=t[1]&&kt({},t[1])||{},r=e.render||this.prototype&&this.prototype.render||null;return e.render=function(){return"function"==typeof r&&r.apply(this,arguments),this.render.__render__===r&&this.onRender(),this},e.render.__render__=r,a.View.extend.call(this,e,n)}}),Ie={views:Be,View:Ve},ze=Ve.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var r=["cell"],t=this.model.get("type");return t&&t.toLowerCase().split(".").forEach(function(t,e,n){r.push("type-"+n.slice(0,e+1).join("-"))}),r.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t,e,n,r={},i={},o=0,s=this.presentationAttributes;for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];for(Array.isArray(u)||(u=[u]),t=0,e=u.length;t<e;t++){n=u[t];var l=r[n];l=l||(r[n]=1<<o++),i[a]|=l}}var c=this.initFlag;for(Array.isArray(c)||(c=[c]),t=0,e=c.length;t<e;t++)n=c[t],r[n]||(r[n]=1<<o++);if(25<o)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=r,this._presentationAttributes=i},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var n=0;if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)n|=e[t[r]];else n|=e[t];return n},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||rt(this),Ve.call(this,t)},initialize:function(){this.setFlags(),Ve.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.$el.data("view",this),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var n=t.getChangeFlag(this._presentationAttributes);if(!e.updateHandled&&n){e.dirty&&this.hasFlag(n,"UPDATE")&&(n|=this.getFlag("RENDER")),e.tool&&(e.async=!1);var r=this.paper;r&&r.requestViewUpdate(this,n,this.UPDATE_PRIORITY,e)}},parseDOMJSON:function(t,e){var n=J(t),r=n.selectors,i=n.groupSelectors;for(var o in i){if(r[o])throw new Error("dia.CellView: ambiguous group selector");r[o]=i[o]}if(e){var s=this.selector;if(r[s])throw new Error("dia.CellView: ambiguous root selector.");r[s]=e}return{fragment:n.fragment,selectors:r}},can:function(t){var e=Dt(this.options.interactive)?this.options.interactive(this):this.options.interactive;return ne(e)&&!1!==e[t]||ee(e)&&!1!==e},findBySelector:function(t,e,n){if(e=e||this.el,n=n||this.selectors,!t||"."===t)return[e];if(n){var r=n[t];if(r)return Array.isArray(r)?r:[r]}return W.useCSSSelectors?E(e).find(t).toArray():[]},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var n=this.model;e=n.getBBox().bbox(n.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),r=this.getRootTranslateMatrix(),i=this.getRootRotateMatrix();return $.transformRect(e,r.multiply(i).multiply(n))},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),r=this.getRootTranslateMatrix();return $.transformRect(e,r.multiply(n))},getRootTranslateMatrix:function(){var t=this.model,e=t.position(),n=$.createSVGMatrix().translate(e.x,e.y);return n},getRootRotateMatrix:function(){var t=$.createSVGMatrix(),e=this.model,n=e.angle();if(n){var r=e.getBBox(),i=r.width/2,o=r.height/2;t=t.translate(i,o).rotate(n).translate(-i,-o)}return t},highlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!==this.el,this.notify("cell:highlight",t,e),this},unhighlight:function(t,e){return t=t&&this.$(t)[0]||this.el,(e=e||{}).partial=t!=this.el,this.notify("cell:unhighlight",t,e),this},findMagnet:function(t){var e=this.$(t),n=this.$el;0===e.length&&(e=n);do{var r=e.attr("magnet");if((r||e.is(n))&&"false"!==r)return e[0];e=e.parent()}while(0<e.length)},getSelector:function(t,e){var n;if(t===this.el)return"string"==typeof e&&(n="> "+e),n;if(t){var r=$(t).index()+1;n=t.tagName+":nth-child("+r+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)}return n},getLinkEnd:function(t,e,n,r,i){var o=this.model,s=o.id,a=this.findAttribute("port",t),u=t.getAttribute("joint-selector"),l={id:s};null!=u&&(l.magnet=u),null!=a?(l.port=a,o.hasPort(a)||u||(l.selector=this.getSelector(t))):null==u&&this.el!==t&&(l.selector=this.getSelector(t));var c=this.paper,h=c.options.connectionStrategy;if("function"==typeof h){var f=h.call(c,l,this,t,new S(e,n),r,i,c);f&&(l=f)}return l},getMagnetFromLinkEnd:function(t){var e=this.el,n=t.port,r=t.magnet,i=this.model;return null!=n&&i.isElement()&&i.hasPort(n)?this.findPortNode(n,r)||e:((r=r||t.selector)||null==n||(r='[port="'+n+'"]'),this.findBySelector(r,e,this.selectors)[0])},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){Ot(e)||(t instanceof SVGElement?$(t).attr(e):E(t).attr(e))},processNodeAttributes:function(t,e){var n,r,i,o,s,a,u,l,c,h=[];for(n in e)e.hasOwnProperty(n)&&(r=e[n],!(i=this.getAttributeDefinition(n))||Dt(i.qualify)&&!i.qualify.call(this,r,t,e)?(a=a||{})[it(n)]=r:(ie(i.set)&&((a=a||{})[i.set]=r),null!==r&&h.push(n,i)));for(o=0,s=h.length;o<s;o+=2)n=h[o],i=h[o+1],r=e[n],Dt(i.set)&&((u=u||{})[n]=r),Dt(i.position)&&((l=l||{})[n]=r),Dt(i.offset)&&((c=c||{})[n]=r);return{raw:e,normal:a,set:u,position:l,offset:c}},updateRelativeAttributes:function(t,e,n,r){var i,o,s;r=r||{};var a=e.raw||{},u=e.normal||{},l=e.set,c=e.position,h=e.offset;for(i in l){o=l[i];var f=(s=this.getAttributeDefinition(i)).set.call(this,o,n.clone(),t,a);ne(f)?kt(u,f):void 0!==f&&(u[i]=f)}if(t instanceof HTMLElement)this.setNodeAttributes(t,u);else{var d,p,g,v=u.transform,m=$.transformStringToMatrix(v),y=S(m.e,m.f);if(v&&(u=Xt(u,"transform"),m.e=m.f=0),c||h){var b=this.getNodeScale(t,r.scalableNode);d=b.sx,p=b.sy}var w=!1;for(i in c)o=c[i],s=this.getAttributeDefinition(i),(g=s.position.call(this,o,n.clone(),t,a))&&(y.offset(S(g).scale(d,p)),w=w||!0);this.setNodeAttributes(t,u);var x=!1;if(h){var A=this.getNodeBoundingRect(t);if(0<A.width&&0<A.height){var _=$.transformRect(A,m).scale(1/d,1/p);for(i in h)o=h[i],s=this.getAttributeDefinition(i),(g=s.offset.call(this,o,_,t,a))&&(y.offset(S(g).scale(d,p)),x=x||!0)}}(void 0!==v||w||x)&&(y.round(1),m.e=y.x,m.f=y.y,t.setAttribute("transform",$.matrixToTransformString(m)))}},getNodeScale:function(t,e){var n,r;if(e&&e.contains(t)){var i=e.scale();n=1/i.sx,r=1/i.sy}else r=n=1;return{sx:n,sy:r}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var n=$.ensureId(t),r=e[n];return r=r||(e[n]={})},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return void 0===e.boundingRect&&(e.boundingRect=$(t).getBBox()),new G(e.boundingRect)},getNodeMatrix:function(t){var e=this.nodeCache(t);if(void 0===e.magnetMatrix){var n=this.rotatableNode||this.el;e.magnetMatrix=$(t).getTransformToElement(n)}return $.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return void 0===e.geometryShape&&(e.geometryShape=$(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,n,r){var i,o,s,a,u={},l=[];for(var c in t)if(t.hasOwnProperty(c)){var h=n[c]=this.findBySelector(c,e,r);for(i=0,o=h.length;i<o;i++){var f=h[i];a=$.ensureId(f),s=t[c];var d=r&&r[c]===f,p=u[a];if(p){p.array||(l.push(a),p.array=!0,p.attributes=[p.attributes],p.selectedLength=[p.selectedLength]);var g=p.attributes,v=p.selectedLength;if(d)g.unshift(s),v.unshift(-1);else{var m=Tt(v,o);g.splice(m,0,s),v.splice(m,0,o)}}else u[a]={attributes:s,selectedLength:d?-1:o,node:f,array:!1}}}for(i=0,o=l.length;i<o;i++)a=l[i],(s=u[a]).attributes=te.apply(void 0,[{}].concat(s.attributes.reverse()));return u},getEventTarget:function(t,e){void 0===e&&(e={});var n=t.target,r=t.type,i=t.clientX;void 0===i&&(i=0);var o=t.clientY;return void 0===o&&(o=0),e.fromPoint||"touchmove"===r||"touchend"===r?document.elementFromPoint(i,o):n},updateDOMSubtreeAttributes:function(t,e,n){(n=n||{}).rootBBox||(n.rootBBox=G()),n.selectors||(n.selectors=this.selectors);var r,i,o,s,a,u,l={},c={},h=[],f=n.roAttributes,d=this.findNodesAttributes(f||e,t,l,n.selectors),p=f?this.findNodesAttributes(e,t,l,n.selectors):d;for(var g in d)if(s=d[g],o=s.attributes,i=s.node,(a=this.processNodeAttributes(i,o)).set||a.position||a.offset){var v,m=p[g]&&p[g].attributes,y=m&&void 0===o.ref?m.ref:o.ref;if(y){if(!(v=(l[y]||this.findBySelector(y,t,n.selectors))[0]))throw new Error('dia.ElementView: "'+y+'" reference does not exist.')}else v=null;r={node:i,refNode:v,processedAttributes:a,allAttributes:m};var b=h.findIndex(function(t){return t.refNode===i});-1<b?h.splice(b,0,r):h.push(r)}else this.setNodeAttributes(i,a.normal);for(var w=0,x=h.length;w<x;w++){r=h[w],i=r.node,v=r.refNode;var A=$(n.rotatableNode),_=v?$.ensureId(v):"",S=!!A&&!!v&&A.contains(v),k=c[_];if(!k){var P=S?A:t;k=c[_]=v?$(v).getBBox({target:P}):n.rootBBox}f?(a=this.processNodeAttributes(i,r.allAttributes),this.mergeProcessedAttributes(a,r.processedAttributes)):a=r.processedAttributes;var E=k;S&&!A.contains(i)&&(u=u||$.transformStringToMatrix(A.attr("transform")),E=$.transformRect(k,u)),this.updateRelativeAttributes(i,a,E,n)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),kt(t.set,e.set),kt(t.position,e.position),kt(t.offset,e.offset);var n=t.normal&&t.normal.transform;void 0!==n&&e.normal&&(e.normal.transform=n),t.normal=e.normal},onRemove:function(){this.removeTools()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return!!e&&(!t||e.getName()===t)},addTools:function(t){return this.removeTools(),t&&((this._toolsView=t).configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this)),t.mount()),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools()}},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},contextmenu:function(t,e,n){this.notify("cell:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.model.graph&&(this.model.startBatch("pointer"),this._graph=this.model.graph),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){this.notify("cell:pointerup",t,e,n),this._graph&&(this._graph.stopBatch("pointer",{cell:this.model}),delete this._graph)},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,n,r){this.notify("cell:mousewheel",t,e,n,r)},onevent:function(t,e,n,r){this.notify(e,t,n,r)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave:function(t){var e=this.paper;e.isAsync()&&e.dumpView(this);var n=this.getEventTarget(t,{fromPoint:!0}),r=e.findView(n);r!==this&&(this.mouseleave(t),r&&r.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{addPresentationAttributes:function(t){return te({},this.prototype.presentationAttributes,t,function(t,e){if(t&&e)return"string"==typeof t&&(t=[t]),"string"==typeof e&&(e=[e]),Array.isArray(t)&&Array.isArray(e)?Nt(t.concat(e)):void 0})}}),qe=ze.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=ze.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){ze.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:["UPDATE"],position:["TRANSLATE"],size:["RESIZE","PORTS"],angle:["ROTATE"],markup:["RENDER"],ports:["PORTS"]},initFlag:["RENDER"],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){var n=W.useCSSSelectors;return this.hasFlag(t,"PORTS")&&(this._removePorts(),this._cleanPortsCache()),this.hasFlag(t,"RENDER")?(this.render(),t=this.removeFlag(t,["RENDER","UPDATE","RESIZE","TRANSLATE","ROTATE","PORTS"])):(this.hasFlag(t,"RESIZE")&&(this.resize(e),t=this.removeFlag(t,["RESIZE","UPDATE"])),this.hasFlag(t,"UPDATE")&&(this.update(this.model,null,e),t=this.removeFlag(t,"UPDATE"),n&&(t=this.removeFlag(t,"PORTS"))),this.hasFlag(t,"TRANSLATE")&&(this.translate(),t=this.removeFlag(t,"TRANSLATE")),this.hasFlag(t,"ROTATE")&&(this.rotate(),t=this.removeFlag(t,"ROTATE")),this.hasFlag(t,"PORTS")&&(this._renderPorts(),t=this.removeFlag(t,"PORTS")),t)},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();var n=W.useCSSSelectors;n&&this._removePorts();var r=this.model,i=r.attr();this.updateDOMSubtreeAttributes(this.el,i,{rootBBox:new G(r.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===i?null:e}),n&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),n=this.selectors=e.selectors;this.rotatableNode=$(n[this.rotatableSelector])||null,this.scalableNode=$(n[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append($(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable");var n=this.selectors={};n[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),W.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode)return this.rgRotate(),void this.update();this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var n=t.size;return"rotate("+e+","+n.width/2+","+n.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,n=e.angle(),r=e.size(),i=this.scalableNode,o=!1;0<i.node.getElementsByTagName("path").length&&(o=!0);var s=i.getBBox({recursive:o}),a=r.width/(s.width||1),u=r.height/(s.height||1);i.attr("transform","scale("+a+","+u+")");var l=this.rotatableNode,c=l&&l.attr("transform");if(c){l.attr("transform",c+" rotate("+-n+","+r.width/2+","+r.height/2+")");var h=i.getBBox({target:this.paper.cells});e.set("position",{x:h.x,y:h.y},kt({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t){var e=(t=t||{}).model||this.model,n=t.paper||this.paper,r=n.model;e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});var i=r.getElements().reduce(function(t,e){return Math.max(t,e.attributes.z||0)},0),o=r.getConnectedLinks(e,{deep:!0,includeEnclosed:!0});o.forEach(function(t){t.attributes.z<=i&&t.set("z",i+1,{ui:!0})}),e.stopBatch("to-front");var s=e.parent();s&&r.getCell(s).unembed(e,{ui:!0})},processEmbedding:function(t){var e=(t=t||{}).model||this.model,n=t.paper||this.paper,r=n.options,i=[];if(Dt(r.findParentBy)){var o=Ft(r.findParentBy.call(n.model,this));i=o.filter(function(t){return t instanceof be&&this.model.id!==t.id&&!t.isEmbeddedIn(this.model)}.bind(this))}else i=n.model.findModelsUnderElement(e,{searchBy:r.findParentBy});r.frontParentOnly&&(i=i.slice(-1));for(var s=null,a=t.candidateEmbedView,u=i.length-1;0<=u;u--){var l=i[u];if(a&&a.model.id==l.id){s=a;break}var c=l.findView(n);if(r.validateEmbedding.call(n,this,c)){s=c;break}}s&&s!=a&&(this.clearEmbedding(t),t.candidateEmbedView=s.highlight(null,{embedding:!0})),!s&&a&&this.clearEmbedding(t)},clearEmbedding:function(t){var e=(t=t||{}).candidateEmbedView;e&&(e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t){var e=(t=t||{}).candidateEmbedView,n=t.model||this.model,r=t.paper||this.paper;e&&(e.model.embed(n,{ui:!0}),e.unhighlight(null,{embedding:!0}),t.candidateEmbedView=null),Ct(r.model.getConnectedLinks(n,{deep:!0}),"reparent",{ui:!0})},getDelegatedView:function(){for(var t=this,e=t.model,n=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=n.findViewByModel(e)}return null},notifyPointerdown:function(t,e,n){ze.prototype.pointerdown.call(this,t,e,n),this.notify("element:pointerdown",t,e,n)},notifyPointermove:function(t,e,n){ze.prototype.pointermove.call(this,t,e,n),this.notify("element:pointermove",t,e,n)},notifyPointerup:function(t,e,n){this.notify("element:pointerup",t,e,n),ze.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){ze.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){ze.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,n)},contextmenu:function(t,e,n){ze.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.isPropagationStopped(t)||(this.notifyPointerdown(t,e,n),this.dragStart(t,e,n))},pointermove:function(t,e,n){var r=this.eventData(t);switch(r.action){case"magnet":this.dragMagnet(t,e,n);break;case"move":(r.delegatedView||this).drag(t,e,n);default:this.notifyPointermove(t,e,n)}this.eventData(t,r)},pointerup:function(t,e,n){var r=this.eventData(t);switch(r.action){case"magnet":this.dragMagnetEnd(t,e,n);break;case"move":(r.delegatedView||this).dragEnd(t,e,n);default:this.notifyPointerup(t,e,n)}var i=r.targetMagnet;i&&this.magnetpointerclick(t,i,e,n),this.checkMouseleave(t)},mouseover:function(t){ze.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){ze.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){ze.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){ze.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,n,r){ze.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,n,r)},onmagnet:function(t,e,n){this.dragMagnetStart(t,e,n)},magnetpointerdblclick:function(t,e,n,r){this.notify("element:magnet:pointerdblclick",t,e,n,r)},magnetcontextmenu:function(t,e,n,r){this.notify("element:magnet:contextmenu",t,e,n,r)},dragStart:function(t,e,n){var r=this.getDelegatedView();r&&r.can("elementMove")&&(this.eventData(t,{action:"move",delegatedView:r}),r.eventData(t,{pointerOffset:r.model.position().difference(e,n),restrictedArea:this.paper.getRestrictedArea(r)}))},dragMagnetStart:function(t,e,n){if(this.can("addLinkFromMagnet")){var r=t.currentTarget,i=this.paper;this.eventData(t,{targetMagnet:r}),t.stopPropagation(),i.options.validateMagnet(this,r)?(i.options.magnetThreshold<=0&&this.dragLinkStart(t,r,e,n),this.eventData(t,{action:"magnet"}),this.stopPropagation(t)):this.pointerdown(t,e,n),i.delegateDragEvents(this,t.data)}},dragLinkStart:function(t,e,n,r){this.model.startBatch("add-link");var i=this.addLinkFromMagnet(e,n,r);i.notifyPointerdown(t,n,r),i.eventData(t,i.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:i})},addLinkFromMagnet:function(t,e,n){var r=this.paper,i=r.model,o=r.getDefaultLink(this,t);return o.set({source:this.getLinkEnd(t,e,n,o,"source"),target:{x:e,y:n}}).addTo(i,{async:!1,ui:!0}),o.findView(r)},drag:function(t,e,n){var r=this.paper,i=r.options.gridSize,o=this.model,s=this.eventData(t),a=s.pointerOffset,u=s.restrictedArea,l=s.embedding,c=f(e+a.x,i),h=f(n+a.y,i);o.position(c,h,{restrictedArea:u,deep:!0,ui:!0}),r.options.embeddingMode&&(l||(this.prepareEmbedding(s),l=!0),this.processEmbedding(s)),this.eventData(t,{embedding:l})},dragMagnet:function(t,e,n){var r=this.eventData(t),i=r.linkView;if(i)i.pointermove(t,e,n);else{var o=this.paper,s=o.options.magnetThreshold,a=this.getEventTarget(t),u=r.targetMagnet;if("onleave"===s){if(u===a||$(u).contains(a))return}else if(o.eventData(t).mousemoved<=s)return;this.dragLinkStart(t,u,e,n)}},dragEnd:function(t,e,n){var r=this.eventData(t);r.embedding&&this.finalizeEmbedding(r)},dragMagnetEnd:function(t,e,n){var r=this.eventData(t),i=r.linkView;i&&(i.pointerup(t,e,n),this.model.stopBatch("add-link"))},magnetpointerclick:function(t,e,n,r){var i=this.paper;i.eventData(t).mousemoved>i.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,n,r)}});kt(qe.prototype,je);var He={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var n=this._results[t];if(void 0!==n)return n;try{n=e()}catch(t){n=!1}return this._results[t]=n}},Ue=Fe.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),$e=Ue.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),Ge=qe.extend({presentationAttributes:qe.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=qe.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),We=Ue.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),Xe=Ue.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),Ye=Ue.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),Je=Ue.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Ze=Ue.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),Ke=Ue.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Qe=Ue.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}),tn=Qe.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),en=He.test("svgforeignobject"),nn=Ue.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',en?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),Ue.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":kt({},e),div:{style:kt({},e)}})},updateContent:function(t,e){en?this.attr({".content":{html:ht(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),rn=qe.extend({presentationAttributes:en?qe.prototype.presentationAttributes:qe.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=qe.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var n=this.model;if(en)qe.prototype.update.call(this,n,e);else{var r=Xt(e||n.get("attrs"),".content");qe.prototype.update.call(this,n,r),e&&!Gt(e,".content")||this.updateContent(n,e)}},updateContent:function(t,e){var n=te({},(e||t.get("attrs"))[".content"]);n=Xt(n,"text");var r=ct(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),i=Q({},".content",n,"/");i[".content"].text=r,qe.prototype.update.call(this,t,i)}}),on={Generic:Ue,Rect:$e,TextView:Ge,Text:We,Circle:Xe,Ellipse:Ye,Polygon:Je,Polyline:Ze,Image:Ke,Path:Qe,Rhombus:tn,TextBlock:nn,TextBlockView:rn},sn=be.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:void 0,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,n){if(void 0===t)return Lt(this.get("source"));var r,i,o=t instanceof be;if(o)return(r=Lt(e)||{}).id=t.id,i=n,this.set("source",r,i);var s=!jt(t);return i=s?((r=Lt(e)||{}).x=t.x,r.y=t.y,n):(r=t,e),this.set("source",r,i)},target:function(t,e,n){if(void 0===t)return Lt(this.get("target"));var r,i,o=t instanceof be;if(o)return(r=Lt(e)||{}).id=t.id,i=n,this.set("target",r,i);var s=!jt(t);return i=s?((r=Lt(e)||{}).x=t.x,r.y=t.y,n):(r=t,e),this.set("target",r,i)},router:function(t,e,n){if(void 0===t){var r=this.get("router");return r?"object"==typeof r?Lt(r):r:this.get("manhattan")?{name:"orthogonal"}:null}var i="object"==typeof t||"function"==typeof t,o=i?t:{name:t,args:e},s=i?e:n;return this.set("router",o,s)},connector:function(t,e,n){if(void 0===t){var r=this.get("connector");return r?"object"==typeof r?Lt(r):r:this.get("smooth")?{name:"smooth"}:null}var i="object"==typeof t||"function"==typeof t,o=i?t:{name:t,args:e},s=i?e:n;return this.set("connector",o,s)},label:function(t,e,n){var r=this.labels();return(t=isFinite(t)&&null!==t?0|t:0)<0&&(t=r.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,n)},labels:function(t,e){return 0===arguments.length?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},insertLabel:function(t,e,n){if(!e)throw new Error("dia.Link: no label provided");var r=this.labels(),i=r.length;return(t=isFinite(t)&&null!==t?0|t:i)<0&&(t=i+t+1),r.splice(t,0,e),this.labels(r,n)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var n=this.labels();return t=isFinite(t)&&null!==t?0|t:-1,n.splice(t,1),this.labels(n,e)},vertex:function(t,e,n){var r=this.vertices();if((t=isFinite(t)&&null!==t?0|t:0)<0&&(t=r.length+t),arguments.length<=1)return this.prop(["vertices",t]);var i=this._normalizeVertex(e);return this.prop(["vertices",t],i,n)},vertices:function(t,e){if(0===arguments.length)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var n=[],r=0;r<t.length;r++){var i=t[r],o=this._normalizeVertex(i);n.push(o)}return this.set("vertices",n,e)},insertVertex:function(t,e,n){if(!e)throw new Error("dia.Link: no vertex provided");var r=this.vertices(),i=r.length;(t=isFinite(t)&&null!==t?0|t:i)<0&&(t=i+t+1);var o=this._normalizeVertex(e);return r.splice(t,0,o),this.vertices(r,n)},removeVertex:function(t,e){var n=this.vertices();return t=isFinite(t)&&null!==t?0|t:-1,n.splice(t,1),this.vertices(n,e)},_normalizeVertex:function(t){var e=!jt(t);return e?{x:t.x,y:t.y}:t},translate:function(e,n,t){return(t=t||{}).translateBy=t.translateBy||this.id,t.tx=e,t.ty=n,this.applyToPoints(function(t){return{x:(t.x||0)+e,y:(t.y||0)+n}},t)},scale:function(e,n,r,t){return this.applyToPoints(function(t){return S(t).scale(e,n,r).toJSON()},t)},applyToPoints:function(t,e){if(!Dt(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var n={},r=this.source();r.id||(n.source=t(r));var i=this.target();i.id||(n.target=t(i));var o=this.vertices();return 0<o.length&&(n.vertices=o.map(t)),this.set(n,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new S(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new S(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){var t=[this.getSourcePoint(),this.getTargetPoint()],e=this.vertices();return 0<e.length&&Array.prototype.push.apply(t,e.map(S)),new T(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var n=this.getSourceElement(),r=this.getTargetElement(),i=this.getParentCell();n&&r&&(e=n===r||n.isEmbeddedIn(r)?r:r.isEmbeddedIn(n)?n:this.graph.getCommonAncestor(n,r)),!i||e&&e.id===i.id||i.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var e=this.source().id,n=this.target().id;if(!e||!n)return!1;var r=e===n;if(!r&&t.deep&&this.graph){var i=this.getSourceCell(),o=this.getTargetCell();r=i.isEmbeddedIn(o)||o.isEmbeddedIn(i)}return r},getSourceCell:function(){var t=this.source(),e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){var t=this.target(),e=this.graph;return t&&t.id&&e&&e.getCell(t.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(t){return!!t});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=ie(t)||re(t)?t:t.id,n=this.getRelationshipAncestor();return!!n&&(n.id===e||n.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var n=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&n}}),an=Fe.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),un=Fe.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),ln=Fe.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),cn=Fe.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),hn=Fe.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),fn=Fe.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),dn=Fe.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),pn=Fe.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#FFFFFF"},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),gn=Fe.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),vn=Fe.define("standard.InscribedImage",{attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#FFFFFF"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),mn=Fe.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]}),yn=Fe.define("standard.Cylinder",{attrs:{body:{lateralArea:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:10,refRx:"50%",ry:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(void 0===t)return this.attr("body/lateralArea");var n=ut(t),r={lateralArea:t},i=n?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:r,top:i},e)}},{attributes:{lateralArea:{set:function(t,e){var n=ut(t);n&&(t=parseFloat(t)/100);var r=e.x,i=e.y,o=e.width,s=e.height,a=o/2,u=n?s*t:t,l=$.KAPPA,c=l*a,h=l*(n?s*t:t),f=r,d=r+o/2,p=r+o,g=i+u,v=g-u,m=i+s-u,y=i+s,b=["M",f,g,"L",f,m,"C",r,m+h,d-c,y,d,y,"C",d+c,y,p,m+h,p,m,"L",p,g,"C",p,g-h,d+c,v,d,v,"C",d-c,v,f,g-h,f,g,"Z"];return{d:b.join(" ")}}}}}),bn=He.test("svgforeignobject")?{tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},wn=Fe.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},bn]},{attributes:{text:{set:function(t,e,n,r){if(!(n instanceof HTMLElement)){var i=r.style||{},o={text:t,width:-5,height:"100%"},s=kt({textVerticalAnchor:"middle"},i);return ye.textWrap.set.call(this,o,e,n,s),{fill:i.color||null}}n.textContent=t},position:function(t,e,n){if(n instanceof SVGElement)return e.center()}}}}),xn=sn.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),An=sn.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),_n=sn.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}),Sn={Rectangle:an,Circle:un,Ellipse:ln,Path:cn,Polygon:hn,Polyline:fn,Image:dn,BorderedImage:pn,EmbeddedImage:gn,InscribedImage:vn,HeaderedRectangle:mn,Cylinder:yn,TextBlock:wn,Link:xn,DoubleLink:An,ShadowLink:_n},kn=["arc","gap","cubic"],Pn=["smooth"];function En(t,e,n){var i=[].concat(t,n,e);return i.reduce(function(t,e,n){var r=i[n+1];return null!=r&&(t[n]=k(e,r)),t},[])}function Cn(){for(var t=this._jumpOverUpdateList,e=0;e<t.length;e++)t[e].update()}function Tn(t,e){return k(t,e).squaredLength()}function Nn(t,f,d){var p,g=new C;return p=C.createSegment("M",t[0].start),g.appendSegment(p),Ft(t).forEach(function(t,e){var n,r,i,o;if(t.isJump){if("arc"===d){n=-90,r=t.start.difference(t.end);var s=Number(r.x<0||0===r.x&&r.y<0);s&&(n+=180);var a,u=t.midpoint(),l=new A(u,t.end).rotate(u,n);a=new A(t.start,u),i=a.pointAt(2/3).rotate(t.start,n),o=l.pointAt(1/3).rotate(l.end,-n),p=C.createSegment("C",i,o,l.end),g.appendSegment(p),a=new A(u,t.end),i=l.pointAt(1/3).rotate(l.end,n),o=a.pointAt(1/3).rotate(t.end,-n),p=C.createSegment("C",i,o,t.end),g.appendSegment(p)}else if("gap"===d)p=C.createSegment("M",t.end),g.appendSegment(p);else if("cubic"===d){n=t.start.theta(t.end);var c=.6*f,h=1.35*f;r=t.start.difference(t.end),(s=Number(r.x<0||0===r.x&&r.y<0))&&(h*=-1),i=S(t.start.x+c,t.start.y+h).rotate(t.start,n),o=S(t.end.x-c,t.end.y+h).rotate(t.end,n),p=C.createSegment("C",i,o,t.end),g.appendSegment(p)}}else p=C.createSegment("L",t.end),g.appendSegment(p)}),g}var Ln={jumpover:function(t,e,n,r){!function(t){var e=t.paper._jumpOverUpdateList;null==e&&(e=t.paper._jumpOverUpdateList=[],t.paper.on("cell:pointerup",Cn),t.paper.model.on("reset",function(){e=t.paper._jumpOverUpdateList=[]}));e.indexOf(t)<0&&(e.push(t),t.listenToOnce(t.model,"change:connector remove",function(){e.splice(e.indexOf(t),1)}))}(this);var i=r.raw,o=r.size||5,s=r.jump&&(""+r.jump).toLowerCase(),a=r.ignoreConnectors||Pn;-1===kn.indexOf(s)&&(s=kn[0]);var u=this.paper,l=u.model,c=l.getLinks();if(1===c.length)return Nn(En(t,e,n),o,s);var h=this.model,f=c.indexOf(h),d=u.options.defaultConnector||{},p=c.filter(function(t,e){var n=t.get("connector")||d;return!Ft(a).includes(n.name)&&(!(f<e)||"jumpover"!==n.name)}),g=p.map(function(t){return u.findViewByModel(t)}),v=En(t,e,n),m=g.map(function(t){return null==t?[]:t===this?v:En(t.sourcePoint,t.targetPoint,t.route)},this),y=v.reduce(function(t,i){var e=p.reduce(function(t,e,n){if(e!==h){var r=function(r,t){return Ft(t).reduce(function(t,e){var n=r.intersection(e);return n&&t.push(n),t},[])}(i,m[n]);t.push.apply(t,r)}return t},[]).sort(function(t,e){return Tn(i.start,t)-Tn(i.start,e)});return 0<e.length?t.push.apply(t,function(l,c,h){return c.reduce(function(t,e,n){if(!0===e.skip)return t;var r=t.pop()||l,i=P(e).move(r.start,-h),o=P(e).move(r.start,+h),s=c[n+1];if(null!=s){var a=o.distance(s);a<=h&&(o=s.move(r.start,a),s.skip=!0)}else{if(i.distance(r.end)<2*h+1)return t.push(r),t}if(o.distance(r.start)<2*h+1)return t.push(r),t;var u=k(i,o);return u.isJump=!0,t.push(k(r.start,i),u,k(o,r.end)),t},[])}(i,e,o)):t.push(i),t},[]),b=Nn(y,o,s);return i?b:b.serialize()},normal:function(t,e,n,r){var i=r&&r.raw,o=[t].concat(n).concat([e]),s=new T(o),a=new C(s);return i?a:a.serialize()},rounded:function(t,e,n,r){var i,o=(r=r||{}).radius||10,s=r.raw,a=new C;i=C.createSegment("M",t),a.appendSegment(i);for(var u,l,c,h,f,d,p,g,v,m,y,b=0,w=n.length;b<w;b++)u=new S(n[b]),l=n[b-1]||t,c=n[b+1]||e,h=f||u.distance(l)/2,f=u.distance(c)/2,d=-Math.min(o,h),p=-Math.min(o,f),g=u.clone().move(l,d).round(),v=u.clone().move(c,p).round(),m=new S(1/3*g.x+2/3*u.x,2/3*u.y+1/3*g.y),y=new S(1/3*v.x+2/3*u.x,2/3*u.y+1/3*v.y),i=C.createSegment("L",g),a.appendSegment(i),i=C.createSegment("C",m,y,v),a.appendSegment(i);return i=C.createSegment("L",e),a.appendSegment(i),s?a:a.serialize()},smooth:function(t,e,n,r){var i,o=r&&r.raw;if(n&&0!==n.length){var s=[t].concat(n).concat([e]),a=v.throughPoints(s);i=new C(a)}else{var u;if(i=new C,u=C.createSegment("M",t),i.appendSegment(u),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var l=(t.x+e.x)/2;u=C.createSegment("C",l,t.y,l,e.y,e.x,e.y),i.appendSegment(u)}else{var c=(t.y+e.y)/2;u=C.createSegment("C",t.x,c,e.x,c,e.x,e.y),i.appendSegment(u)}}return o?i:i.serialize()}},Mn={defaultOptions:{padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},_views:{},getHighlighterId:function(t,e){return t.id+JSON.stringify(e)},removeHighlighter:function(t){this._views[t]&&(this._views[t].remove(),this._views[t]=null)},highlight:function(t,e,n){var r=this.getHighlighterId(e,n);if(!this._views[r]){var i,o=Pt(n||{},this.defaultOptions),s=$(e);try{var a=s.convertToPathData()}catch(t){i=s.bbox(!0),a=$.rectToPath(kt({},o,i))}var u=$("path").attr({d:a,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"}).attr(o.attrs);if(t.isNodeConnection(e))u.attr("d",t.getSerializedConnection());else{var l=s.getTransformToElement(t.el),c=o.padding;if(c){var h=(i=i||s.bbox(!0)).x+i.width/2,f=i.y+i.height/2;i=$.transformRect(i,l);var d=Math.max(i.width,1),p=Math.max(i.height,1),g=(d+c)/d,v=(p+c)/p,m=$.createSVGMatrix({a:g,b:0,c:0,d:v,e:h-g*h,f:f-v*f});l=l.multiply(m)}u.transform(l)}var y=this._views[r]=new Ve({svgElement:!0,className:"highlight-stroke",el:u.node}),b=this.removeHighlighter.bind(this,r),w=t.model;y.listenTo(w,"remove",b),y.listenTo(w.graph,"reset",b),t.vel.append(u)}},unhighlight:function(t,e,n){this.removeHighlighter(this.getHighlighterId(e,n))}},On={highlight:function(t,e){$(e).addClass(X("highlight-opacity"))},unhighlight:function(t,e){$(e).removeClass(X("highlight-opacity"))}},Rn={className:X("highlighted"),highlight:function(t,e,n){var r=n||{},i=r.className||this.className;$(e).addClass(i)},unhighlight:function(t,e,n){var r=n||{},i=r.className||this.className;$(e).removeClass(i)}},Dn={stroke:Mn,opacity:On,addClass:Rn};function jn(t,e,n){if(!isFinite(n))return t;var r=t.distance(e);return 0===n&&0<r?t:t.move(e,-Math.min(n,r-1))}function Fn(t){var e=t.getAttribute("stroke-width");return null===e?0:parseFloat(e)||0}function Bn(t,e,n,r){var i=e.getNodeBBox(n);r.stroke&&i.inflate(Fn(n)/2);var o=t.intersect(i),s=o?t.start.chooseClosest(o):t.end;return jn(s,t.start,r.offset)}function Vn(t){if(!t)return null;var e=t;do{var n=e.tagName;if("string"!=typeof n)return null;if("G"===(n=n.toUpperCase()))e=e.firstElementChild;else{if("TITLE"!==n)break;e=e.nextElementSibling}}while(e);return e}var In="segmentSubdivisons",zn="shapeBBox";var qn={anchor:function(t,e,n,r){return jn(t.end,t.start,r.offset)},bbox:Bn,rectangle:function(t,e,n,r){var i=e.model.angle();if(0===i)return Bn(t,e,n,r);var o=e.getNodeUnrotatedBBox(n);r.stroke&&o.inflate(Fn(n)/2);var s=o.center(),a=t.clone().rotate(s,i),u=a.setLength(1e6).intersect(o);return jn(u?a.start.chooseClosest(u).rotate(s,-i):t.end,t.start,r.offset)},boundary:function(t,e,n,r){var i,o,s=r.selector,a=t.end;i="string"==typeof s?e.findBySelector(s)[0]:Array.isArray(s)?K(n,s):Vn(n);if(!$.isSVGGraphicsElement(i)){if(i===n||!$.isSVGGraphicsElement(n))return a;i=n}var u,l=e.getNodeShape(i),c=e.getNodeMatrix(i),h=e.getRootTranslateMatrix(),f=e.getRootRotateMatrix(),d=h.multiply(f).multiply(c),p=d.inverse(),g=$.transformLine(t,p),v=g.start.clone(),m=e.getNodeData(i);if(!1===r.insideout){if(m[zn]||(m[zn]=l.bbox()),m[zn].containsPoint(v))return a}if(l instanceof C){var y=r.precision||2;m[In]||(m[In]=l.getSegmentSubdivisions({precision:y})),u={precision:y,segmentSubdivisions:m[In]}}!0===r.extrapolate&&g.setLength(1e6);(o=g.intersect(l,u))?$.isArray(o)&&(o=v.chooseClosest(o)):!0===r.sticky&&(o=l instanceof G?l.pointNearestToPoint(v):l instanceof x?l.intersectionWithLineFromCenterToPoint(v):l.closestPoint(v,u));var b=o?$.transformPoint(o,d):a,w=r.offset||0;r.stroke&&(w+=Fn(i)/2);return jn(b,t.start,w)}};function Hn(t,e){return 0===e?"0%":Math.round(t/e*100)+"%"}function Un(o){return function(t,e,n,r){var i=e.isNodeConnection(n)?Gn:$n;return i(o,t,e,n,r)}}function $n(t,e,n,r,i){var o=n.model.angle(),s=n.getNodeUnrotatedBBox(r),a=n.model.getBBox().center();i.rotate(a,o);var u=i.x-s.x,l=i.y-s.y;return t&&(u=Hn(u,s.width),l=Hn(l,s.height)),e.anchor={name:"topLeft",args:{dx:u,dy:l,rotate:!0}},e}function Gn(t,e,n,r,i){var o=n.getConnection();if(!o)return e;var s=o.closestPointLength(i);if(t){var a=o.length();e.anchor={name:"connectionRatio",args:{ratio:s/a}}}else e.anchor={name:"connectionLength",args:{length:s}};return e}var Wn=oe,Xn=Un(!1),Yn=Un(!0),Jn={useDefaults:Wn,pinAbsolute:Xn,pinRelative:Yn},Zn={N:"S",S:"N",E:"W",W:"E"},Kn={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function Qn(t,e,n){var r=new S(t.x,e.y);return n.containsPoint(r)&&(r=new S(e.x,t.y)),r}function tr(t,e){return t["W"===e||"E"===e?"width":"height"]}function er(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function nr(t){return new G(t.x,t.y,0,0)}function rr(t){var e=gt(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function ir(t,e){return t.sourceBBox.clone().moveAndExpand(rr(e))}function or(t,e){return t.targetBBox.clone().moveAndExpand(rr(e))}function sr(t,e,n){var r=new S(t.x,e.y),i=new S(e.x,t.y),o=er(t,r),s=er(t,i),a=Zn[n],u=o===n||o!==a&&(s===a||s!==n)?r:i;return{points:[u],direction:er(u,e)}}function ar(t,e,n){var r=Qn(t,e,n);return{points:[r],direction:er(r,e)}}function ur(e,t,n,r){var i,o={},s=[new S(e.x,t.y),new S(t.x,e.y)],a=s.filter(function(t){return!n.containsPoint(t)}),u=a.filter(function(t){return er(t,e)!==r});if(0<u.length)i=(i=u.filter(function(t){return er(e,t)===r}).pop())||u[0],o.points=[i],o.direction=er(i,t);else{i=Ht(s,a)[0];var l=new S(t).move(i,-tr(n,r)/2),c=Qn(l,e,n);o.points=[c,l],o.direction=er(l,t)}return o}function lr(t,e,n,r){var i=ar(e,t,r),o=i.points[0];if(n.containsPoint(o)){var s=(i=ar(t,e,n)).points[0];if(r.containsPoint(s)){var a=new S(t).move(s,-tr(n,er(t,s))/2),u=new S(e).move(o,-tr(r,er(e,o))/2),l=new A(a,u).midpoint(),c=ar(t,l,n),h=sr(l,e,c.direction);i.points=[c.points[0],h.points[0]],i.direction=h.direction}}return i}function cr(t,e,n,r,i){var o,s,a,u={},l=n.union(r).inflate(1),c=l.center().distance(e)>l.center().distance(t),h=c?e:t,f=c?t:e;return o=i?(o=S.fromPolar(l.width+l.height,Kn[i],h),l.pointNearestToPoint(o).move(o,-1)):l.pointNearestToPoint(h).move(h,1),s=Qn(o,f,l),o.round().equals(s.round())?(s=S.fromPolar(l.width+l.height,_(o.theta(h))+Math.PI/2,f),s=l.pointNearestToPoint(s).move(f,1).round(),a=Qn(o,s,l),u.points=c?[s,a,o]:[o,a,s]):u.points=c?[s,o]:[o,s],u.direction=er(c?o:s,e),u}function hr(t,e,n){var r,i=ir(n,e),o=or(n,e),s=function(t,e){if(t.sourceAnchor)return t.sourceAnchor;return ir(t,e).center()}(n,e),a=function(t,e){if(t.targetAnchor)return t.targetAnchor;return or(t,e).center()}(n,e);i=i.union(nr(s)),o=o.union(nr(a)),(t=Ft(t).map(S)).unshift(s),t.push(a);for(var u=[],l=0,c=t.length-1;l<c;l++){var h=null,f=t[l],d=t[l+1],p=!!er(f,d);if(0===l)l+1===c?i.intersect(o.clone().inflate(1))?h=cr(f,d,i,o):p||(h=lr(f,d,i,o)):i.containsPoint(d)?h=cr(f,d,i,nr(d).moveAndExpand(rr(e))):p||(h=ar(f,d,i));else if(l+1===c){var g=p&&er(d,f)===r;o.containsPoint(f)||g?h=cr(f,d,nr(f).moveAndExpand(rr(e)),o,r):p||(h=ur(f,d,o,r))}else p||(h=sr(f,d,r));r=h?(Array.prototype.push.apply(u,h.points),h.direction):er(f,d),l+1<c&&u.push(d)}return u}var fr={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:function(t,e,n){if(!Dt(hr))throw new Error("Manhattan requires the orthogonal router as default fallback.");return hr(t,kt({},fr,e),n)},fallbackRoute:function(t,e,n){return null},draggingRoute:null};function dr(t){this.map={},this.options=t,this.mapGridSize=100}function pr(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}function gr(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function vr(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function mr(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=gr(t,e);return n.center()}function yr(t,e,n,r,i){var o=360/n,s=t.theta(function(t,e,n,r){var i=r.step,o=e.x-t.x,s=e.y-t.y,a=o/n.x,u=s/n.y,l=a*i,c=u*i;return new S(t.x+l,t.y+c)}(t,e,r,i)),a=w(s+o/2);return o*Math.floor(a/o)}function br(t,e){var n=Math.abs(t-e);return 180<n?360-n:n}function wr(t,e){if(!t)return e;var n=Math.abs(t),r=Math.round(n/e);if(!r)return n;var i=r*e,o=n-i,s=o/r;return e+s}function xr(t,e){return t.round(e)}function Ar(t,e,n){return xr(function(t,e){var n=e.source,r=f(t.x-n.x,e.x)+n.x,i=f(t.y-n.y,e.y)+n.y;return new S(r,i)}(t.clone(),e),n)}function _r(t){return t.clone().toString()}function Sr(t){return new S(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function kr(t,e,n,r,i,o,s){for(var a,u=[],l=Sr(i.difference(n)),c=_r(n),h=t[c];h;){var f=Sr((a=e[c]).difference(h));f.equals(l)||(u.unshift(a),l=f),c=_r(h),h=t[c]}var d=e[c],p=Sr(d.difference(r));return p.equals(l)||u.unshift(d),u}function Pr(t,e){for(var n=1/0,r=0,i=e.length;r<i;r++){var o=t.manhattanDistance(e[r]);o<n&&(n=o)}return n}function Er(d,p,t,g,e){var v=e.precision,m=e.directionMap,y=d.difference(p.center()),n=ne(m)?Object.keys(m):[],b=Ft(t),r=n.reduce(function(t,e){if(b.includes(e)){for(var n,r=m[e],i=new S(d.x+r.x*(Math.abs(y.x)+p.width),d.y+r.y*(Math.abs(y.y)+p.height)),o=new A(d,i),s=o.intersect(p)||[],a=s.length,u=null,l=0;l<a;l++){var c=s[l],h=d.squaredDistance(c);(void 0===n||n<h)&&(n=h,u=c)}if(u){var f=Ar(u,g,v);p.containsPoint(f)&&(f=Ar(f.offset(r.x*g.x,r.y*g.y),g,v)),t.push(f)}}return t},[]);return p.containsPoint(d)||r.push(Ar(d,g,v)),r}function Cr(t,e,n,r){var i,o,s=r.precision;i=xr(t instanceof G?mr(this,r).clone():t.clone(),s),o=xr(e instanceof G?function(t,e){if(t.targetAnchor)return t.targetAnchor;return vr(t,e).center()}(this,r).clone():e.clone(),s);var a,u,l,c,h=function(t,e,n){return{source:e.clone(),x:wr(n.x-e.x,t),y:wr(n.y-e.y,t)}}(r.step,i,o);if(l=t instanceof G?Er(a=i,t,r.startDirections,h,r):[a=i],c=e instanceof G?Er(u=o,e,r.endDirections,h,r):[u=o],l=l.filter(n.isPointAccessible,n),c=c.filter(n.isPointAccessible,n),0<l.length&&0<c.length){for(var f=new pr,d={},p={},g={},v=0,m=l.length;v<m;v++){var y=l[v],b=_r(y);f.add(b,Pr(y,c)),d[b]=y,g[b]=0}var w,x,A=r.previousDirectionAngle,_=void 0===A,S=r.directions;!function(t,e,n){var r=n.step;Ft(n.directions).forEach(function(t){t.gridOffsetX=t.offsetX/r*e.x,t.gridOffsetY=t.offsetY/r*e.y})}(0,h,r);for(var k=S.length,P=Ft(c).reduce(function(t,e){var n=_r(e);return t.push(n),t},[]),E=r.maximumLoops;!f.isEmpty()&&0<E;){var C,T=f.pop(),N=d[T],L=p[T],M=g[T],O=void 0===L,R=N.equals(a);C=O?_?R?null:yr(a,N,k,h,r):A:yr(L,N,k,h,r);var D=Rt(l,c),j=O&&D;if(!j&&0<=P.indexOf(T))return r.previousDirectionAngle=C,kr(p,d,N,a,u,h,r);for(v=0;v<k;v++){var F=(w=S[v]).angle;if(x=br(C,F),_&&R||!(x>r.maxAllowedDirectionChange)){var B=Ar(N.clone().offset(w.gridOffsetX,w.gridOffsetY),h,s),V=_r(B);if(!f.isClose(V)&&n.isPointAccessible(B)){if(0<=P.indexOf(V)){var I=B.equals(u);if(!I){var z=yr(B,u,k,h,r),q=br(F,z);if(q>r.maxAllowedDirectionChange)continue}}var H=w.cost,U=R?0:r.penalties[x],$=M+H+U;(!f.isOpen(V)||$<g[V])&&(d[V]=B,p[V]=N,g[V]=$,f.add(V,$+Pr(B,c)))}}}E--}}return r.fallbackRoute.call(this,a,u,r)}function Tr(t,e,n){!function(t){if(t.directions=Wt(t,"directions"),t.penalties=Wt(t,"penalties"),t.paddingBox=Wt(t,"paddingBox"),t.padding=Wt(t,"padding"),t.padding){var e=gt(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}Ft(t.directions).forEach(function(t){var e=new S(0,0),n=new S(t.offsetX,t.offsetY);t.angle=w(e.theta(n))})}(e),n.options.perpendicular=!!e.perpendicular;for(var r,i,o=gr(n,e),s=vr(n,e),a=mr(n,e),u=new dr(e).build(n.paper.model,n.model),l=Ft(t).map(S),c=[],h=a,f=0,d=l.length;f<=d;f++){var p=null;if(i=r||o,!(r=l[f])){r=s;var g=!n.model.get("source").id||!n.model.get("target").id;if(g&&Dt(e.draggingRoute)){var v=i===o?a:i,m=r.origin();p=e.draggingRoute.call(n,v,m,e)}}if(null===(p=p||Cr.call(n,i,r,u,e)))return e.fallbackRouter(t,e,n);var y=p[0];y&&y.equals(h)&&p.shift(),h=p[p.length-1]||h,Array.prototype.push.apply(c,p)}return c}dr.prototype.build=function(i,o){var f=this.options,d=Ft(f.excludeEnds).reduce(function(t,e){var n=o.get(e);if(n){var r=i.getCell(n.id);r&&t.push(r)}return t},[]),p=[],t=i.getCell(o.get("source").id);t&&(p=$t(p,t.getAncestors().map(function(t){return t.id})));var e=i.getCell(o.get("target").id);e&&(p=$t(p,e.getAncestors().map(function(t){return t.id})));var g=this.mapGridSize;return i.getElements().reduce(function(t,e){var n=Ft(f.excludeTypes).includes(e.get("type")),r=d.find(function(t){return t.id===e.id}),i=p.includes(e.id),o=n||r||i;if(!o)for(var s=e.getBBox().moveAndExpand(f.paddingBox),a=s.origin().snapToGrid(g),u=s.corner().snapToGrid(g),l=a.x;l<=u.x;l+=g)for(var c=a.y;c<=u.y;c+=g){var h=l+"@"+c;t[h]=t[h]||[],t[h].push(s)}return t},this.map),this},dr.prototype.isPointAccessible=function(e){var t=e.clone().snapToGrid(this.mapGridSize).toString();return Ft(this.map[t]).every(function(t){return!t.containsPoint(e)})},pr.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var n=Tt(this.items,t,function(t){return this.values[t]}.bind(this));this.items.splice(n,0,t)},pr.prototype.remove=function(t){this.hash[t]=this.CLOSE},pr.prototype.isOpen=function(t){return this.hash[t]===this.OPEN},pr.prototype.isClose=function(t){return this.hash[t]===this.CLOSE},pr.prototype.isEmpty=function(){return 0===this.items.length},pr.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};var Nr=function(t,e,n){return Tr(t,kt({},fr,e),n)},Lr={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),n=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:n},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:n},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:n},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:n}]},fallbackRoute:function(t,e,n){var r=t.theta(e),i=[],o={x:e.x,y:t.y},s={x:t.x,y:e.y};if(90<r%180){var a=o;o=s,s=a}var u=r%90<45?o:s,l=new A(t,u),c=90*Math.ceil(r/90),h=S.fromPolar(l.squaredLength(),_(135+c),u),f=new A(e,h),d=l.intersection(f),p=d||e,g=d?p:t,v=360/n.directions.length,m=g.theta(e),y=w(m+v/2),b=v*Math.floor(y/v);return n.previousDirectionAngle=b,p&&i.push(p.round()),i.push(e),i}},Mr={normal:function(t,e,n){return t},oneSide:function(t,e,n){var r=e.side||"bottom",i=gt(e.padding||40),o=n.sourceBBox,s=n.targetBBox,a=o.center(),u=s.center(),l,c,h;switch(r){case"bottom":h=1;l="y";c="height";break;case"top":h=-1;l="y";c="height";break;case"left":h=-1;l="x";c="width";break;case"right":h=1;l="x";c="width";break;default:throw new Error("Router: invalid side")}if(a[l]+=h*(o[c]/2+i[r]),u[l]+=h*(s[c]/2+i[r]),0<h*(a[l]-u[l])){u[l]=a[l]}else{a[l]=u[l]}return[a].concat(t,u)},orthogonal:hr,manhattan:Nr,metro:function(t,e,n){if(!Dt(Nr))throw new Error("Metro requires the manhattan router.");return Nr(t,kt({},Lr,e),n)}};function Or(a){return function(t,e,n,r){if(n instanceof Element){var i,o=this.paper.findView(n);if(o)if(o.isNodeConnection(n)){var s="fixedAt"in r?r.fixedAt:"50%";i=Rr(o,s)}else i=o.getNodeBBox(n).center();else i=new S;return a.call(this,t,e,i,r)}return a.apply(this,arguments)}}function Rr(t,e){var n=parseFloat(e);return ut(e)?t.getPointAtRatio(n/100):t.getPointAtLength(n)}var Dr=Or(function(t,e,n,r){var i=t.getConnection(),o=t.getConnectionSubdivisions(),s=new A(n.clone().offset(0,1e6),n.clone().offset(0,-1e6)),a=new A(n.clone().offset(1e6,0),n.clone().offset(-1e6,0)),u=s.intersect(i,{segmentSubdivisions:o}),l=a.intersect(i,{segmentSubdivisions:o}),c=[];u&&Array.prototype.push.apply(c,u);l&&Array.prototype.push.apply(c,l);if(0<c.length)return n.chooseClosest(c);if("fallbackAt"in r)return Rr(t,r.fallbackAt);return jr(t,e,n,r)}),jr=Or(function(t,e,n,r){var i=t.getClosestPoint(n);return i||new S}),Fr={resolveRef:Or,connectionRatio:function(t,e,n,r){var i="ratio"in r?r.ratio:.5;return t.getPointAtRatio(i)},connectionLength:function(t,e,n,r){var i="length"in r?r.length:20;return t.getPointAtLength(i)},connectionPerpendicular:Dr,connectionClosest:jr};function Br(h){return function(t,e,n,r){var i=!!r.rotate,o=i?t.getNodeUnrotatedBBox(e):t.getNodeBBox(e),s=o[h](),a=r.dx;if(a){var u=ut(a);a=parseFloat(a),isFinite(a)&&(u&&(a/=100,a*=o.width),s.x+=a)}var l=r.dy;if(l){var c=ut(l);l=parseFloat(l),isFinite(l)&&(c&&(l/=100,l*=o.height),s.y+=l)}return i?s.rotate(t.model.getBBox().center(),-t.model.angle()):s}}var Vr=Br("center"),Ir=Br("topMiddle"),zr=Br("bottomMiddle"),qr=Br("leftMiddle"),Hr=Br("rightMiddle"),Ur=Br("origin"),$r=Br("topRight"),Gr=Br("bottomLeft"),Wr=Br("corner"),Xr=Or(function(t,e,n,r){var i=t.model.angle(),o=t.getNodeBBox(e),s=o.center(),a=o.origin(),u=o.corner(),l=r.padding;isFinite(l)||(l=0);if(a.y+l<=n.y&&n.y<=u.y-l){var c=n.y-s.y;s.x+=0===i||180===i?0:1*c/Math.tan(_(i)),s.y+=c}else if(a.x+l<=n.x&&n.x<=u.x-l){var h=n.x-s.x;s.y+=90===i||270===i?0:h*Math.tan(_(i)),s.x+=h}return s}),Yr=Or(function(t,e,n,r){var i,o,s,a=!!r.rotate;a?(i=t.getNodeUnrotatedBBox(e),s=t.model.getBBox().center(),o=t.model.angle()):i=t.getNodeBBox(e);var u,l=r.padding;isFinite(l)&&i.inflate(l);a&&n.rotate(s,o);switch(i.sideNearestToPoint(n)){case"left":u=i.leftMiddle();break;case"right":u=i.rightMiddle();break;case"top":u=i.topMiddle();break;case"bottom":u=i.bottomMiddle()}return a?u.rotate(s,-o):u}),Jr={center:Vr,top:Ir,bottom:zr,left:qr,right:Hr,topLeft:Ur,topRight:$r,bottomLeft:Gr,bottomRight:Wr,perpendicular:Xr,midSide:Yr,modelCenter:function(t,e,n,r,i){return t.model.getPointFromConnectedLink(this.model,i).offset(r.dx,r.dy)}},Zr=a.Collection.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace="undefined"!=typeof joint&&Gt(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){var n=e.collection,r=n.cellNamespace,i="link"===t.type?sn:K(r,t.type,".")||Fe,o=new i(t,e);return e.dry||(o.graph=n.graph),o},comparator:function(t){return t.get("z")||0}}),Kr=a.Model.extend({_batches:{},initialize:function(t,e){var n=new Zr([],{model:(e=e||{}).cellModel,cellNamespace:e.cellNamespace,graph:this});a.Model.prototype.set.call(this,"cells",n),n.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},n.on("add",this._restructureOnAdd,this),n.on("remove",this._restructureOnRemove,this),n.on("reset",this._restructureOnReset,this),n.on("change:source",this._restructureOnChangeSource,this),n.on("change:target",this._restructureOnChangeTarget,this),n.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var e=t.source(),n=t.target();e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var e=t.source(),n=t.target();e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],n.id&&this._in[n.id]&&this._in[n.id][t.id]&&delete this._in[n.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var n=t.source();n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var n=t.get("target");n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=a.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,e,n){var r;return"object"==typeof t?(r=t,n=e):(r={})[t]=e,r.hasOwnProperty("cells")&&(this.resetCells(r.cells,n),r=Xt(r,"cells")),a.Model.prototype.set.call(this,r,n)},clear:function(t){t=kt({},t,{clear:!0});var e=this.get("cells");if(0===e.length)return this;this.startBatch("clear",t);for(var n=e.sortBy(function(t){return t.isLink()?1:2});n.shift().remove(t),0<n.length;);return this.stopBatch("clear"),this},_prepareCell:function(t,e){var n;if(t instanceof a.Model?(n=t.attributes,t.graph||e&&e.dry||(t.graph=this)):n=t,!ie(n.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof a.Model?t.has("z")||t.set("z",this.maxZIndex()+1):void 0===t.z&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return 0===t.length||(t=zt(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(t){this.addCell(t,e),e.position--},this),this.stopBatch("add",e)),this},resetCells:function(t,e){var n=Ft(t).map(function(t){return this._prepareCell(t,e)},this);return this.get("cells").reset(n,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),Ct(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,n){(n=n||{}).clear||(n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return Object.keys(this._nodes).map(this.getCell,this)},getLinks:function(){return Object.keys(this._edges).map(this.getCell,this)},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,o){var i=(o=o||{}).indirect,s=o.inbound,a=o.outbound;void 0===s&&void 0===a&&(s=a=!0);var u=[],l={};function c(r,t){if(Zt(r.getOutboundEdges(t.id),function(t,e){if(!l[e]){var n=r.getCell(e);u.push(n),l[e]=!0,i&&(s&&h(r,n),a&&c(r,n))}}.bind(r)),i&&t.isLink()){var e=t.getTargetCell();e&&e.isLink()&&(l[e.id]||(u.push(e),c(r,e)))}}function h(r,t){if(Zt(r.getInboundEdges(t.id),function(t,e){if(!l[e]){var n=r.getCell(e);u.push(n),l[e]=!0,i&&(s&&h(r,n),a&&c(r,n))}}.bind(r)),i&&t.isLink()){var e=t.getSourceCell();e&&e.isLink()&&(l[e.id]||(u.push(e),h(r,e)))}}if(a&&c(this,t),s&&h(this,t),o.deep){var e=t.getEmbeddedCells({deep:!0}),f={};e.forEach(function(t){t.isElement()&&(f[t.id]=!0)}),e.forEach(function(t){t.isLink()||(a&&Zt(this.getOutboundEdges(t.id),function(t,e){if(!l[e]){var n=this.getCell(e),r=n.source().id,i=n.target().id;if(!o.includeEnclosed&&r&&f[r]&&i&&f[i])return;u.push(this.getCell(e)),l[e]=!0}}.bind(this)),s&&Zt(this.getInboundEdges(t.id),function(t,e){if(!l[e]){var n=this.getCell(e),r=n.source().id,i=n.target().id;if(!o.includeEnclosed&&r&&f[r]&&i&&f[i])return;u.push(this.getCell(e)),l[e]=!0}}.bind(this)))},this)}return u},getNeighbors:function(a,u){var l=(u=u||{}).inbound,c=u.outbound;void 0===l&&void 0===c&&(l=c=!0);var t=this.getConnectedLinks(a,u).reduce(function(t,e){var n=e.source(),r=e.target(),i=e.hasLoop(u);if(l&&Gt(n,"id")&&!t[n.id]){var o=this.getCell(n.id);o.isElement()&&(!i&&(!o||o===a||u.deep&&o.isEmbeddedIn(a))||(t[n.id]=o))}if(c&&Gt(r,"id")&&!t[r.id]){var s=this.getCell(r.id);s.isElement()&&(!i&&(!s||s===a||u.deep&&s.isEmbeddedIn(a))||(t[r.id]=s))}return t}.bind(this),{});if(a.isLink()){if(l){var e=a.getSourceCell();e&&e.isElement()&&!t[e.id]&&(t[e.id]=e)}if(c){var n=a.getTargetCell();n&&n.isElement()&&!t[n.id]&&(t[n.id]=n)}}return Ft(t)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(t){for(var e=[],n=t.get("parent");n;)e.push(n),n=this.getCell(n).get("parent");return e},this);t=t.sort(function(t,e){return t.length-e.length});var e=Ft(t.shift()).find(function(e){return t.every(function(t){return t.includes(e)})});return this.getCell(e)},getSuccessors:function(e,t){t=t||{};var n=[];return this.search(e,function(t){t!==e&&n.push(t)},kt({},t,{outbound:!0})),n},cloneCells:se,cloneSubgraph:function(t,e){var n=this.getSubgraph(t,e);return this.cloneCells(n)},getSubgraph:function(t,n){n=n||{};var o=[],s={},a=[],r=[];return Ft(t).forEach(function(t){if(s[t.id]||(o.push(t),(s[t.id]=t).isLink()?r.push(t):a.push(t)),n.deep){var e=t.getEmbeddedCells({deep:!0});e.forEach(function(t){s[t.id]||(o.push(t),(s[t.id]=t).isLink()?r.push(t):a.push(t))})}}),r.forEach(function(t){var e=t.source(),n=t.target();if(e.id&&!s[e.id]){var r=this.getCell(e.id);o.push(r),s[r.id]=r,a.push(r)}if(n.id&&!s[n.id]){var i=this.getCell(n.id);o.push(this.getCell(n.id)),s[i.id]=i,a.push(i)}},this),a.forEach(function(t){var e=this.getConnectedLinks(t,n);e.forEach(function(t){var e=t.source(),n=t.target();!s[t.id]&&e.id&&s[e.id]&&n.id&&s[n.id]&&(o.push(t),s[t.id]=t)})},this),o},getPredecessors:function(e,t){t=t||{};var n=[];return this.search(e,function(t){t!==e&&n.push(t)},kt({},t,{inbound:!0})),n},search:function(t,e,n){(n=n||{}).breadthFirst?this.bfs(t,e,n):this.dfs(t,e,n)},bfs:function(t,e,n){n=n||{};var r={},i={},o=[];for(o.push(t),i[t.id]=0;0<o.length;){var s=o.shift();if(!r[s.id]){if(!(r[s.id]=!0)===e(s,i[s.id]))return;this.getNeighbors(s,n).forEach(function(t){i[t.id]=i[s.id]+1,o.push(t)})}}},dfs:function(t,e,n,r,i){n=n||{};var o=r||{},s=i||0;!1!==e(t,s)&&(o[t.id]=!0,this.getNeighbors(t,n).forEach(function(t){o[t.id]||this.dfs(t,e,n,o,s+1)},this))},getSources:function(){var n=[];return Zt(this._nodes,function(t,e){this._in[e]&&!Ot(this._in[e])||n.push(this.getCell(e))}.bind(this)),n},getSinks:function(){var n=[];return Zt(this._nodes,function(t,e){this._out[e]&&!Ot(this._out[e])||n.push(this.getCell(e))}.bind(this)),n},isSource:function(t){return!this._in[t.id]||Ot(this._in[t.id])},isSink:function(t){return!this._out[t.id]||Ot(this._out[t.id])},isSuccessor:function(e,n){var r=!1;return this.search(e,function(t){if(t===n&&t!==e)return!(r=!0)},{outbound:!0}),r},isPredecessor:function(e,n){var r=!1;return this.search(e,function(t){if(t===n&&t!==e)return!(r=!0)},{inbound:!0}),r},isNeighbor:function(t,r,e){var i=(e=e||{}).inbound,o=e.outbound;void 0===i&&void 0===o&&(i=o=!0);var s=!1;return this.getConnectedLinks(t,e).forEach(function(t){var e=t.source(),n=t.target();return i&&Gt(e,"id")&&e.id===r.id?!(s=!0):o&&Gt(n,"id")&&n.id===r.id?!(s=!0):void 0}),s},disconnectLinks:function(e,n){this.getConnectedLinks(e).forEach(function(t){t.set(t.source().id===e.id?"source":"target",{x:0,y:0},n)})},removeLinks:function(t,e){Ct(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(e){return this.getElements().filter(function(t){return t.getBBox().containsPoint(e)})},findModelsInArea:function(e,t){e=g(e);var n=(t=Pt(t||{},{strict:!1})).strict?"containsRect":"intersect";return this.getElements().filter(function(t){return e[n](t.getBBox())})},findModelsUnderElement:function(e,t){t=Pt(t||{},{searchBy:"bbox"});var n=e.getBBox(),r="bbox"===t.searchBy?this.findModelsInArea(n):this.findModelsFromPoint(n[t.searchBy]());return r.filter(function(t){return e.id!==t.id&&!t.isEmbeddedIn(e)})},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,i){return i=i||{},Ft(t).reduce(function(t,e){var n=e.getBBox(i);if(!n)return t;var r=e.angle();return r&&(n=n.bbox(r)),t?t.union(n):n},null)},translate:function(t,e,n){var r=this.getCells().filter(function(t){return!t.isEmbedded()});return Ct(r,"translate",t,e,n),this},resize:function(t,e,n){return this.resizeCells(t,e,this.getCells(),n)},resizeCells:function(t,e,n,r){var i=this.getCellsBBox(n);if(i){var o=Math.max(t/i.width,0),s=Math.max(e/i.height,0);Ct(n,"scale",o,s,i.origin(),r)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",kt({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",kt({},e,{batchName:t}))},hasActiveBatch:function(t){var e=this._batches;return(0===arguments.length?Ft(e):Array.isArray(t)?t:[t]).some(function(t){return 0<e[t]})}},{validations:{multiLinks:function(t,e){var r=e.source(),i=e.target();if(r.id&&i.id){var n=e.getSourceCell();if(n){var o=t.getConnectedLinks(n,{outbound:!0}),s=o.filter(function(t){var e=t.source(),n=t.target();return e&&e.id===r.id&&(!e.port||e.port===r.port)&&n&&n.id===i.id&&(!n.port||n.port===i.port)});if(1<s.length)return!1}}return!0},linkPinning:function(t,e){return e.source().id&&e.target().id}}});we(Kr.prototype,["resetCells","addCells","removeCells"],xe.cells);var Qr=ze.extend({className:function(){var t=ze.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:!1,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){ze.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._markerCache={},this._V={},this.metrics={}},presentationAttributes:{markup:["RENDER"],attrs:["UPDATE"],router:["UPDATE"],connector:["UPDATE"],smooth:["UPDATE"],manhattan:["UPDATE"],toolMarkup:["TOOLS"],labels:["LABELS"],labelMarkup:["LABELS"],vertices:["VERTICES","UPDATE"],vertexMarkup:["VERTICES"],source:["SOURCE","UPDATE"],target:["TARGET","UPDATE"]},initFlag:["RENDER","SOURCE","TARGET"],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e=e||{},this.hasFlag(t,"SOURCE")){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,"SOURCE")}if(this.hasFlag(t,"TARGET")){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,"TARGET")}var n=this.paper,r=this.sourceView,i=this.targetView;if(n&&(r&&!n.isViewMounted(r)||i&&!n.isViewMounted(i)))return t;if(this.hasFlag(t,"RENDER"))return this.render(),t=this.removeFlag(t,["RENDER","UPDATE","VERTICES","TOOLS","LABELS"]);this.hasFlag(t,"VERTICES")&&(this.renderVertexMarkers(),t=this.removeFlag(t,"VERTICES"));var o=this.model,s=o.attributes;return this.hasFlag(t,"UPDATE")?(this.update(o,null,e),t=this.removeFlag(t,["UPDATE","TOOLS","LABELS"])):(this.hasFlag(t,"TOOLS")&&(this.renderTools().updateToolsPosition(),t=this.removeFlag(t,"TOOLS")),this.hasFlag(t,"LABELS")&&(this.onLabelsChange(o,s.labels,e),t=this.removeFlag(t,"LABELS")),t)},onLabelsChange:function(t,e,n){var r=!0,i=this.model.previous("labels");if(i&&"propertyPathArray"in n&&"propertyValue"in n){var o=n.propertyPathArray||[],s=o.length;if(1<s){var a=!!i[o[1]];a&&(2===s?r="markup"in Object(n.propertyValue):"markup"!==o[2]&&(r=!1))}}r?this.renderLabels():this.updateLabels(),this.updateLabelPositions()},render:function(){return this.vel.empty(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if("string"==typeof e)return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=$(t);Array.isArray(e)||(e=[e]);for(var n=this._V,r=0,i=e.length;r<i;r++){var o=e[r],s=o.attr("class");s&&(s=Y(s),n[E.camelCase(s)]=o)}this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if("string"==typeof t)return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=$(t),n=document.createDocumentFragment();if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r].node;n.appendChild(o)}else n.appendChild(e.node);return{fragment:n,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e,n=t.fragment;if(!(t.fragment instanceof DocumentFragment&&t.fragment.hasChildNodes()))throw new Error("dia.LinkView: invalid label markup.");var r=n.childNodes;return(e=1<r.length||"G"!==r[0].nodeName.toUpperCase()?$("g").append(n):$(r[0])).addClass("label"),{node:e.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,n=this._labelCache={},r=this._labelSelectors={},i=this.model,o=i.attributes.labels||[],s=o.length;if(0===s)return e&&e.remove(),this;e?e.empty():e=t.labels=$("g").addClass("labels");for(var a=e.node,u=0;u<s;u++){var l,c,h=o[u],f=this._normalizeLabelMarkup(this._getLabelMarkup(h.markup));if(f)l=f.node,c=f.selectors;else{var d=i._builtins.defaultLabel,p=this._normalizeLabelMarkup(this._getLabelMarkup(d.markup)),g=i._getDefaultLabel(),v=this._normalizeLabelMarkup(this._getLabelMarkup(g.markup)),m=v||p;l=m.node,c=m.selectors}l.setAttribute("label-idx",u),a.appendChild(l),n[u]=l;var y=this.selector;if(c[y])throw new Error("dia.LinkView: ambiguous label root selector.");c[y]=l,r[u]=c}return a.parentNode||this.el.appendChild(a),this.updateLabels(),this},_mergeLabelAttrs:function(t,e,n,r){return null===e?null:void 0!==e?t?te({},n,e):te({},r,n,e):null===n?null:void 0!==n?t?n:te({},r,n):t?void 0:r},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],n=this.can("labelMove"),r=t._builtins.defaultLabel,i=r.attrs,o=t._getDefaultLabel(),s=o.markup,a=o.attrs,u=0,l=e.length;u<l;u++){var c=this._labelCache[u];c.setAttribute("cursor",n?"move":"default");var h=this._labelSelectors[u],f=e[u],d=f.markup,p=f.attrs,g=this._mergeLabelAttrs(d||s,p,a,i);this.updateDOMSubtreeAttributes(c,g,{rootBBox:new G(f.size),selectors:h})}return this},renderTools:function(){if(!this._V.linkTools)return this;var t,e=E(this._V.linkTools.node).empty(),n=wt(this.model.get("toolMarkup")||this.model.toolMarkup),r=$(n());e.append(r.node),this._toolCache=r,this.options.doubleLinkTools&&(t=this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup?(n=wt(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup),$(n())):r.clone(),e.append(t.node),this._tool2Cache=t);return this},renderVertexMarkers:function(){if(!this._V.markerVertices)return this;var n=E(this._V.markerVertices.node).empty(),r=wt(this.model.get("vertexMarkup")||this.model.vertexMarkup);return this.model.vertices().forEach(function(t,e){n.append($(r(kt({idx:e},t))).node)}),this},renderArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;var t=E(this._V.markerArrowheads.node);t.empty();var e=wt(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup);return this._V.sourceArrowhead=$(e({end:"source"})),this._V.targetArrowhead=$(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node),this},update:function(t,e,n){return n=n||{},this.cleanNodesCache(),this.updateConnection(n),this.updateDOMSubtreeAttributes(this.el,this.model.attr(),{selectors:this.selectors}),this.updateDefaultConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(n),this.options.perpendicular=null,this},removeRedundantLinearVertices:function(t){for(var e=this.model,n=e.vertices(),r=[],i=n.length,o=0,s=0;s<i;s++){var a=new S(n[s]).round(),u=new S(r[o-1]||this.sourceAnchor).round();if(!u.equals(a)){var l=new S(n[s+1]||this.targetAnchor).round();if(!u.equals(l)){var c=new A(u,l);0!==c.pointOffset(a)&&(r.push(n[s]),o++)}}}return i===o?0:(e.vertices(r,t),i-o)},updateDefaultConnectionPath:function(){var t=this._V;t.connection&&t.connection.attr("d",this.getSerializedConnection()),t.connectionWrap&&t.connectionWrap.attr("d",this.getSerializedConnection()),t.markerSource&&t.markerTarget&&this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new S(this.sourceAnchor);case"target":return new S(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var n=this.targetView;if(!n)break;return this.targetMagnet||n.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},updateConnection:function(t){t=t||{};var e,n,r=this.model;if(t.translateBy&&r.isRelationshipEmbeddedIn(t.translateBy)){var i=t.tx||0,o=t.ty||0;e=new T(this.route).translate(i,o).points,this._translateConnectionPoints(i,o),(n=this.path).translate(i,o)}else{var s=r.vertices(),a=this.findAnchors(s),u=this.sourceAnchor=a.source,l=this.targetAnchor=a.target;e=this.findRoute(s,t);var c=this.findConnectionPoints(e,u,l),h=this.sourcePoint=c.source,f=this.targetPoint=c.target,d=this.findMarkerPoints(e,h,f);n=this.findPath(e,d.source||h,d.target||f)}this.route=e,this.path=n,this.metrics={}},findMarkerPoints:function(t,e,n){var r,i,o=t[0],s=t[t.length-1],a=this._markerCache;return this._V.markerSource&&(a.sourceBBox=a.sourceBBox||this._V.markerSource.getBBox(),r=S(e).move(o||n,a.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(a.targetBBox=a.targetBBox||this._V.markerTarget.getBBox(),i=S(n).move(s||e,a.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),a.sourcePoint=r||e.clone(),a.targetPoint=i||n.clone(),{source:r,target:i}},findAnchorsOrdered:function(t,e,n,r){var i,o,s,a,u=this.model,l=u.get(t),c=u.get(n),h=this.getEndView(t),f=this.getEndView(n),d=this.getEndMagnet(t),p=this.getEndMagnet(n);i=h?(s=e?new S(e):f?p:new S(c),this.getAnchor(l.anchor,h,d,s,t)):new S(l),o=f?(a=new S(r||i),this.getAnchor(c.anchor,f,p,a,n)):new S(c);var g={};return g[t]=i,g[n]=o,g},findAnchors:function(t){var e=this.model,n=t[0],r=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",r,"source",n):this.findAnchorsOrdered("source",n,"target",r)},findConnectionPoints:function(t,e,n){var r,i,o,s,a=t[0],u=t[t.length-1],l=this.model,c=l.get("source"),h=l.get("target"),f=this.sourceView,d=this.targetView,p=this.paper.options;if(f&&!f.isNodeConnection(this.sourceMagnet)){r=this.sourceMagnet||f.el;var g=c.connectionPoint||p.defaultConnectionPoint,v=a||n,m=new A(v,e);o=this.getConnectionPoint(g,f,r,m,"source")}else o=e;if(d&&!d.isNodeConnection(this.targetMagnet)){i=this.targetMagnet||d.el;var y=h.connectionPoint||p.defaultConnectionPoint,b=u||e,w=new A(b,n);s=this.getConnectionPoint(y,d,i,w,"target")}else s=n;return{source:o,target:s}},getAnchor:function(t,e,n,r,i){var o,s=e.isNodeConnection(n),a=this.paper.options;if(!(t=t||(s?a.defaultLinkAnchor:a.perpendicularLinks||this.options.perpendicular?{name:"perpendicular"}:a.defaultAnchor)))throw new Error("Anchor required.");if("function"==typeof t)o=t;else{var u=t.name,l=s?"linkAnchorNamespace":"anchorNamespace";if("function"!=typeof(o=a[l][u]))throw new Error("Unknown anchor: "+u)}var c=o.call(this,e,n,r,t.args||{},i,this);return c?c.round(this.decimalsRounding):new S},getConnectionPoint:function(t,e,n,r,i){var o,s,a=r.end,u=this.paper.options;if("function"==typeof u.linkConnectionPoint){var l=n===e.el?void 0:n;if(o=u.linkConnectionPoint(this,e,l,r.start,i))return o}if(!t)return a;if("function"==typeof t)s=t;else{var c=t.name;if("function"!=typeof(s=u.connectionPointNamespace[c]))throw new Error("Unknown connection point: "+c)}return(o=s.call(this,r,e,n,t.args||{},i,this))?o.round(this.decimalsRounding):a},_translateConnectionPoints:function(t,e){var n=this._markerCache;n.sourcePoint.offset(t,e),n.targetPoint.offset(t,e),this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e)},_normalizeLabelPosition:function(t){return"number"==typeof t?{distance:t,offset:null,angle:0,args:null}:t},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.path;if(!t)return this;var e=this.model,n=e.get("labels")||[];if(!n.length)return this;for(var r=e._builtins.defaultLabel,i=r.position,o=e._getDefaultLabel(),s=this._normalizeLabelPosition(o.position),a=te({},i,s),u=0,l=n.length;u<l;u++){var c=n[u],h=this._normalizeLabelPosition(c.position),f=te({},a,h),d=this._getLabelTransformationMatrix(f);this._labelCache[u].setAttribute("transform",$.matrixToTransformString(d))}return this},updateToolsPosition:function(){if(!this._V.linkTools)return this;var t="",e=this.options.linkToolsOffset,n=this.getConnectionLength();if(!Number.isNaN(n)){n<this.options.shortLinkLength&&(t="scale(.5)",e/=2);var r=this.getPointAtLength(e);if(this._toolCache.attr("transform","translate("+r.x+", "+r.y+") "+t),this.options.doubleLinkTools&&n>=this.options.longLinkLength){var i=this.options.doubleLinkToolsOffset||e;r=this.getPointAtLength(n-i),this._tool2Cache.attr("transform","translate("+r.x+", "+r.y+") "+t),this._tool2Cache.attr("visibility","visible")}else this.options.doubleLinkTools&&this._tool2Cache.attr("visibility","hidden")}return this},updateArrowheadMarkers:function(){if(!this._V.markerArrowheads)return this;if("none"===E.css(this._V.markerArrowheads.node,"display"))return this;var t=this.getConnectionLength()<this.options.shortLinkLength?.5:1;return this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead),this},updateEndProperties:function(t){var e=this.model,n=this.paper,r=t+"View",i=e.get(t),o=i&&i.id;if(!o)return this[r]=null,this.updateEndMagnet(t),!0;var s=n.getModelById(o);if(!s)throw new Error("LinkView: invalid "+t+" cell.");var a=s.findView(n);return!!a&&(this[r]=a,this.updateEndMagnet(t),!0)},updateEndMagnet:function(t){var e=t+"Magnet",n=this.getEndView(t);if(n){var r=n.getMagnetFromLinkEnd(this.model.get(t));r===n.el&&(r=null),this[e]=r}else this[e]=null},_translateAndAutoOrientArrows:function(t,e){var n=Ft(this.route);t&&t.translateAndAutoOrient(this.sourcePoint,n[0]||this.targetPoint,this.paper.cells),e&&e.translateAndAutoOrient(this.targetPoint,n[n.length-1]||this.sourcePoint,this.paper.cells)},_getLabelPositionAngle:function(t){var e=this.model.label(t).position||{};return e.angle||0},_getLabelPositionArgs:function(t){var e=this.model.label(t).position||{};return e.args},_getDefaultLabelPositionArgs:function(){var t=this.model._getDefaultLabel(),e=t.position||{};return e.args},_mergeLabelPositionArgs:function(t,e){return null===t?null:void 0===t?null===e?null:e:te({},e,t)},addLabel:function(t,e,n,r){var i,o,s,a=0;s="number"!=typeof t?(i=t.x,o=t.y,"number"==typeof e?(a=e,n):e):(i=t,o=e,"number"==typeof n?(a=n,r):n);var u=this._getDefaultLabelPositionArgs(),l=s,c=this._mergeLabelPositionArgs(l,u),h={position:this.getLabelPosition(i,o,a,c)};return this.model.insertLabel(-1,h,s),-1},addVertex:function(t,e,n){var r="number"!=typeof t,i=r?t.x:t,o=r?t.y:e,s=r?e:n,a={x:i,y:o},u=this.getVertexIndex(i,o);return this.model.insertVertex(u,a,s),u},sendToken:function(t,e,n){var r,i,o;o=ne(e)?(r=e.duration,i="reverse"===e.direction,e.connection):(r=e,i=!1,null);var s={dur:(r=r||1e3)+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};i&&(s.keyPoints="1;0",s.keyTimes="0;1");var a,u=$(t);if("string"==typeof o)a=this.findBySelector(o,this.el,this.selectors)[0];else{var l=this._V;a=l.connection?l.connection.node:this.el.querySelector("path")}if(!(a instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");u.appendTo(this.paper.cells).animateAlongPath(s,a),setTimeout(function(t,e){return function(){t.remove(),"function"==typeof e&&e()}}(u,n),r)},findRoute:function(t){t=t||[];var e=Mr,n=this.model.router(),r=this.paper.options.defaultRouter;if(!n){if(!r)return t.map(S);n=r}var i=Dt(n)?n:e[n.name];if(!Dt(i))throw new Error('dia.LinkView: unknown router: "'+n.name+'".');var o=n.args||{},s=i.call(this,t,o,this);return s||t.map(S)},findPath:function(t,e,n){var r=Ln,i=this.model.connector(),o=this.paper.options.defaultConnector,s=Dt(i=i||(o||{}))?i:r[i.name];if(!Dt(s))throw new Error('dia.LinkView: unknown connector: "'+i.name+'".');var a=Lt(i.args||{});a.raw=!0;var u=s.call(this,e,n,t,a,this);return"string"==typeof u&&(u=new C($.normalizePathData(u))),u},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var n=t.serialize();return e.data=n},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var n=t.getSegmentSubdivisions();return e.segmentSubdivisions=n},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var n=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=n},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(ut(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,n,r){var i,o={},s=0;(i="number"==typeof n?(s=n,r):n)&&(o.args=i);var a,u,l=!(i&&i.absoluteDistance),c=i&&i.absoluteDistance&&i.reverseDistance,h=i&&i.absoluteOffset,f=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},p=new S(t,e),g=f.closestPointT(p,d),v=f.lengthAtT(g,d);if(l&&(v=v/this.getConnectionLength()||0),c&&(v=-1*(this.getConnectionLength()-v)||1),o.distance=v,h||(a=f.tangentAtT(g)),a)u=a.pointOffset(p);else{var m=f.pointAtT(g),y=p.difference(m);u={x:y.x,y:y.y}}return o.offset=u,o.angle=s,o},_getLabelTransformationMatrix:function(t){var e,n=0,r={};if("number"==typeof t)e=t;else{if("number"!=typeof t.distance)throw new Error("dia.LinkView: invalid label position distance.");r=t.args||{},e=t.distance,n=t.angle||0}var i=0<e&&e<=1,o=0,s={x:0,y:0};if(t.offset){var a=t.offset;"number"==typeof a&&(o=a),a.x&&(s.x=a.x),a.y&&(s.y=a.y)}var u,l=0!==s.x||0!==s.y||0===o,c=r.keepGradient,h=r.ensureLegibility,f=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},p=i?e*this.getConnectionLength():e,g=f.tangentAtLength(p,d),v=n;if(g){if(l)(u=g.start).offset(s);else{var m=g.clone();m.rotate(g.start,-90),m.setLength(o),u=m.end}c&&(v=g.angle()+n,h&&(v=w((v+90)%180-90)))}else u=f.start,l&&u.offset(s);return $.createSVGMatrix().translate(u.x,u.y).rotate(v)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new S(e.e,e.f)},getVertexIndex:function(t,e){for(var n=this.model,r=n.vertices(),i=this.getClosestPointLength(new S(t,e)),o=0,s=r.length;o<s;o++){var a=r[o],u=this.getClosestPointLength(a);if(i<u)break}return o},notifyPointerdown:function(t,e,n){ze.prototype.pointerdown.call(this,t,e,n),this.notify("link:pointerdown",t,e,n)},notifyPointermove:function(t,e,n){ze.prototype.pointermove.call(this,t,e,n),this.notify("link:pointermove",t,e,n)},notifyPointerup:function(t,e,n){this.notify("link:pointerup",t,e,n),ze.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){ze.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){ze.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,n)},contextmenu:function(t,e,n){ze.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n);var r=t.target.getAttribute("class");switch(r){case"marker-vertex":return void this.dragVertexStart(t,e,n);case"marker-vertex-remove":case"marker-vertex-remove-area":return void this.dragVertexRemoveStart(t,e,n);case"marker-arrowhead":return void this.dragArrowheadStart(t,e,n);case"connection":case"connection-wrap":return void this.dragConnectionStart(t,e,n);case"marker-source":case"marker-target":return}this.dragStart(t,e,n)},pointermove:function(t,e,n){var r=this._dragData;r&&this.eventData(t,r);var i=this.eventData(t);switch(i.action){case"vertex-move":this.dragVertex(t,e,n);break;case"label-move":this.dragLabel(t,e,n);break;case"arrowhead-move":this.dragArrowhead(t,e,n);break;case"move":this.drag(t,e,n)}r&&kt(r,this.eventData(t)),this.notifyPointermove(t,e,n)},pointerup:function(t,e,n){var r=this._dragData;r&&(this.eventData(t,r),this._dragData=null);var i=this.eventData(t);switch(i.action){case"vertex-move":this.dragVertexEnd(t,e,n);break;case"label-move":this.dragLabelEnd(t,e,n);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,n);break;case"move":this.dragEnd(t,e,n)}this.notifyPointerup(t,e,n),this.checkMouseleave(t)},mouseover:function(t){ze.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){ze.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){ze.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){ze.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,n,r){ze.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,n,r)},onevent:function(t,e,n,r){var i=$(t.target).findParentByClass("link-tool",this.el);if(i){if(t.stopPropagation(),this.can("useLinkTools")){if("remove"===e)return void this.model.remove({ui:!0});this.notify(e,t,n,r)}this.notifyPointerdown(t,n,r)}else ze.prototype.onevent.apply(this,arguments)},onlabel:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragLabelStart(t,e,n);var r=this.eventData(t).stopPropagation;r&&t.stopPropagation()},dragConnectionStart:function(t,e,n){if(this.can("vertexAdd")){var r=this.addVertex({x:e,y:n},{ui:!0});this.eventData(t,{action:"vertex-move",vertexIdx:r})}},dragLabelStart:function(t,e,n){if(this.can("labelMove")){var r=t.currentTarget,i=parseInt(r.getAttribute("label-idx"),10),o=this._getLabelPositionAngle(i),s=this._getLabelPositionArgs(i),a=this._getDefaultLabelPositionArgs(),u=this._mergeLabelPositionArgs(s,a);this.eventData(t,{action:"label-move",labelIdx:i,positionAngle:o,positionArgs:u,stopPropagation:!0}),this.paper.delegateDragEvents(this,t.data)}else this.eventData(t,{stopPropagation:!0})},dragVertexStart:function(t,e,n){if(this.can("vertexMove")){var r=t.target,i=parseInt(r.getAttribute("idx"),10);this.eventData(t,{action:"vertex-move",vertexIdx:i})}},dragVertexRemoveStart:function(t,e,n){if(this.can("vertexRemove")){var r=t.target,i=parseInt(r.getAttribute("idx"),10);this.model.removeVertex(i)}},dragArrowheadStart:function(t,e,n){if(this.can("arrowheadMove")){var r=t.target,i=r.getAttribute("end"),o=this.startArrowheadMove(i,{ignoreBackwardsCompatibility:!0});this.eventData(t,o)}},dragStart:function(t,e,n){this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:n})},dragLabel:function(t,e,n){var r=this.eventData(t),i={position:this.getLabelPosition(e,n,r.positionAngle,r.positionArgs)};this.model.label(r.labelIdx,i)},dragVertex:function(t,e,n){var r=this.eventData(t);this.model.vertex(r.vertexIdx,{x:e,y:n},{ui:!0})},dragArrowhead:function(t,e,n){var r=this.eventData(t);this.paper.options.snapLinks?this._snapArrowhead(e,n,r):this._connectArrowhead(this.getEventTarget(t),e,n,r)},drag:function(t,e,n){var r=this.eventData(t);this.model.translate(e-r.dx,n-r.dy,{ui:!0}),this.eventData(t,{dx:e,dy:n})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,n){var r=this.eventData(t),i=this.paper;i.options.snapLinks?this._snapArrowheadEnd(r):this._connectArrowheadEnd(r,e,n),i.linkAllowed(this)?(this._finishEmbedding(r),this._notifyConnectEvent(r,t)):this._disallow(r),this._afterArrowheadMove(r)},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:!0});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:!0})}},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var n=t.arrowhead,r=t.initialEnd,i=this.model.prop(n),o=i&&!sn.endsEqual(r,i);if(o){var s=this.paper;r.id&&this.notify("link:disconnect",e,s.findViewByModel(r.id),t.initialMagnet,n),i.id&&this.notify("link:connect",e,s.findViewByModel(i.id),t.magnetUnderPointer,n)}},_snapArrowhead:function(t,e,i){var o,s=this.paper.options.snapLinks.radius||50,n=this.paper.findViewsInArea({x:t-s,y:e-s,width:2*s,height:2*s}),r=i.closestView||null,a=i.closestMagnet||null;i.closestView=i.closestMagnet=null;var u,l=Number.MAX_VALUE,c=S(t,e),h=this.paper;n.forEach(function(r){"false"!==r.el.getAttribute("magnet")&&(o=r.model.getBBox().center().distance(c))<s&&o<l&&(a!==r.el&&!h.options.validateConnection.apply(h,i.validateConnectionArgs(r,null))||(l=o,i.closestView=r,i.closestMagnet=r.el)),r.$("[magnet]").each(function(t,e){var n=r.getNodeBBox(e);(o=c.distance({x:n.x+n.width/2,y:n.y+n.height/2}))<s&&o<l&&(a!==e&&!h.options.validateConnection.apply(h,i.validateConnectionArgs(r,e))||(l=o,i.closestView=r,i.closestMagnet=e))}.bind(this))},this);var f=i.closestView,d=i.closestMagnet,p=i.arrowhead,g=a!==d;if(r&&g&&r.unhighlight(a,{connecting:!0,snapping:!0}),f){if(!g)return;f.highlight(d,{connecting:!0,snapping:!0}),u=f.getLinkEnd(d,t,e,this.model,p)}else u={x:t,y:e};this.model.set(p,u||{x:t,y:e},{ui:!0})},_snapArrowheadEnd:function(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(n,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(n)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,n,r){r.eventTarget!==t&&(r.magnetUnderPointer&&r.viewUnderPointer.unhighlight(r.magnetUnderPointer,{connecting:!0}),r.viewUnderPointer=this.paper.findView(t),r.viewUnderPointer?(r.magnetUnderPointer=r.viewUnderPointer.findMagnet(t),r.magnetUnderPointer&&this.paper.options.validateConnection.apply(this.paper,r.validateConnectionArgs(r.viewUnderPointer,r.magnetUnderPointer))?r.magnetUnderPointer&&r.viewUnderPointer.highlight(r.magnetUnderPointer,{connecting:!0}):r.magnetUnderPointer=null):r.magnetUnderPointer=null),r.eventTarget=t,this.model.set(r.arrowhead,{x:e,y:n},{ui:!0})},_connectArrowheadEnd:function(t,e,n){var r=t.viewUnderPointer,i=t.magnetUnderPointer;if(i&&r){r.unhighlight(i,{connecting:!0});var o=t.arrowhead,s=r.getLinkEnd(i,e,n,this.model,o);this.model.set(o,s,{ui:!0})}},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){null!==t.z&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e,n=[];n[4]=t,n[5]=this;var r=0,i=0;e="source"===t?(r=2,"target"):(i=2,"source");var o=this.model.get(e);if(o.id){var s=n[r]=this.paper.findViewByModel(o.id),a=s.getMagnetFromLinkEnd(o);a===s.el&&(a=void 0),n[r+1]=a}return function(t,e){return n[i]=t,n[i+1]=t.el===e?void 0:e,n}},_markAvailableMagnets:function(t){function e(t,e){var n=t.paper,r=n.options.validateConnection;return r.apply(n,this.validateConnectionArgs(t,e))}var n=this.paper,r=n.model.getCells();t.marked={};for(var i=0,o=r.length;i<o;i++){var s=r[i].findView(n);if(s){var a=Array.prototype.slice.call(s.el.querySelectorAll("[magnet]"));"false"!==s.el.getAttribute("magnet")&&a.push(s.el);var u=a.filter(e.bind(t,s));if(0<u.length){for(var l=0,c=u.length;l<c;l++)s.highlight(u[l],{magnetAvailability:!0});s.highlight(null,{elementAvailability:!0}),t.marked[s.model.id]=u}}}},_unmarkAvailableMagnets:function(t){for(var e,n,r=Object.keys(t.marked),i=0,o=r.length;i<o;i++){e=r[i],n=t.marked[e];var s=this.paper.findViewByModel(e);if(s){for(var a=0,u=n.length;a<u;a++)s.unhighlight(n[a],{magnetAvailability:!0});s.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){var n={action:"arrowhead-move",arrowhead:t,whenNotAllowed:(e=e||{}).whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:Lt(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(n),!0!==e.ignoreBackwardsCompatibility&&(this._dragData=n),n}});Object.defineProperty(Qr.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new G(e.x,e.y)}var n=this.sourceMagnet;return t.isNodeConnection(n)?new G(this.sourceAnchor):t.getNodeBBox(n||t.el)}}),Object.defineProperty(Qr.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new G(e.x,e.y)}var n=this.targetMagnet;return t.isNodeConnection(n)?new G(this.targetAnchor):t.getNodeBBox(n||t.el)}});var ti={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},ei=1<<30,ni=1<<29,ri=1/0,ii=Ve.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:!1,background:!1,perpendicularLinks:!1,elementView:qe,linkView:Qr,snapLinks:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:{default:{name:"stroke",options:{padding:3}},magnetAvailability:{name:"addClass",options:{className:"available-magnet"}},elementAvailability:{name:"addClass",options:{className:"available-cell"}}},preventContextMenu:!0,preventDefaultBlankAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:new sn,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e){return"passive"!==e.getAttribute("magnet")},validateConnection:function(t,e,n,r,i,o){return("target"===i?n:t)instanceof qe},embeddingMode:!1,validateEmbedding:function(t,e){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:ti.EXACT,frozen:!1,onViewUpdate:function(t,e,n,r){e&ei||n.mounting||r.requestConnectedLinksUpdate(t,n)},onViewPostponed:function(t,e){return this.forcePostponedViewUpdate(t,e)},viewport:null,cellViewNamespace:null,highlighterNamespace:Dn,anchorNamespace:Jr,linkAnchorNamespace:Fr,connectionPointNamespace:qn},events:{dblclick:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousewheel:"mousewheel",DOMMouseScroll:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","mousedown .joint-cell [event]":"onevent","touchstart .joint-cell [event]":"onevent","mousedown .joint-cell [magnet]":"onmagnet","touchstart .joint-cell [magnet]":"onmagnet","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,_highlights:null,_zPivots:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],MIN_SCALE:1e-6,init:function(){var t=this.options,e=this.el;t.cellViewNamespace||(t.cellViewNamespace="undefined"!=typeof joint&&Gt(joint,"shapes")?joint.shapes:null);var n=this.model=t.model||new Kr;this.setGrid(t.drawGrid),this.cloneOptions(),this.render(),this.setDimensions(),this.startListening(),this._views={},this._zPivots={},this.$document=E(e.ownerDocument),this._highlights={},this.resetViews(n.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update)},onCellAdded:function(t,e,n){var r=n.position;this.isAsync()||!re(r)?this.renderView(t,n):(n.maxPosition===r&&this.freeze({key:"addCells"}),this.renderView(t,n),0===r&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,n){var r=this.findViewByModel(t);r&&this.requestViewUpdate(r,ni,r.UPDATE_PRIORITY,n)},onCellChange:function(t,e){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===ti.APPROX){var n=this.findViewByModel(t);n&&this.requestViewUpdate(n,ei,n.UPDATE_PRIORITY,e)}},onGraphReset:function(t,e){this.removeZPivots(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,n=this.model;if(!this.isAsync()){var r=this.UPDATE_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.updateViews(t)}var i=this.SORT_DELAYING_BATCHES;i.includes(e)&&!n.hasActiveBatch(i)&&this.sortViews()}},cloneOptions:function(){var t=this.options;t.origin=kt({},t.origin),t.defaultConnector=kt({},t.defaultConnector),t.highlighting=Et({},t.highlighting,this.constructor.prototype.options.highlighting),!t.cellViewNamespace&&"undefined"!=typeof joint&&Gt(joint,"shapes")&&(t.cellViewNamespace=joint.shapes)},children:function(){var t=$.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:X("paper-background"),selector:"background"},{namespaceURI:t.xhtml,tagName:"div",className:X("paper-grid"),selector:"grid"},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:X("layers"),selector:"layers",children:[{tagName:"g",className:X("cells-layer viewport"),selector:"cells"},{tagName:"g",className:X("tools-layer"),selector:"tools"}]}]}]},render:function(){this.renderChildren();var t=this.childNodes,e=this.options,n=t.svg,r=t.cells,i=t.defs,o=t.tools,s=t.layers,a=t.background,u=t.grid;return this.svg=n,this.defs=i,this.tools=o,this.cells=r,this.layers=s,this.$background=E(a),this.$grid=E(u),$.ensureId(n),this.viewport=r,e.background&&this.drawBackground(e.background),e.drawGrid&&this.drawGrid(),this},update:function(){return this.options.drawGrid&&this.drawGrid(),this._background&&this.updateBackgroundImage(this._background),this},matrix:function(t){var e=this.layers;if(void 0===t){var n=e.getAttribute("transform");return(this._viewportTransformString||null)===n?t=this._viewportMatrix:(t=e.getCTM(),this._viewportMatrix=t,this._viewportTransformString=n),$.createSVGMatrix(t)}t=$.createSVGMatrix(t);var r=$.matrixToTransformString(t);return e.setAttribute("transform",r),this._viewportMatrix=t,this._viewportTransformString=e.getAttribute("transform"),this},clientMatrix:function(){return $.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e){if(t instanceof ze)for(var n=t.model,r=this.model.getConnectedLinks(n),i=0,o=r.length;i<o;i++){var s=r[i],a=this.findViewByModel(s);if(a){var u=["UPDATE"];s.getTargetCell()===n&&u.push("TARGET"),s.getSourceCell()===n&&u.push("SOURCE"),this.scheduleViewUpdate(a,a.getFlag(u),a.UPDATE_PRIORITY,e)}}},forcePostponedViewUpdate:function(t,e){if(!(t&&t instanceof ze))return!1;var n=t.model;if(n.isElement())return!1;if(0==(e&t.getFlag(["SOURCE","TARGET"]))){var r=0,i=this.findViewByModel(n.getSourceCell());i&&!this.isViewMounted(i)&&(r=this.dumpView(i),t.updateEndMagnet("source"));var o=0,s=this.findViewByModel(n.getTargetCell());if(s&&!this.isViewMounted(s)&&(o=this.dumpView(s),t.updateEndMagnet("target")),0===r&&0===o)return!!this.dumpView(t)}return!1},requestViewUpdate:function(t,e,n,r){r=r||{},this.scheduleViewUpdate(t,e,n,r);var i=this.isAsync();if(!(this.isFrozen()||i&&!1!==r.async||this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES))){var o=this.updateViews(r);i&&this.trigger("render:done",o,r)}},scheduleViewUpdate:function(t,e,n,r){var i=this._updates,o=i.priorities[n],s=(o=o||(i.priorities[n]={}))[t.cid]||0;if((s&e)!==e){s||i.count++,e&ni&&s&ei?o[t.cid]^=ei:e&ei&&s&ni&&(o[t.cid]^=ni),o[t.cid]|=e;var a=this.options.onViewUpdate;"function"==typeof a&&a.call(this,t,e,r||{},this)}},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,n=t.cid,r=e.priorities[t.UPDATE_PRIORITY],i=this.registerMountedView(t)|r[n];return delete r[n],i},dumpView:function(t,e){var n=this.dumpViewUpdate(t);return n?this.updateView(t,n,e):0},updateView:function(t,e,n){if(!t)return 0;if(t instanceof ze){if(e&ni)return this.removeView(t.model),0;e&ei&&(this.insertView(t),e^=ei)}return e?t.confirmUpdate(e,n||{}):0},requireView:function(t,e){var n=this.findViewByModel(t);return n?(this.dumpView(n,e),n):null},registerUnmountedView:function(t){var e=t.cid,n=this._updates;if(e in n.unmounted)return 0;var r=n.unmounted[e]|=ei;return n.unmountedCids.push(e),delete n.mounted[e],r},registerMountedView:function(t){var e=t.cid,n=this._updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);var r=n.unmounted[e]||0;return delete n.unmounted[e],r},isViewMounted:function(t){if(!t)return!1;var e=t.cid,n=this._updates;return e in n.mounted},dumpViews:function(t){var e=Pt({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){for(var e,n=0,r=0,i=2;r++,e=this.updateViewsBatch(t),n+=e.updated,i=Math.min(e.priority,i),!e.empty;);return{updated:n,batches:r,priority:i}},updateViewsAsync:function(t,e){t=t||{},e=e||{processed:0,priority:2};var n=this._updates,r=n.id;if(r){at(r);var i=this.updateViewsBatch(t),o=Pt({},t,{mountBatchSize:1e3-i.mounted,unmountBatchSize:1e3-i.unmounted}),s=this.checkViewport(o),a=s.unmounted,u=s.mounted,l=e.processed,c=n.count;0<i.updated&&(l+=i.updated+i.unmounted,i.processed=l,e.priority=Math.min(i.priority,e.priority),i.empty&&0===u?(i.unmounted+=a,i.mounted+=u,i.priority=e.priority,this.trigger("render:done",i,t),e.processed=0,n.count=0):e.processed=l);var h=t.progress;if(c&&"function"==typeof h&&h.call(this,i.empty,l,c,i,this),n.id!==r)return}n.id=st(this.updateViewsAsync,this,t,e)},updateViewsBatch:function(t){var e=(t=t||{}).batchSize||ri,n=this._updates,r=0,i=0,o=0,s=0,a=2,u=!0,l=this.options,c=n.priorities,h="viewport"in t?t.viewport:l.viewport;"function"!=typeof h&&(h=null);var f=l.onViewPostponed;"function"!=typeof f&&(f=null);t:for(var d=0,p=c.length;d<p;d++){var g=c[d];for(var v in g){if(e<=r){u=!1;break t}var m=Be[v];if(m){var y=g[v],b=v in n.unmounted;if(!h||h.call(this,m,b,this)){b&&(y|=ei,s++),y|=this.registerMountedView(m);var w=this.updateView(m,y,t);0<w&&(g[v]=w,!f||!f.call(this,m,w,this)||g[v])?(i++,u=!1):(d<a&&(a=d),r++,delete g[v])}else b||(this.registerUnmountedView(m),m.unmount()),n.unmounted[v]|=y,delete g[v],o++}else delete g[v]}}return{priority:a,updated:r,postponed:i,unmounted:o,mounted:s,empty:u}},checkUnmountedViews:function(t,e){var n=0;"function"!=typeof t&&(t=null);for(var r=("mountBatchSize"in(e=e||{})?e.mountBatchSize:1/0),i=this._updates,o=i.unmountedCids,s=i.unmounted,a=0,u=Math.min(o.length,r);a<u;a++){var l=o[a];if(l in s){var c=Be[l];if(c)if(!t||t.call(this,c,!0,this)){n++;var h=this.registerMountedView(c);h&&this.scheduleViewUpdate(c,h,c.UPDATE_PRIORITY,{mounting:!0})}else o.push(l)}}return o.splice(0,a),n},checkMountedViews:function(t,e){e=e||{};var n=0;if("function"!=typeof t)return n;for(var r=("unmountBatchSize"in e?e.unmountBatchSize:1/0),i=this._updates,o=i.mountedCids,s=i.mounted,a=0,u=Math.min(o.length,r);a<u;a++){var l=o[a];if(l in s){var c=Be[l];if(c)if(t.call(this,c,!0))o.push(l);else{n++;var h=this.registerUnmountedView(c);h&&c.unmount()}}}return o.splice(0,a),n},checkViewport:function(t){var e=Pt({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),n="viewport"in e?e.viewport:this.options.viewport,r=this.checkMountedViews(n,e);if(0<r){var i=this._updates.unmountedCids;e.mountBatchSize=Math.min(i.length-r,e.mountBatchSize)}var o=this.checkUnmountedViews(n,e);return{mounted:o,unmounted:r}},freeze:function(t){t=t||{};var e=this._updates,n=t.key,r=this.options.frozen,i=e.freezeKey;if(n&&n!==i){if(r&&i)return;e.freezeKey=n,e.keyFrozen=r}this.options.frozen=!0;var o=e.id;e.id=null,this.isAsync()&&o&&at(o)},unfreeze:function(t){t=t||{};var e=this._updates,n=t.key,r=e.freezeKey;n&&r&&n!==r||(e.freezeKey=null,n&&n===r&&e.keyFrozen||(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===ti.EXACT},onRemove:function(){this.freeze(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,n=t.height;return re(e)||(e=this.el.clientWidth),re(n)||(n=this.el.clientHeight),{width:e,height:n}},setDimensions:function(t,e){var n=this.options,r=void 0===t?n.width:t,i=void 0===e?n.height:e;this.options.width=r,this.options.height=i,re(r)&&(r=Math.round(r)),re(i)&&(i=Math.round(i)),this.$el.css({width:null===r?"":r,height:null===i?"":i});var o=this.getComputedSize();this.trigger("resize",o.width,o.height)},setOrigin:function(t,e){return this.translate(t||0,e||0,{absolute:!0})},fitToContent:function(t,e,n,r){n=ne(t)?(t=(r=t).gridWidth||1,e=r.gridHeight||1,r.padding||0):(r=r||{},t=t||1,e=e||1,n||0),n=gt(n);var i="contentArea"in r?new G(r.contentArea):this.getContentArea(r),o=this.scale(),s=this.translate(),a=o.sx,u=o.sy;i.x*=a,i.y*=u,i.width*=a,i.height*=u;var l=Math.max(Math.ceil((i.width+i.x)/t),1)*t,c=Math.max(Math.ceil((i.height+i.y)/e),1)*e,h=0,f=0;("negative"==r.allowNewOrigin&&i.x<0||"positive"==r.allowNewOrigin&&0<=i.x||"any"==r.allowNewOrigin)&&(h=Math.ceil(-i.x/t)*t,h+=n.left,l+=h),("negative"==r.allowNewOrigin&&i.y<0||"positive"==r.allowNewOrigin&&0<=i.y||"any"==r.allowNewOrigin)&&(f=Math.ceil(-i.y/e)*e,f+=n.top,c+=f),l+=n.right,c+=n.bottom,l=Math.max(l,r.minWidth||0),c=Math.max(c,r.minHeight||0),l=Math.min(l,r.maxWidth||Number.MAX_VALUE),c=Math.min(c,r.maxHeight||Number.MAX_VALUE);var d=this.getComputedSize(),p=l!=d.width||c!=d.height,g=h!=s.tx||f!=s.ty;return g&&this.translate(h,f),p&&this.setDimensions(l,c),new G(-h/a,-f/u,l/a,c/u)},scaleContentToFit:function(t){var e,n;if("contentArea"in(t=t||{})){var r=t.contentArea;e=this.localToPaperRect(r),n=new S(r)}else e=this.getContentBBox(t),n=this.paperToLocalPoint(e);if(e.width&&e.height){Pt(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE});var i,o=t.padding,s=t.minScaleX||t.minScale,a=t.maxScaleX||t.maxScale,u=t.minScaleY||t.minScale,l=t.maxScaleY||t.maxScale;if(t.fittingBBox)i=t.fittingBBox;else{var c=this.translate(),h=this.getComputedSize();i={x:c.tx,y:c.ty,width:h.width,height:h.height}}i=new G(i).inflate(-o);var f=this.scale(),d=i.width/e.width*f.sx,p=i.height/e.height*f.sy;if(t.preserveAspectRatio&&(d=p=Math.min(d,p)),t.scaleGrid){var g=t.scaleGrid;d=g*Math.floor(d/g),p=g*Math.floor(p/g)}d=Math.min(a,Math.max(s,d)),p=Math.min(l,Math.max(u,p));var v=this.options.origin,m=i.x-n.x*d-v.x,y=i.y-n.y*p-v.y;this.scale(d,p),this.translate(m,y)}},getContentArea:function(t){if(t&&t.useModelGeometry){var e=this.model;return e.getCellsBBox(e.getCells(),{includeLinks:!0})||new G}return $(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(){return Dt(this.options.restrictTranslate)?this.options.restrictTranslate.apply(this,arguments):!0===this.options.restrictTranslate?this.getArea():this.options.restrictTranslate||null},createViewForModel:function(t){var e,n,r=this.options.cellViewNamespace,i=t.get("type")+"View",o=K(r,i,".");n=t.isLink()?(e=this.options.linkView,Qr):(e=this.options.elementView,qe);var s=e.prototype instanceof a.View?o||e:e.call(this,t)||o||n;return new s({model:t,interactive:this.options.interactive})},removeView:function(t){var e=t.id,n=this._views[e];return n&&(n.remove(),delete this._views[e]),n},renderView:function(t,e){var n,r,i=t.id,o=this._views;return r=i in o?(n=o[i],ei):((n=o[t.id]=this.createViewForModel(t)).paper=this,ei|n.getFlag(n.initFlag)),this.requestViewUpdate(n,r,n.UPDATE_PRIORITY,e),n},onImageDragStart:function(){return!1},resetViews:function(t,e){e=e||{},t=t||[],this._resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(var n=0,r=t.length;n<r;n++)this.renderView(t[n],e);this.unfreeze({key:"reset"}),this.sortViews()},removeViews:function(){Ct(this._views,"remove"),this._views={}},sortViews:function(){this.isExactSorting()&&(this.isFrozen()?this._updates.sort=!0:this.sortViewsExact())},sortViewsExact:function(){var t=E(this.cells).children("[model-id]"),s=this.model.get("cells");pt(t,function(t,e){var n=s.get(t.getAttribute("model-id")),r=s.get(e.getAttribute("model-id")),i=n.attributes.z||0,o=r.attributes.z||0;return i===o?0:i<o?-1:1})},insertView:function(t){var e=this.cells;switch(this.options.sorting){case ti.APPROX:var n=t.model.get("z"),r=this.addZPivot(n);e.insertBefore(t.el,r);break;case ti.EXACT:default:e.appendChild(t.el)}},addZPivot:function(t){t=(t=+t)||0;var e=this._zPivots,n=e[t];if(n)return n;n=e[t]=document.createComment("z-index:"+(t+1));var r=-1/0;for(var i in e)(i=+i)<t&&r<i&&(r=i);var o=this.cells;if(r!==-1/0){var s=e[r];o.insertBefore(n,s.nextSibling)}else o.insertBefore(n,o.firstChild);return n},removeZPivots:function(){var t=this._zPivots,e=this.viewport;for(var n in t)e.removeChild(t[n]);this._zPivots={}},scale:function(t,e,n,r){if(void 0===t)return $.matrixToScale(this.matrix());void 0===e&&(e=t),void 0===n&&(r=n=0);var i=this.translate();if(n||r||i.tx||i.ty){var o=i.tx-n*(t-1),s=i.ty-r*(e-1);this.translate(o,s)}t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE);var a=this.matrix();return a.a=t,a.d=e,this.matrix(a),this.trigger("scale",t,e,n,r),this},rotate:function(t,e,n){if(void 0===t)return $.matrixToRotate(this.matrix());if(void 0===e){var r=this.cells.getBBox();e=r.width/2,n=r.height/2}var i=this.matrix().translate(e,n).rotate(t).translate(-e,-n);return this.matrix(i),this},translate:function(t,e){if(void 0===t)return $.matrixToTranslate(this.matrix());var n=this.matrix();n.e=t||0,n.f=e||0,this.matrix(n);var r=this.translate(),i=this.options.origin;return i.x=r.tx,i.y=r.ty,this.trigger("translate",r.tx,r.ty),this.options.drawGrid&&this.drawGrid(),this},findView:function(t){var e=ie(t)?this.cells.querySelector(t):t instanceof E?t[0]:t,n=this.findAttribute("model-id",e);if(n)return this._views[n]},findViewByModel:function(t){var e=ie(t)||re(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(e){e=new S(e);var t=this.model.getElements().map(this.findViewByModel,this);return t.filter(function(t){return t&&t.vel.getBBox({target:this.cells}).containsPoint(e)},this)},findViewsInArea:function(e,t){t=Pt(t||{},{strict:!1}),e=new G(e);var n=this.model.getElements().map(this.findViewByModel,this),r=t.strict?"containsRect":"intersect";return n.filter(function(t){return t&&e[r](t.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t){for(var e,n=[],r=arguments.length-1;0<r--;)n[r]=arguments[r+1];"string"==typeof t&&(e=this).trigger.apply(e,["tools:event",t].concat(n))},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var n=new S(t,e),r=$.transformPoint(n,this.matrix());return r},localToPaperRect:function(t,e,n,r){var i=new G(t,e,n,r),o=$.transformRect(i,this.matrix());return o},paperToLocalPoint:function(t,e){var n=new S(t,e),r=$.transformPoint(n,this.matrix().inverse());return r},paperToLocalRect:function(t,e,n,r){var i=new G(t,e,n,r),o=$.transformRect(i,this.matrix().inverse());return o},localToClientPoint:function(t,e){var n=new S(t,e),r=$.transformPoint(n,this.clientMatrix());return r},localToClientRect:function(t,e,n,r){var i=new G(t,e,n,r),o=$.transformRect(i,this.clientMatrix());return o},clientToLocalPoint:function(t,e){var n=new S(t,e),r=$.transformPoint(n,this.clientMatrix().inverse());return r},clientToLocalRect:function(t,e,n,r){var i=new G(t,e,n,r),o=$.transformRect(i,this.clientMatrix().inverse());return o},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,n,r){return this.localToPaperRect(t,e,n,r).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var n=new S(t,e),r=n.difference(this.pageOffset());return this.paperToLocalPoint(r)},pageToLocalRect:function(t,e,n,r){var i=this.pageOffset(),o=new G(t,e,n,r);return o.x-=i.x,o.y-=i.y,this.paperToLocalRect(o)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new S(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof Qr))throw new Error("Must provide a linkView.");var e=t.model,n=this.options,r=this.model,i=r.constructor.validations;return!(!n.multiLinks&&!i.multiLinks.call(this,r,e))&&(!(!n.linkPinning&&!i.linkPinning.call(this,r,e))&&!("function"==typeof n.allowLink&&!n.allowLink.call(this,t,this)))},getDefaultLink:function(t,e){return Dt(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(e){var t=(e=e||{}).highlighter,n=this.options;if(void 0===t){var r=["embedding","connecting","magnetAvailability","elementAvailability"].find(function(t){return!!e[t]});t=r&&n.highlighting[r]||n.highlighting.default}if(!t)return!1;ie(t)&&(t={name:t});var i=t.name,o=n.highlighterNamespace[i];if(!o)throw new Error('Unknown highlighter ("'+i+'")');if("function"!=typeof o.highlight)throw new Error('Highlighter ("'+i+'") is missing required highlight() method');if("function"!=typeof o.unhighlight)throw new Error('Highlighter ("'+i+'") is missing required unhighlight() method');return{highlighter:o,options:t.options||{},name:i}},onCellHighlight:function(t,e,n){if(n=this.resolveHighlighter(n)){e.id||(e.id=$.uniqueId());var r=n.name+e.id+JSON.stringify(n.options);if(!this._highlights[r]){var i=n.highlighter;i.highlight(t,e,kt({},n.options)),this._highlights[r]={cellView:t,magnetEl:e,opt:n.options,highlighter:i}}}},onCellUnhighlight:function(t,e,n){if(n=this.resolveHighlighter(n)){var r=n.name+e.id+JSON.stringify(n.options),i=this._highlights[r];i&&(i.highlighter.unhighlight(i.cellView,i.magnetEl,i.opt),this._highlights[r]=null)}},pointerdblclick:function(t){t.preventDefault(),t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)}},pointerclick:function(t){var e=this.eventData(t);if(e.mousemoved<=this.options.clickThreshold){t=ot(t);var n=this.findView(t.target);if(this.guard(t,n))return;var r=this.snapToGrid(t.clientX,t.clientY);n?n.pointerclick(t,r.x,r.y):this.trigger("blank:pointerclick",t,r.x,r.y)}},contextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,n.x,n.y):this.trigger("blank:contextmenu",t,n.x,n.y)}},pointerdown:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?(t.preventDefault(),e.pointerdown(t,n.x,n.y)):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,n.x,n.y)),this.delegateDragEvents(e,t.data)}},pointermove:function(t){var e=this.eventData(t);e.mousemoved||(e.mousemoved=0);var n=++e.mousemoved;if(!(n<=this.options.moveThreshold)){t=ot(t);var r=this.snapToGrid(t.clientX,t.clientY),i=e.sourceView;i?i.pointermove(t,r.x,r.y):this.trigger("blank:pointermove",t,r.x,r.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=ot(t),n=this.snapToGrid(e.clientX,e.clientY),r=this.eventData(t).sourceView;r?r.pointerup(e,n.x,n.y):this.trigger("blank:pointerup",e,n.x,n.y),e.isPropagationStopped()||this.pointerclick(E.Event(t,{type:"click",data:t.data})),t.stopImmediatePropagation(),this.delegateEvents()},mouseover:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.findView(t.relatedTarget);if(e){if(n===e)return;e.mouseenter(t)}else{if(n)return;this.trigger("paper:mouseenter",t)}}},mouseleave:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.findView(t.relatedTarget);if(e){if(n===e)return;e.mouseleave(t)}else{if(n)return;this.trigger("paper:mouseleave",t)}}},mousewheel:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=t.originalEvent,r=this.snapToGrid(n.clientX,n.clientY),i=Math.max(-1,Math.min(1,n.wheelDelta||-n.detail));e?e.mousewheel(t,r.x,r.y,i):this.trigger("blank:mousewheel",t,r.x,r.y,i)}},onevent:function(t){var e=t.currentTarget,n=e.getAttribute("event");if(n){var r=this.findView(e);if(r){if(t=ot(t),this.guard(t,r))return;var i=this.snapToGrid(t.clientX,t.clientY);r.onevent(t,n,i.x,i.y)}}},magnetEvent:function(t,e){var n=t.currentTarget,r=n.getAttribute("magnet");if(r){var i=this.findView(n);if(i){if(t=ot(t),this.guard(t,i))return;var o=this.snapToGrid(t.clientX,t.clientY);e.call(this,i,t,n,o.x,o.y)}}},onmagnet:function(t){this.magnetEvent(t,function(t,e,n,r,i){t.onmagnet(e,r,i)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(t,e,n,r,i){t.magnetpointerdblclick(e,n,r,i)})},magnetcontextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),this.magnetEvent(t,function(t,e,n,r,i){t.magnetcontextmenu(e,n,r,i)})},onlabel:function(t){var e=t.currentTarget,n=this.findView(e);if(n){if(t=ot(t),this.guard(t,n))return;var r=this.snapToGrid(t.clientX,t.clientY);n.onlabel(t,r.x,r.y)}},getPointerArgs:function(t){var e=ot(t),n=this.snapToGrid(e.clientX,e.clientY),r=n.x,i=n.y;return[e,r,i]},delegateDragEvents:function(t,e){e=e||{},this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e),this.undelegateEvents()},guard:function(t,e){return"mousedown"===t.type&&2===t.button||(!(!this.options.guard||!this.options.guard(t,e))||(t.data&&void 0!==t.data.guarded?t.data.guarded:!(e&&e.model&&e.model instanceof be)&&(this.svg!==t.target&&this.el!==t.target&&!E.contains(this.svg,t.target))))},setGridSize:function(t){return this.options.gridSize=t,this.options.drawGrid&&this.drawGrid(),this},clearGrid:function(){return this.$grid&&this.$grid.css("backgroundImage","none"),this},_getGridRefs:function(){return this._gridCache||(this._gridCache={root:$("svg",{width:"100%",height:"100%"},$("defs")),patterns:{},add:function(t,e){$(this.root.node.childNodes[0]).append(e),this.patterns[t]=e,this.root.append($("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return void 0!==this.patterns[t]}}),this._gridCache},setGrid:function(t){this.clearGrid(),this._gridCache=null,this._gridSettings=[];var e=Array.isArray(t)?t:[t||{}];return e.forEach(function(t){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(t))},this),this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(ie(t)&&Array.isArray(e[t]))return e[t].map(function(t){return kt({},t)});var n=t||{args:[{}]},r=Array.isArray(n),i=n.name;if(r||i||n.markup||(i="dot"),i&&Array.isArray(e[i])){var o=e[i].map(function(t){return kt({},t)}),s=Array.isArray(n.args)?n.args:[n.args||{}];Pt(s[0],Xt(t,"args"));for(var a=0;a<s.length;a++)o[a]&&kt(o[a],s[a]);return o}return r?n:[n]},drawGrid:function(t){var a=this.options.gridSize;if(a<=1)return this.clearGrid();var u=Array.isArray(t)?t:[t],l=this.matrix(),c=this._getGridRefs();this._gridSettings.forEach(function(t,e){var n="pattern_"+e,r=te(t,u[e],{sx:l.a||1,sy:l.d||1,ox:l.e||0,oy:l.f||0});r.width=a*(l.a||1)*(r.scaleFactor||1),r.height=a*(l.d||1)*(r.scaleFactor||1),c.exist(n)||c.add(n,$("pattern",{id:n,patternUnits:"userSpaceOnUse"},$(r.markup)));var i=c.get(n);Dt(r.update)&&r.update(i.node.childNodes[0],r);var o=r.ox%r.width;o<0&&(o+=r.width);var s=r.oy%r.height;s<0&&(s+=r.height),i.attr({x:o,y:s,width:r.width,height:r.height})});var e=(new XMLSerializer).serializeToString(c.root.node);return e="url(data:image/svg+xml;base64,"+btoa(e)+")",this.$grid.css("backgroundImage",e),this},updateBackgroundImage:function(t){var e=(t=t||{}).position||"center",n=t.size||"auto auto",r=this.scale(),i=this.translate();if(ne(e)){var o=i.tx+r.sx*(e.x||0),s=i.ty+r.sy*(e.y||0);e=o+"px "+s+"px"}ne(n)&&(n=(n=new G(n).scale(r.sx,r.sy)).width+"px "+n.height+"px"),this.$background.css({backgroundSize:n,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(t instanceof HTMLImageElement){var n,r=(e=e||{}).size,i=e.repeat||"no-repeat",o=e.opacity||1,s=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[Kt(i)];if(Dt(a)){t.width*=s,t.height*=s;var u=a(t,e);if(!(u instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");n=u.toDataURL("image/png"),i="repeat",ne(r)?(r.width*=u.width/t.width,r.height*=u.height/t.height):void 0===r&&(e.size={width:u.width/s,height:u.height/s})}else n=t.src,void 0===r&&(e.size={width:t.width,height:t.height});this.$background.css({opacity:o,backgroundRepeat:i,backgroundImage:"url("+n+")"}),this.updateBackgroundImage(e)}else this.$background.css("backgroundImage","")},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=Mt(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,Ct(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!ne(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,n=t.name;if(e=e||n+this.svg.id+Z(JSON.stringify(t)),!this.isDefined(e)){var r=yt,i=r[n]&&r[n](t.args||{});if(!i)throw new Error("Non-existing filter "+n);var o=kt({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:e});$(i,o).appendTo(this.defs)}return e},defineGradient:function(t){if(!ne(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var e=t.id,n=t.type,r=t.stops;if(e=e||n+this.svg.id+Z(JSON.stringify(t)),!this.isDefined(e)){var i=wt('<stop offset="${offset}" stop-color="${color}" stop-opacity="${opacity}"/>'),o=Ft(r).map(function(t){return i({offset:t.offset,color:t.color,opacity:Number.isFinite(t.opacity)?t.opacity:1})}),s=["<"+n+">",o.join(""),"</"+n+">"].join(""),a=kt({id:e},t.attrs);$(s,a).appendTo(this.defs)}return e},defineMarker:function(t){if(!ne(t))throw new TypeError("dia.Paper: defineMarker() requires 1. argument to be an object.");var e=t.id;if(e=e||this.svg.id+Z(JSON.stringify(t)),!this.isDefined(e)){var n=Xt(t,"type","userSpaceOnUse"),r=$("marker",{id:e,orient:"auto",overflow:"visible",markerUnits:t.markerUnits||"userSpaceOnUse"},[$(t.type||"path",n)]);r.appendTo(this.defs)}return e}},{sorting:ti,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),n=t.width,r=t.height;e.width=2*n,e.height=2*r;var i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,-1,e.width,e.height),i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,1,e.width,0),i.drawImage(t,0,0,n,r),i.setTransform(1,0,0,-1,0,e.height),i.drawImage(t,0,0,n,r),e},flipX:function(t){var e=document.createElement("canvas"),n=t.width,r=t.height;e.width=2*n,e.height=r;var i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.translate(2*n,0),i.scale(-1,1),i.drawImage(t,0,0,n,r),e},flipY:function(t){var e=document.createElement("canvas"),n=t.width,r=t.height;e.width=n,e.height=2*r;var i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.translate(0,2*r),i.scale(1,-1),i.drawImage(t,0,0,n,r),e},watermark:function(t,e){e=e||{};var n=t.width,r=t.height,i=document.createElement("canvas");i.width=3*n,i.height=3*r;for(var o=i.getContext("2d"),s=re(e.watermarkAngle)?-e.watermarkAngle:-20,a=_(s),u=i.width/4,l=i.height/4,c=0;c<4;c++)for(var h=0;h<4;h++)0<(c+h)%2&&(o.setTransform(1,0,0,1,(2*c-1)*u,(2*h-1)*l),o.rotate(a),o.drawImage(t,-n/2,-r/2,n,r));return i}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){$(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var n=e.sx<=1?e.thickness*e.sx:e.thickness;$(t).attr({width:n,height:n,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,r=e.width,i=e.height,o=e.thickness;n=0<=r-o&&0<=i-o?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",$(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var n,r=e.width,i=e.height,o=e.thickness;n=0<=r-o&&0<=i-o?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",$(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var n,r=e.width,i=e.height,o=e.thickness;n=0<=r-o&&0<=i-o?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",$(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}]}}),oi=Ve.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){}}),si=Ve.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,options:{tools:null,relatedView:null,name:null,component:!1},configure:function(t){var e=(t=kt(this.options,t)).tools;if(!Array.isArray(e))return this;var n=t.relatedView;if(!(n instanceof ze))return this;for(var r=this.tools=[],i=0,o=e.length;i<o;i++){var s=e[i];s instanceof oi&&(s.configure(n,this),s.render(),this.vel.append(s.el),r.push(s))}return this},getName:function(){return this.options.name},update:function(t){t=t||{};var e=this.tools;if(e){for(var n=0,r=e.length;n<r;n++){var i=e[n];t.tool!==i.cid&&i.isVisible()&&i.update()}return this}},focusTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,r=e.length;n<r;n++){var i=e[n];t===i?i.show():i.hide()}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,r=e.length;n<r;n++){var i=e[n];i===t||i.isVisible()||(i.show(),i.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,n=t.length;e<n;e++)t[e].remove();this.tools=null},mount:function(){var t=this.options,e=t.relatedView;if(e){var n=t.component?e.el:e.paper.tools;n.appendChild(this.el)}return this}}),ai={Graph:Kr,attributes:ye,Cell:be,CellView:ze,Element:Fe,ElementView:qe,Link:sn,LinkView:Qr,Paper:ii,ToolView:oi,ToolsView:si};function ui(t,e,n){var r=Yn.call(this.paper,{},e,n,t,this.model);return r.anchor}var li=Ve.extend({tagName:"circle",svgElement:!0,className:"marker-vertex",events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},attributes:{r:6,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move"},position:function(t,e){this.vel.attr({cx:t,cy:e})},onPointerDown:function(t){t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data),this.trigger("will-change",this,t)},onPointerMove:function(t){this.trigger("changing",this,t)},onDoubleClick:function(t){this.trigger("remove",this,t)},onPointerUp:function(t){this.trigger("changed",this,t),this.undelegateDocumentEvents(),this.options.paper.delegateEvents()}}),ci=oi.extend({name:"vertices",options:{handleClass:li,snapRadius:20,redundancyRemoval:!0,vertexAdding:!0,stopPropagation:!0},children:[{tagName:"path",selector:"connection",className:"joint-vertices-path",attributes:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"cell"}}],handles:null,events:{"mousedown .joint-vertices-path":"onPathPointerDown","touchstart .joint-vertices-path":"onPathPointerDown"},onRender:function(){return this.options.vertexAdding&&(this.renderChildren(),this.updatePath()),this.resetHandles(),this.renderHandles(),this},update:function(){var t=this.relatedView,e=t.model.vertices();return e.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.vertexAdding&&this.updatePath(),this},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},renderHandles:function(){for(var t=this.relatedView,e=t.model.vertices(),n=0,r=e.length;n<r;n++){var i=e[n],o=new this.options.handleClass({index:n,paper:this.paper});o.render(),o.position(i.x,i.y),this.simulateRelatedView(o.el),o.vel.appendTo(this.el),this.handles.push(o),this.startHandleListening(o)}},updateHandles:function(){for(var t=this.relatedView,e=t.model.vertices(),n=0,r=e.length;n<r;n++){var i=e[n],o=this.handles[n];if(!o)return;o.position(i.x,i.y)}},updatePath:function(){var t=this.childNodes.connection;t&&t.setAttribute("d",this.relatedView.getSerializedConnection())},startHandleListening:function(t){var e=this.relatedView;e.can("vertexMove")&&(this.listenTo(t,"will-change",this.onHandleWillChange),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"changed",this.onHandleChanged)),e.can("vertexRemove")&&this.listenTo(t,"remove",this.onHandleRemove)},getNeighborPoints:function(t){var e=this.relatedView,n=e.model.vertices(),r=0<t?n[t-1]:e.sourceAnchor,i=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:new S(r),next:new S(i)}},onHandleWillChange:function(t,e){this.focus();var n=this.relatedView,r=this.options;n.model.startBatch("vertex-move",{ui:!0,tool:this.cid}),r.stopPropagation||n.notifyPointerdown.apply(n,n.paper.getPointerArgs(e))},onHandleChanging:function(t,e){var n=this.options,r=this.relatedView,i=t.options.index,o=r.paper.getPointerArgs(e),s=o[0],a=o[1],u=o[2],l={x:a,y:u};this.snapVertex(l,i),r.model.vertex(i,l,{ui:!0,tool:this.cid}),t.position(l.x,l.y),n.stopPropagation||r.notifyPointermove(s,a,u)},onHandleChanged:function(t,e){var n=this.options,r=this.relatedView;if(n.vertexAdding&&this.updatePath(),n.redundancyRemoval){var i=r.removeRedundantLinearVertices({ui:!0,tool:this.cid});i&&this.render(),this.blur(),r.model.stopBatch("vertex-move",{ui:!0,tool:this.cid}),this.eventData(e).vertexAdded&&r.model.stopBatch("vertex-add",{ui:!0,tool:this.cid});var o=r.paper.getPointerArgs(e),s=o[0],a=o[1],u=o[2];n.stopPropagation||r.notifyPointerup(s,a,u),r.checkMouseleave(s)}},snapVertex:function(t,e){var n=this.options.snapRadius;if(0<n){var r=this.getNeighborPoints(e),i=r.prev,o=r.next;Math.abs(t.x-i.x)<n?t.x=i.x:Math.abs(t.x-o.x)<n&&(t.x=o.x),Math.abs(t.y-i.y)<n?t.y=r.prev.y:Math.abs(t.y-o.y)<n&&(t.y=o.y)}},onHandleRemove:function(t,e){var n=t.options.index,r=this.relatedView;r.model.removeVertex(n,{ui:!0}),this.options.vertexAdding&&this.updatePath(),r.checkMouseleave(ot(e))},onPathPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=ot(t),n=this.paper.snapToGrid(e.clientX,e.clientY).toJSON(),r=this.relatedView;r.model.startBatch("vertex-add",{ui:!0,tool:this.cid});var i=r.getVertexIndex(n.x,n.y);this.snapVertex(n,i),r.model.insertVertex(i,n,{ui:!0,tool:this.cid}),this.render();var o=this.handles[i];this.eventData(e,{vertexAdded:!0}),o.onPointerDown(e)},onRemove:function(){this.resetHandles()}},{VertexHandle:li}),hi=Ve.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,n,r){var i=$.createSVGMatrix().translate(t,e).rotate(n),o=this.childNodes.handle;o.setAttribute("transform",$.matrixToTransformString(i)),o.setAttribute("cursor",n%180==0?"row-resize":"col-resize");var s=r.getClosestPoint(new S(t,e)),a=this.childNodes.line;a.setAttribute("x1",t),a.setAttribute("y1",e),a.setAttribute("x2",s.x),a.setAttribute("y2",s.y)},onPointerDown:function(t){this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data)},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}}),fi=oi.extend({name:"segments",precision:.5,options:{handleClass:hi,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:ui,snapRadius:10,snapHandle:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var n=0,r=e.length;n<r-1;n++){var i=e[n],o=e[n+1],s=this.renderHandle(i,o);this.simulateRelatedView(s.el),this.handles.push(s),s.options.index=n}return this},renderHandle:function(t,e){var n=new this.options.handleClass({paper:this.paper});return n.render(),this.updateHandle(n,t,e),n.vel.appendTo(this.el),this.startHandleListening(n),n},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,n=0,r=e.length;n<r;n++)e[n].options.index+=t},resetAnchor:function(t,e){var n=this.relatedView.model;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(t,e,n){var r=t.options.index,i=this.relatedView,o=i.model,s=o.vertices(),a=t.options.axis,u=s[r-2]||n.sourceAnchor,l=s[r+1]||n.targetAnchor,c=this.options.snapRadius;return Math.abs(e[a]-u[a])<c?e[a]=u[a]:Math.abs(e[a]-l[a])<c&&(e[a]=l[a]),e},onHandleChanging:function(t,e){var n=this.eventData(e),r=this.relatedView,i=r.paper,o=t.options.index-1,s=ot(e),a=i.snapToGrid(s.clientX,s.clientY),u=this.snapHandle(t,a.clone(),n),l=t.options.axis,c=this.options.snapHandle?0:a[l]-u[l],h=r.model,f=Mt(h.vertices()),d=f[o],p=f[1+o],g=this.options.anchor;"function"!=typeof g&&(g=null);var v=r.sourceView,m=r.sourceBBox,y=!1,b=!1;if(d?0==o?m.containsPoint(d)?(f.shift(),this.shiftHandleIndexes(-1),y=!0):(d[l]=u[l],b=!0):d[l]=u[l]:((d=r.sourceAnchor.toJSON())[l]=u[l],m.containsPoint(d)?(d[l]=u[l],y=!0):(f.unshift(d),this.shiftHandleIndexes(1),b=!0)),g&&v){if(y){var w=n.sourceAnchor.clone();w[l]=u[l];var x=g.call(r,w,v,r.sourceMagnet||v.el,"source",r);this.resetAnchor("source",x)}b&&this.resetAnchor("source",n.sourceAnchorDef)}var A=r.targetView,_=r.targetBBox,S=!1,k=!1;if(p?o==f.length-2?_.containsPoint(p)?(f.pop(),S=!0):(p[l]=u[l],k=!0):p[l]=u[l]:((p=r.targetAnchor.toJSON())[l]=u[l],_.containsPoint(p)?S=!0:(f.push(p),k=!0)),g&&A){if(S){var P=n.targetAnchor.clone();P[l]=u[l];var E=g.call(r,P,A,r.targetMagnet||A.el,"target",r);this.resetAnchor("target",E)}k&&this.resetAnchor("target",n.targetAnchorDef)}h.vertices(f,{ui:!0,tool:this.cid}),this.updateHandle(t,d,p,c)},onHandleChangeStart:function(t,e){var n=t.options.index,r=this.handles;if(Array.isArray(r)){for(var i=0,o=r.length;i<o;i++)i!==n&&r[i].hide();this.focus();var s=this.relatedView,a=s.model;this.eventData(e,{sourceAnchor:s.sourceAnchor.clone(),targetAnchor:s.targetAnchor.clone(),sourceAnchorDef:Lt(a.prop(["source","anchor"])),targetAnchorDef:Lt(a.prop(["target","anchor"]))}),s.model.startBatch("segment-move",{ui:!0,tool:this.cid})}},onHandleChangeEnd:function(t,e){var n=this.relatedView;this.options.redundancyRemoval&&n.removeRedundantLinearVertices({ui:!0,tool:this.cid}),this.render(),this.blur(),n.model.stopBatch("segment-move",{ui:!0,tool:this.cid}),n.checkMouseleave(ot(e))},updateHandle:function(t,e,n,r){var i=Math.abs(e.x-n.x)<this.precision,o=Math.abs(e.y-n.y)<this.precision;if(i||o){var s=new A(e,n),a=s.length();if(a<this.options.segmentLengthThreshold)t.hide();else{var u=s.midpoint(),l=i?"x":"y";u[l]+=r||0;var c=s.vector().vectorAngle(new S(1,0));t.position(u.x,u.y,c,this.relatedView),t.show(),t.options.axis=l}}else t.hide()},onRemove:function(){this.resetHandles()}},{SegmentHandle:hi}),di=oi.extend({tagName:"path",xAxisVector:new S(1,0),events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){var t,e,n=this.ratio,r=this.relatedView,i=r.getTangentAtRatio(n);if(e=i?(t=i.start,i.vector().vectorAngle(this.xAxisVector)||0):(t=r.getPointAtRatio(n),0),!t)return this;var o=$.createSVGMatrix().translate(t.x,t.y).rotate(e);return this.vel.transform(o,{absolute:!0}),this},onPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=this.relatedView;e.model.startBatch("arrowhead-move",{ui:!0,tool:this.cid}),e.can("arrowheadMove")&&(e.startArrowheadMove(this.arrowheadType),this.delegateDocumentEvents(),e.paper.undelegateEvents()),this.focus(),this.el.style.pointerEvents="none"},onPointerMove:function(t){var e=ot(t),n=this.paper.snapToGrid(e.clientX,e.clientY);this.relatedView.pointermove(e,n.x,n.y)},onPointerUp:function(t){this.undelegateDocumentEvents();var e=this.relatedView,n=e.paper,r=ot(t),i=n.snapToGrid(r.clientX,r.clientY);e.pointerup(r,i.x,i.y),n.delegateEvents(),this.blur(),this.el.style.pointerEvents="",e.model.stopBatch("arrowhead-move",{ui:!0,tool:this.cid})}}),pi=di.extend({name:"target-arrowhead",ratio:1,arrowheadType:"target",attributes:{d:"M -10 -8 10 0 -10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"target-arrowhead"}}),gi=di.extend({name:"source-arrowhead",ratio:0,arrowheadType:"source",attributes:{d:"M 10 -8 -10 0 10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"source-arrowhead"}}),vi=oi.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){var t,e,n,r=this.options.distance||0;t=ut(r)?this.relatedView.getTangentAtRatio(parseFloat(r)/100):this.relatedView.getTangentAtLength(r),n=t?(e=t.start,t.vector().vectorAngle(new S(1,0))||0):(e=this.relatedView.getConnection().start,0);var i=$.createSVGMatrix().translate(e.x,e.y).rotate(n).translate(0,this.options.offset||0);return this.options.rotate||(i=i.rotate(-n)),this.vel.transform(i,{absolute:!0}),this},onPointerDown:function(t){t.stopPropagation(),t.preventDefault();var e=this.options.action;"function"==typeof e&&e.call(this.relatedView,t,this.relatedView,this)}}),mi=vi.extend({children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,n){e.model.remove({ui:!0,tool:n.cid})}}}),yi=oi.extend({name:"boundary",tagName:"rect",options:{padding:10},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){var t=this.options.padding;isFinite(t)||(t=0);var e=this.relatedView.getConnection().bbox().inflate(t);return this.vel.attr(e.toJSON()),this}}),bi=oi.extend({tagName:"g",type:null,children:[{tagName:"circle",selector:"anchor",attributes:{cursor:"pointer"}},{tagName:"rect",selector:"area",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{snap:function(t,e,n,r,i,o){var s=o.options.snapRadius,a="source"===r,u=a?0:-1,l=this.model.vertex(u)||this.getEndAnchor(a?"target":"source");l&&(Math.abs(l.x-t.x)<s&&(t.x=l.x),Math.abs(l.y-t.y)<s&&(t.y=l.y));return t},anchor:ui,customAnchorAttributes:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttributes:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,restrictArea:!0,redundancyRemoval:!0},onRender:function(){this.renderChildren(),this.toggleArea(!1),this.update()},update:function(){var t=this.type,e=this.relatedView,n=e.getEndView(t);return n?(this.updateAnchor(),this.updateArea(),this.el.style.display=""):this.el.style.display="none",this},updateAnchor:function(){var t=this.childNodes;if(t){var e=t.anchor;if(e){var n=this.relatedView,r=this.type,i=n.getEndAnchor(r),o=this.options,s=n.model.prop([r,"anchor"]);e.setAttribute("transform","translate("+i.x+","+i.y+")");var a=s?o.customAnchorAttributes:o.defaultAnchorAttributes;for(var u in a)e.setAttribute(u,a[u])}}},updateArea:function(){var t=this.childNodes;if(t){var e=t.area;if(e){var n,r,i,o=this.relatedView,s=this.type,a=o.getEndView(s),u=a.model,l=o.getEndMagnet(s),c=this.options.areaPadding;isFinite(c)||(c=0),a.isNodeConnection(l)?(n=a.getBBox(),r=0,i=n.center()):(n=a.getNodeUnrotatedBBox(l),r=u.angle(),i=n.center(),r&&i.rotate(u.getBBox().center(),-r)),n.inflate(c),e.setAttribute("x",-n.width/2),e.setAttribute("y",-n.height/2),e.setAttribute("width",n.width),e.setAttribute("height",n.height),e.setAttribute("transform","translate("+i.x+","+i.y+") rotate("+r+")")}}},toggleArea:function(t){this.childNodes.area.style.display=t?"":"none"},onPointerDown:function(t){t.stopPropagation(),t.preventDefault(),this.paper.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleArea(this.options.restrictArea),this.relatedView.model.startBatch("anchor-move",{ui:!0,tool:this.cid})},resetAnchor:function(t){var e=this.type,n=this.relatedView.model;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([e,"anchor"],{ui:!0,tool:this.cid})},onPointerMove:function(t){var e,n=this.relatedView,r=this.type,i=n.getEndView(r),o=i.model,s=n.getEndMagnet(r),a=ot(t),u=this.paper.clientToLocalPoint(a.clientX,a.clientY),l=this.options.snap;if("function"==typeof l&&(u=l.call(n,u,i,s,r,n,this),u=new S(u)),this.options.restrictArea)if(i.isNodeConnection(s)){var c=i.getClosestPoint(u);c&&(u=c)}else{var h=i.getNodeUnrotatedBBox(s),f=o.angle(),d=o.getBBox().center(),p=u.clone().rotate(d,f);h.containsPoint(p)||(u=h.pointNearestToPoint(p).rotate(d,-f))}var g=this.options.anchor;"function"==typeof g&&(e=g.call(n,u,i,s,r,n)),this.resetAnchor(e),this.update()},onPointerUp:function(t){this.paper.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var e=this.relatedView;this.options.redundancyRemoval&&e.removeRedundantLinearVertices({ui:!0,tool:this.cid}),e.model.stopBatch("anchor-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){this.resetAnchor(),this.update()}}),wi=bi.extend({name:"source-anchor",type:"source"}),xi=bi.extend({name:"target-anchor",type:"target"}),Ai={Vertices:ci,Segments:fi,SourceArrowhead:gi,TargetArrowhead:pi,SourceAnchor:wi,TargetAnchor:xi,Button:vi,Remove:mi,Boundary:yi},_i=$,Si={PortLabel:Oe,Port:Ee},ki={basic:on,standard:Sn};e.format={},e.ui={},e.shapes=ki,e.Vectorizer=_i,e.layout=Si,e.config=W,e.anchors=Jr,e.linkAnchors=Fr,e.connectionPoints=qn,e.connectionStrategies=Jn,e.connectors=Ln,e.dia=ai,e.highlighters=Dn,e.mvc=Ie,e.routers=Mr,e.util=Ae,e.linkTools=Ai,e.V=$,e.g=U,e.setTheme=function(t,e){Ct(Be,"setTheme",t,e=e||{}),Ve.prototype.defaultTheme=t},e.env=He,e.version="3.0.4",Object.defineProperty(e,"__esModule",{value:!0})}(e,n(5),n(7),n(3)),"undefined"!=typeof joint)joint.g,joint.V,joint.V},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(an,un,t){var ln;
/*!
 * jQuery JavaScript Library v3.4.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-05-01T21:04Z
 */
/*!
 * jQuery JavaScript Library v3.4.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-05-01T21:04Z
 */
!function(t,e){"use strict";"object"==typeof an.exports?an.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(_,t){"use strict";function g(t){return null!=t&&t===t.window}var e=[],S=_.document,r=Object.getPrototypeOf,a=e.slice,v=e.concat,u=e.push,i=e.indexOf,n={},o=n.toString,m=n.hasOwnProperty,s=m.toString,l=s.call(Object),y={},b=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},c={type:!0,src:!0,nonce:!0,noModule:!0};function w(t,e,n){var r,i,o=(n=n||S).createElement("script");if(o.text=t,e)for(r in c)(i=e[r]||e.getAttribute&&e.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?n[o.call(t)]||"object":typeof t}var k=function(t,e){return new k.fn.init(t,e)},h=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function f(t){var e=!!t&&"length"in t&&t.length,n=x(t);return!b(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}k.fn=k.prototype={jquery:"3.4.1",constructor:k,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=k.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return k.each(this,t)},map:function(n){return this.pushStack(k.map(this,function(t,e){return n.call(t,e,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:e.sort,splice:e.splice},k.extend=k.fn.extend=function(){var t,e,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||b(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)r=t[e],"__proto__"!==e&&s!==r&&(l&&r&&(k.isPlainObject(r)||(i=Array.isArray(r)))?(n=s[e],o=i&&!Array.isArray(n)?[]:i||k.isPlainObject(n)?n:{},i=!1,s[e]=k.extend(l,o,r)):void 0!==r&&(s[e]=r));return s},k.extend({expando:"jQuery"+("3.4.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==o.call(t))&&(!(e=r(t))||"function"==typeof(n=m.call(e,"constructor")&&e.constructor)&&s.call(n)===l)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e){w(t,{nonce:e&&e.nonce})},each:function(t,e){var n,r=0;if(f(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(h,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(f(Object(t))?k.merge(n,"string"==typeof t?[t]:t):u.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:i.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,s=!n;i<o;i++)!e(t[i],i)!=s&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,s=[];if(f(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&s.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&s.push(i);return v.apply([],s)},guid:1,support:y}),"function"==typeof Symbol&&(k.fn[Symbol.iterator]=e[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){n["[object "+e+"]"]=e.toLowerCase()});var d=
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
function(n){function h(t,e,n){var r="0x"+e-65536;return r!=r||n?e:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)}function i(){A()}var t,d,w,o,s,p,f,g,x,u,l,A,_,a,S,v,c,m,y,k="sizzle"+1*new Date,b=n.document,P=0,r=0,E=ut(),C=ut(),T=ut(),N=ut(),L=function(t,e){return t===e&&(l=!0),0},M={}.hasOwnProperty,e=[],O=e.pop,R=e.push,D=e.push,j=e.slice,F=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",V="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",z="\\["+V+"*("+I+")(?:"+V+"*([*^$|!~]?=)"+V+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+V+"*\\]",q=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+z+")*)|.*)\\)|)",H=new RegExp(V+"+","g"),U=new RegExp("^"+V+"+|((?:^|[^\\\\])(?:\\\\.)*)"+V+"+$","g"),$=new RegExp("^"+V+"*,"+V+"*"),G=new RegExp("^"+V+"*([>+~]|"+V+")"+V+"*"),W=new RegExp(V+"|>"),X=new RegExp(q),Y=new RegExp("^"+I+"$"),J={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+z),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+V+"*(even|odd|(([+-]|)(\\d*)n|)"+V+"*(?:([+-]|)"+V+"*(\\d+)|))"+V+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+V+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+V+"*((?:-\\d)?\\d*)"+V+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,tt=/^[^{]+\{\s*\[native \w/,et=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,nt=/[+~]/,rt=new RegExp("\\\\([\\da-f]{1,6}"+V+"?|("+V+")|.)","ig"),it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=wt(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{D.apply(e=j.call(b.childNodes),b.childNodes),e[b.childNodes.length].nodeType}catch(t){D={apply:e.length?function(t,e){R.apply(t,j.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function at(e,t,n,r){var i,o,s,a,u,l,c,h=t&&t.ownerDocument,f=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return n;if(!r&&((t?t.ownerDocument||t:b)!==_&&A(t),t=t||_,S)){if(11!==f&&(u=et.exec(e)))if(i=u[1]){if(9===f){if(!(s=t.getElementById(i)))return n;if(s.id===i)return n.push(s),n}else if(h&&(s=h.getElementById(i))&&y(t,s)&&s.id===i)return n.push(s),n}else{if(u[2])return D.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&d.getElementsByClassName&&t.getElementsByClassName)return D.apply(n,t.getElementsByClassName(i)),n}if(d.qsa&&!N[e+" "]&&(!v||!v.test(e))&&(1!==f||"object"!==t.nodeName.toLowerCase())){if(c=e,h=t,1===f&&W.test(e)){for((a=t.getAttribute("id"))?a=a.replace(it,ot):t.setAttribute("id",a=k),o=(l=p(e)).length;o--;)l[o]="#"+a+" "+bt(l[o]);c=l.join(","),h=nt.test(e)&&mt(t.parentNode)||t}try{return D.apply(n,h.querySelectorAll(c)),n}catch(t){N(e,!0)}finally{a===k&&t.removeAttribute("id")}}}return g(e.replace(U,"$1"),t,n,r)}function ut(){var r=[];return function t(e,n){return r.push(e+" ")>w.cacheLength&&delete t[r.shift()],t[e+" "]=n}}function lt(t){return t[k]=!0,t}function ct(t){var e=_.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)w.attrHandle[n[r]]=e}function ft(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function dt(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pt(n){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===n}}function gt(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&st(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function vt(s){return lt(function(o){return o=+o,lt(function(t,e){for(var n,r=s([],t.length,o),i=r.length;i--;)t[n=r[i]]&&(t[n]=!(e[n]=t[n]))})})}function mt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in d=at.support={},s=at.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!Z.test(e||n&&n.nodeName||"HTML")},A=at.setDocument=function(t){var e,n,r=t?t.ownerDocument||t:b;return r!==_&&9===r.nodeType&&r.documentElement&&(a=(_=r).documentElement,S=!s(_),b!==_&&(n=_.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",i,!1):n.attachEvent&&n.attachEvent("onunload",i)),d.attributes=ct(function(t){return t.className="i",!t.getAttribute("className")}),d.getElementsByTagName=ct(function(t){return t.appendChild(_.createComment("")),!t.getElementsByTagName("*").length}),d.getElementsByClassName=tt.test(_.getElementsByClassName),d.getById=ct(function(t){return a.appendChild(t).id=k,!_.getElementsByName||!_.getElementsByName(k).length}),d.getById?(w.filter.ID=function(t){var e=t.replace(rt,h);return function(t){return t.getAttribute("id")===e}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&S){var n=e.getElementById(t);return n?[n]:[]}}):(w.filter.ID=function(t){var n=t.replace(rt,h);return function(t){var e=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return e&&e.value===n}},w.find.ID=function(t,e){if(void 0!==e.getElementById&&S){var n,r,i,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(i=e.getElementsByName(t),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),w.find.TAG=d.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):d.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},w.find.CLASS=d.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&S)return e.getElementsByClassName(t)},c=[],v=[],(d.qsa=tt.test(_.querySelectorAll))&&(ct(function(t){a.appendChild(t).innerHTML="<a id='"+k+"'></a><select id='"+k+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+V+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||v.push("\\["+V+"*(?:value|"+B+")"),t.querySelectorAll("[id~="+k+"-]").length||v.push("~="),t.querySelectorAll(":checked").length||v.push(":checked"),t.querySelectorAll("a#"+k+"+*").length||v.push(".#.+[+~]")}),ct(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=_.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&v.push("name"+V+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=tt.test(m=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ct(function(t){d.disconnectedMatch=m.call(t,"*"),m.call(t,"[s!='']:x"),c.push("!=",q)}),v=v.length&&new RegExp(v.join("|")),c=c.length&&new RegExp(c.join("|")),e=tt.test(a.compareDocumentPosition),y=e||tt.test(a.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},L=e?function(t,e){if(t===e)return l=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!d.sortDetached&&e.compareDocumentPosition(t)===n?t===_||t.ownerDocument===b&&y(b,t)?-1:e===_||e.ownerDocument===b&&y(b,e)?1:u?F(u,t)-F(u,e):0:4&n?-1:1)}:function(t,e){if(t===e)return l=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!i||!o)return t===_?-1:e===_?1:i?-1:o?1:u?F(u,t)-F(u,e):0;if(i===o)return ft(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?ft(s[r],a[r]):s[r]===b?-1:a[r]===b?1:0}),_},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if((t.ownerDocument||t)!==_&&A(t),d.matchesSelector&&S&&!N[e+" "]&&(!c||!c.test(e))&&(!v||!v.test(e)))try{var n=m.call(t,e);if(n||d.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){N(e,!0)}return 0<at(e,_,null,[t]).length},at.contains=function(t,e){return(t.ownerDocument||t)!==_&&A(t),y(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!==_&&A(t);var n=w.attrHandle[e.toLowerCase()],r=n&&M.call(w.attrHandle,e.toLowerCase())?n(t,e,!S):void 0;return void 0!==r?r:d.attributes||!S?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},at.escape=function(t){return(t+"").replace(it,ot)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&t.slice(0),t.sort(L),l){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)t.splice(n[r],1)}return u=null,t},o=at.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=o(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r++];)n+=o(e);return n},(w=at.selectors={cacheLength:50,createPseudo:lt,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(rt,h),t[3]=(t[3]||t[4]||t[5]||"").replace(rt,h),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return J.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&X.test(n)&&(e=p(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(rt,h).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|"+V+")"+t+"("+V+"|$)"))&&E(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(t){var e=at.attr(t,n);return null==e?"!="===r:!r||(e+="","="===r?e===i:"!="===r?e!==i:"^="===r?i&&0===e.indexOf(i):"*="===r?i&&-1<e.indexOf(i):"$="===r?i&&e.slice(-i.length)===i:"~="===r?-1<(" "+e.replace(H," ")+" ").indexOf(i):"|="===r&&(e===i||e.slice(0,i.length+1)===i+"-"))}},CHILD:function(p,t,e,g,v){var m="nth"!==p.slice(0,3),y="last"!==p.slice(-4),b="of-type"===t;return 1===g&&0===v?function(t){return!!t.parentNode}:function(t,e,n){var r,i,o,s,a,u,l=m!=y?"nextSibling":"previousSibling",c=t.parentNode,h=b&&t.nodeName.toLowerCase(),f=!n&&!b,d=!1;if(c){if(m){for(;l;){for(s=t;s=s[l];)if(b?s.nodeName.toLowerCase()===h:1===s.nodeType)return!1;u=l="only"===p&&!u&&"nextSibling"}return!0}if(u=[y?c.firstChild:c.lastChild],y&&f){for(d=(a=(r=(i=(o=(s=c)[k]||(s[k]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]||[])[0]===P&&r[1])&&r[2],s=a&&c.childNodes[a];s=++a&&s&&s[l]||(d=a=0)||u.pop();)if(1===s.nodeType&&++d&&s===t){i[p]=[P,a,d];break}}else if(f&&(d=a=(r=(i=(o=(s=t)[k]||(s[k]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]||[])[0]===P&&r[1]),!1===d)for(;(s=++a&&s&&s[l]||(d=a=0)||u.pop())&&((b?s.nodeName.toLowerCase()!==h:1!==s.nodeType)||!++d||(f&&((i=(o=s[k]||(s[k]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]=[P,d]),s!==t)););return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(t,o){var e,s=w.pseudos[t]||w.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return s[k]?s(o):1<s.length?(e=[t,t,"",o],w.setFilters.hasOwnProperty(t.toLowerCase())?lt(function(t,e){for(var n,r=s(t,o),i=r.length;i--;)t[n=F(t,r[i])]=!(e[n]=r[i])}):function(t){return s(t,0,e)}):s}},pseudos:{not:lt(function(t){var r=[],i=[],a=f(t.replace(U,"$1"));return a[k]?lt(function(t,e,n,r){for(var i,o=a(t,null,r,[]),s=t.length;s--;)(i=o[s])&&(t[s]=!(e[s]=i))}):function(t,e,n){return r[0]=t,a(r,null,n,i),r[0]=null,!i.pop()}}),has:lt(function(e){return function(t){return 0<at(e,t).length}}),contains:lt(function(e){return e=e.replace(rt,h),function(t){return-1<(t.textContent||o(t)).indexOf(e)}}),lang:lt(function(n){return Y.test(n||"")||at.error("unsupported lang: "+n),n=n.replace(rt,h).toLowerCase(),function(t){var e;do{if(e=S?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===n||0===e.indexOf(n+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=n.location&&n.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===a},focus:function(t){return t===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:vt(function(){return[0]}),last:vt(function(t,e){return[e-1]}),eq:vt(function(t,e,n){return[n<0?n+e:n]}),even:vt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:vt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:vt(function(t,e,n){for(var r=n<0?n+e:e<n?e:n;0<=--r;)t.push(r);return t}),gt:vt(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=w.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[t]=dt(t);for(t in{submit:!0,reset:!0})w.pseudos[t]=pt(t);function yt(){}function bt(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function wt(a,t,e){var u=t.dir,l=t.next,c=l||u,h=e&&"parentNode"===c,f=r++;return t.first?function(t,e,n){for(;t=t[u];)if(1===t.nodeType||h)return a(t,e,n);return!1}:function(t,e,n){var r,i,o,s=[P,f];if(n){for(;t=t[u];)if((1===t.nodeType||h)&&a(t,e,n))return!0}else for(;t=t[u];)if(1===t.nodeType||h)if(i=(o=t[k]||(t[k]={}))[t.uniqueID]||(o[t.uniqueID]={}),l&&l===t.nodeName.toLowerCase())t=t[u]||t;else{if((r=i[c])&&r[0]===P&&r[1]===f)return s[2]=r[2];if((i[c]=s)[2]=a(t,e,n))return!0}return!1}}function xt(i){return 1<i.length?function(t,e,n){for(var r=i.length;r--;)if(!i[r](t,e,n))return!1;return!0}:i[0]}function At(t,e,n,r,i){for(var o,s=[],a=0,u=t.length,l=null!=e;a<u;a++)(o=t[a])&&(n&&!n(o,r,i)||(s.push(o),l&&e.push(a)));return s}function _t(d,p,g,v,m,t){return v&&!v[k]&&(v=_t(v)),m&&!m[k]&&(m=_t(m,t)),lt(function(t,e,n,r){var i,o,s,a=[],u=[],l=e.length,c=t||function(t,e,n){for(var r=0,i=e.length;r<i;r++)at(t,e[r],n);return n}(p||"*",n.nodeType?[n]:n,[]),h=!d||!t&&p?c:At(c,a,d,n,r),f=g?m||(t?d:l||v)?[]:e:h;if(g&&g(h,f,n,r),v)for(i=At(f,u),v(i,[],n,r),o=i.length;o--;)(s=i[o])&&(f[u[o]]=!(h[u[o]]=s));if(t){if(m||d){if(m){for(i=[],o=f.length;o--;)(s=f[o])&&i.push(h[o]=s);m(null,f=[],i,r)}for(o=f.length;o--;)(s=f[o])&&-1<(i=m?F(t,s):a[o])&&(t[i]=!(e[i]=s))}}else f=At(f===e?f.splice(l,f.length):f),m?m(null,e,f,r):D.apply(e,f)})}function St(t){for(var i,e,n,r=t.length,o=w.relative[t[0].type],s=o||w.relative[" "],a=o?1:0,u=wt(function(t){return t===i},s,!0),l=wt(function(t){return-1<F(i,t)},s,!0),c=[function(t,e,n){var r=!o&&(n||e!==x)||((i=e).nodeType?u(t,e,n):l(t,e,n));return i=null,r}];a<r;a++)if(e=w.relative[t[a].type])c=[wt(xt(c),e)];else{if((e=w.filter[t[a].type].apply(null,t[a].matches))[k]){for(n=++a;n<r&&!w.relative[t[n].type];n++);return _t(1<a&&xt(c),1<a&&bt(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(U,"$1"),e,a<n&&St(t.slice(a,n)),n<r&&St(t=t.slice(n)),n<r&&bt(t))}c.push(e)}return xt(c)}return yt.prototype=w.filters=w.pseudos,w.setFilters=new yt,p=at.tokenize=function(t,e){var n,r,i,o,s,a,u,l=C[t+" "];if(l)return e?0:l.slice(0);for(s=t,a=[],u=w.preFilter;s;){for(o in n&&!(r=$.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=G.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(U," ")}),s=s.slice(n.length)),w.filter)!(r=J[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?at.error(t):C(t,a).slice(0)},f=at.compile=function(t,e){var n,r=[],i=[],o=T[t+" "];if(!o){for(n=(e=e||p(t)).length;n--;)(o=St(e[n]))[k]?r.push(o):i.push(o);(o=T(t,function(v,m){function t(t,e,n,r,i){var o,s,a,u=0,l="0",c=t&&[],h=[],f=x,d=t||b&&w.find.TAG("*",i),p=P+=null==f?1:Math.random()||.1,g=d.length;for(i&&(x=e===_||e||i);l!==g&&null!=(o=d[l]);l++){if(b&&o){for(s=0,e||o.ownerDocument===_||(A(o),n=!S);a=v[s++];)if(a(o,e||_,n)){r.push(o);break}i&&(P=p)}y&&((o=!a&&o)&&u--,t&&c.push(o))}if(u+=l,y&&l!==u){for(s=0;a=m[s++];)a(c,h,e,n);if(t){if(0<u)for(;l--;)c[l]||h[l]||(h[l]=O.call(r));h=At(h)}D.apply(r,h),i&&!t&&0<h.length&&1<u+m.length&&at.uniqueSort(r)}return i&&(P=p,x=f),c}var y=0<m.length,b=0<v.length;return y?lt(t):t}(i,r))).selector=t}return o},g=at.select=function(t,e,n,r){var i,o,s,a,u,l="function"==typeof t&&t,c=!r&&p(t=l.selector||t);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(s=o[0]).type&&9===e.nodeType&&S&&w.relative[o[1].type]){if(!(e=(w.find.ID(s.matches[0].replace(rt,h),e)||[])[0]))return n;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=J.needsContext.test(t)?0:o.length;i--&&(s=o[i],!w.relative[a=s.type]);)if((u=w.find[a])&&(r=u(s.matches[0].replace(rt,h),nt.test(o[0].type)&&mt(e.parentNode)||e))){if(o.splice(i,1),!(t=r.length&&bt(o)))return D.apply(n,r),n;break}}return(l||f(t,c))(r,e,!S,n,!e||nt.test(t)&&mt(e.parentNode)||e),n},d.sortStable=k.split("").sort(L).join("")===k,d.detectDuplicates=!!l,A(),d.sortDetached=ct(function(t){return 1&t.compareDocumentPosition(_.createElement("fieldset"))}),ct(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ht("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),d.attributes&&ct(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ht("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ct(function(t){return null==t.getAttribute("disabled")})||ht(B,function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),at}(_);k.find=d,k.expr=d.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=d.uniqueSort,k.text=d.getText,k.isXMLDoc=d.isXML,k.contains=d.contains,k.escapeSelector=d.escape;function p(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&k(t).is(n))break;r.push(t)}return r}function A(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}var P=k.expr.match.needsContext;function E(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var C=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(t,n,r){return b(n)?k.grep(t,function(t,e){return!!n.call(t,e,t)!==r}):n.nodeType?k.grep(t,function(t){return t===n!==r}):"string"!=typeof n?k.grep(t,function(t){return-1<i.call(n,t)!==r}):k.filter(n,t,r)}k.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?k.find.matchesSelector(r,t)?[r]:[]:k.find.matches(t,k.grep(e,function(t){return 1===t.nodeType}))},k.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(k(t).filter(function(){for(e=0;e<r;e++)if(k.contains(i[e],this))return!0}));for(n=this.pushStack([]),e=0;e<r;e++)k.find(t,i[e],n);return 1<r?k.uniqueSort(n):n},filter:function(t){return this.pushStack(T(this,t||[],!1))},not:function(t){return this.pushStack(T(this,t||[],!0))},is:function(t){return!!T(this,"string"==typeof t&&P.test(t)?k(t):t||[],!1).length}});var N,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(k.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||N,"string"!=typeof t)return t.nodeType?(this[0]=t,this.length=1,this):b(t)?void 0!==n.ready?n.ready(t):t(k):k.makeArray(t,this);if(!(r="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:L.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(e=e instanceof k?e[0]:e,k.merge(this,k.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:S,!0)),C.test(r[1])&&k.isPlainObject(e))for(r in e)b(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return(i=S.getElementById(r[2]))&&(this[0]=i,this.length=1),this}).prototype=k.fn,N=k(S);var M=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function R(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}k.fn.extend({has:function(t){var e=k(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(k.contains(this,e[t]))return!0})},closest:function(t,e){var n,r=0,i=this.length,o=[],s="string"!=typeof t&&k(t);if(!P.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&k.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(1<o.length?k.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?i.call(k(t),this[0]):i.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),k.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return p(t,"parentNode")},parentsUntil:function(t,e,n){return p(t,"parentNode",n)},next:function(t){return R(t,"nextSibling")},prev:function(t){return R(t,"previousSibling")},nextAll:function(t){return p(t,"nextSibling")},prevAll:function(t){return p(t,"previousSibling")},nextUntil:function(t,e,n){return p(t,"nextSibling",n)},prevUntil:function(t,e,n){return p(t,"previousSibling",n)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return void 0!==t.contentDocument?t.contentDocument:(E(t,"template")&&(t=t.content||t),k.merge([],t.childNodes))}},function(r,i){k.fn[r]=function(t,e){var n=k.map(this,i,t);return"Until"!==r.slice(-5)&&(e=t),e&&"string"==typeof e&&(n=k.filter(e,n)),1<this.length&&(O[r]||k.uniqueSort(n),M.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function j(t){return t}function F(t){throw t}function B(t,e,n,r){var i;try{t&&b(i=t.promise)?i.call(t).done(e).fail(n):t&&b(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}k.Callbacks=function(r){r="string"==typeof r?function(t){var n={};return k.each(t.match(D)||[],function(t,e){n[e]=!0}),n}(r):k.extend({},r);function n(){for(o=o||r.once,e=i=!0;a.length;u=-1)for(t=a.shift();++u<s.length;)!1===s[u].apply(t[0],t[1])&&r.stopOnFalse&&(u=s.length,t=!1);r.memory||(t=!1),i=!1,o&&(s=t?[]:"")}var i,t,e,o,s=[],a=[],u=-1,l={add:function(){return s&&(t&&!i&&(u=s.length-1,a.push(t)),function n(t){k.each(t,function(t,e){b(e)?r.unique&&l.has(e)||s.push(e):e&&e.length&&"string"!==x(e)&&n(e)})}(arguments),t&&!i&&n()),this},remove:function(){return k.each(arguments,function(t,e){for(var n;-1<(n=k.inArray(e,s,n));)s.splice(n,1),n<=u&&u--}),this},has:function(t){return t?-1<k.inArray(t,s):0<s.length},empty:function(){return s=s&&[],this},disable:function(){return o=a=[],s=t="",this},disabled:function(){return!s},lock:function(){return o=a=[],t||i||(s=t=""),this},locked:function(){return!!o},fireWith:function(t,e){return o||(e=[t,(e=e||[]).slice?e.slice():e],a.push(e),i||n()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!e}};return l},k.extend({Deferred:function(t){var o=[["notify","progress",k.Callbacks("memory"),k.Callbacks("memory"),2],["resolve","done",k.Callbacks("once memory"),k.Callbacks("once memory"),0,"resolved"],["reject","fail",k.Callbacks("once memory"),k.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(t){return s.then(null,t)},pipe:function(){var i=arguments;return k.Deferred(function(r){k.each(o,function(t,e){var n=b(i[e[4]])&&i[e[4]];a[e[1]](function(){var t=n&&n.apply(this,arguments);t&&b(t.promise)?t.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[e[0]+"With"](this,n?[t]:arguments)})}),i=null}).promise()},then:function(e,n,r){var u=0;function l(i,o,s,a){return function(){function t(){var t,e;if(!(i<u)){if((t=s.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");e=t&&("object"==typeof t||"function"==typeof t)&&t.then,b(e)?a?e.call(t,l(u,o,j,a),l(u,o,F,a)):(u++,e.call(t,l(u,o,j,a),l(u,o,F,a),l(u,o,j,o.notifyWith))):(s!==j&&(n=void 0,r=[t]),(a||o.resolveWith)(n,r))}}var n=this,r=arguments,e=a?t:function(){try{t()}catch(t){k.Deferred.exceptionHook&&k.Deferred.exceptionHook(t,e.stackTrace),u<=i+1&&(s!==F&&(n=void 0,r=[t]),o.rejectWith(n,r))}};i?e():(k.Deferred.getStackHook&&(e.stackTrace=k.Deferred.getStackHook()),_.setTimeout(e))}}return k.Deferred(function(t){o[0][3].add(l(0,t,b(r)?r:j,t.notifyWith)),o[1][3].add(l(0,t,b(e)?e:j)),o[2][3].add(l(0,t,b(n)?n:F))}).promise()},promise:function(t){return null!=t?k.extend(t,s):s}},a={};return k.each(o,function(t,e){var n=e[2],r=e[5];s[e[1]]=n.add,r&&n.add(function(){i=r},o[3-t][2].disable,o[3-t][3].disable,o[0][2].lock,o[0][3].lock),n.add(e[3].fire),a[e[0]]=function(){return a[e[0]+"With"](this===a?void 0:this,arguments),this},a[e[0]+"With"]=n.fireWith}),s.promise(a),t&&t.call(a,a),a},when:function(t){function e(e){return function(t){i[e]=this,o[e]=1<arguments.length?a.call(arguments):t,--n||s.resolveWith(i,o)}}var n=arguments.length,r=n,i=Array(r),o=a.call(arguments),s=k.Deferred();if(n<=1&&(B(t,s.done(e(r)).resolve,s.reject,!n),"pending"===s.state()||b(o[r]&&o[r].then)))return s.then();for(;r--;)B(o[r],e(r),s.reject);return s.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;k.Deferred.exceptionHook=function(t,e){_.console&&_.console.warn&&t&&V.test(t.name)&&_.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},k.readyException=function(t){_.setTimeout(function(){throw t})};var I=k.Deferred();function z(){S.removeEventListener("DOMContentLoaded",z),_.removeEventListener("load",z),k.ready()}k.fn.ready=function(t){return I.then(t).catch(function(t){k.readyException(t)}),this},k.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--k.readyWait:k.isReady)||(k.isReady=!0)!==t&&0<--k.readyWait||I.resolveWith(S,[k])}}),k.ready.then=I.then,"complete"===S.readyState||"loading"!==S.readyState&&!S.documentElement.doScroll?_.setTimeout(k.ready):(S.addEventListener("DOMContentLoaded",z),_.addEventListener("load",z));var q=function(t,e,n,r,i,o,s){var a=0,u=t.length,l=null==n;if("object"===x(n))for(a in i=!0,n)q(t,e,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,b(r)||(s=!0),l&&(e=s?(e.call(t,r),null):(l=e,function(t,e,n){return l.call(k(t),n)})),e))for(;a<u;a++)e(t[a],n,s?r:r.call(t[a],a,e(t[a],n)));return i?t:l?e.call(t):u?e(t[0],n):o},H=/^-ms-/,U=/-([a-z])/g;function $(t,e){return e.toUpperCase()}function G(t){return t.replace(H,"ms-").replace(U,$)}function W(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}function X(){this.expando=k.expando+X.uid++}X.uid=1,X.prototype={cache:function(t){var e=t[this.expando];return e||(e={},W(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[G(e)]=n;else for(r in e)i[G(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][G(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){n=(e=Array.isArray(e)?e.map(G):(e=G(e))in r?[e]:e.match(D)||[]).length;for(;n--;)delete r[e[n]]}void 0!==e&&!k.isEmptyObject(r)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!k.isEmptyObject(e)}};var Y=new X,J=new X,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Q(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(K,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Z.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}k.extend({hasData:function(t){return J.hasData(t)||Y.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return Y.access(t,e,n)},_removeData:function(t,e){Y.remove(t,e)}}),k.fn.extend({data:function(n,t){var e,r,i,o=this[0],s=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){J.set(this,n)}):q(this,function(t){var e;if(o&&void 0===t)return void 0!==(e=J.get(o,n))?e:void 0!==(e=Q(o,n))?e:void 0;this.each(function(){J.set(this,n,t)})},null,t,1<arguments.length,null,!0);if(this.length&&(i=J.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(e=s.length;e--;)s[e]&&0===(r=s[e].name).indexOf("data-")&&(r=G(r.slice(5)),Q(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i},removeData:function(t){return this.each(function(){J.remove(this,t)})}}),k.extend({queue:function(t,e,n){var r;if(t)return e=(e||"fx")+"queue",r=Y.get(t,e),n&&(!r||Array.isArray(n)?r=Y.access(t,e,k.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){e=e||"fx";var n=k.queue(t,e),r=n.length,i=n.shift(),o=k._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,function(){k.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Y.get(t,n)||Y.access(t,n,{empty:k.Callbacks("once memory").add(function(){Y.remove(t,[e+"queue",n])})})}}),k.fn.extend({queue:function(e,n){var t=2;return"string"!=typeof e&&(n=e,e="fx",t--),arguments.length<t?k.queue(this[0],e):void 0===n?this:this.each(function(){var t=k.queue(this,e,n);k._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&k.dequeue(this,e)})},dequeue:function(t){return this.each(function(){k.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function n(){--i||o.resolveWith(s,[s])}var r,i=1,o=k.Deferred(),s=this,a=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(r=Y.get(s[a],t+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],rt=S.documentElement,it=function(t){return k.contains(t.ownerDocument,t)},ot={composed:!0};rt.getRootNode&&(it=function(t){return k.contains(t.ownerDocument,t)||t.getRootNode(ot)===t.ownerDocument});function st(t,e,n,r){var i,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in i=n.apply(t,r||[]),e)t.style[o]=s[o];return i}var at=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&it(t)&&"none"===k.css(t,"display")};function ut(t,e,n,r){var i,o,s=20,a=r?function(){return r.cur()}:function(){return k.css(t,e,"")},u=a(),l=n&&n[3]||(k.cssNumber[e]?"":"px"),c=t.nodeType&&(k.cssNumber[e]||"px"!==l&&+u)&&et.exec(k.css(t,e));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;s--;)k.style(t,e,c+l),(1-o)*(1-(o=a()/u||.5))<=0&&(s=0),c/=o;c*=2,k.style(t,e,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var lt={};function ct(t,e){for(var n,r,i,o,s,a,u,l=[],c=0,h=t.length;c<h;c++)(r=t[c]).style&&(n=r.style.display,e?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&at(r)&&(l[c]=(u=s=o=void 0,s=(i=r).ownerDocument,a=i.nodeName,(u=lt[a])||(o=s.body.appendChild(s.createElement(a)),u=k.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),lt[a]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<h;c++)null!=l[c]&&(t[c].style.display=l[c]);return t}k.fn.extend({show:function(){return ct(this,!0)},hide:function(){return ct(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){at(this)?k(this).show():k(this).hide()})}});var ht=/^(?:checkbox|radio)$/i,ft=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,dt=/^$|^module$|\/(?:java|ecma)script/i,pt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&E(t,e)?k.merge([t],n):n}function vt(t,e){for(var n=0,r=t.length;n<r;n++)Y.set(t[n],"globalEval",!e||Y.get(e[n],"globalEval"))}pt.optgroup=pt.option,pt.tbody=pt.tfoot=pt.colgroup=pt.caption=pt.thead,pt.th=pt.td;var mt,yt,bt=/<|&#?\w+;/;function wt(t,e,n,r,i){for(var o,s,a,u,l,c,h=e.createDocumentFragment(),f=[],d=0,p=t.length;d<p;d++)if((o=t[d])||0===o)if("object"===x(o))k.merge(f,o.nodeType?[o]:o);else if(bt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(ft.exec(o)||["",""])[1].toLowerCase(),u=pt[a]||pt._default,s.innerHTML=u[1]+k.htmlPrefilter(o)+u[2],c=u[0];c--;)s=s.lastChild;k.merge(f,s.childNodes),(s=h.firstChild).textContent=""}else f.push(e.createTextNode(o));for(h.textContent="",d=0;o=f[d++];)if(r&&-1<k.inArray(o,r))i&&i.push(o);else if(l=it(o),s=gt(h.appendChild(o),"script"),l&&vt(s),n)for(c=0;o=s[c++];)dt.test(o.type||"")&&n.push(o);return h}mt=S.createDocumentFragment().appendChild(S.createElement("div")),(yt=S.createElement("input")).setAttribute("type","radio"),yt.setAttribute("checked","checked"),yt.setAttribute("name","t"),mt.appendChild(yt),y.checkClone=mt.cloneNode(!0).cloneNode(!0).lastChild.checked,mt.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!mt.cloneNode(!0).lastChild.defaultValue;var xt=/^key/,At=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_t=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function kt(){return!1}function Pt(t,e){return t===function(){try{return S.activeElement}catch(t){}}()==("focus"===e)}function Et(t,e,n,r,i,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(r=r||n,n=void 0),e)Et(t,a,n,r,e[a],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=kt;else if(!i)return t;return 1===o&&(s=i,(i=function(t){return k().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=k.guid++)),t.each(function(){k.event.add(this,e,i,r,n)})}function Ct(t,i,o){o?(Y.set(t,i,!1),k.event.add(t,i,{namespace:!1,handler:function(t){var e,n,r=Y.get(this,i);if(1&t.isTrigger&&this[i]){if(r.length)(k.event.special[i]||{}).delegateType&&t.stopPropagation();else if(r=a.call(arguments),Y.set(this,i,r),e=o(this,i),this[i](),r!==(n=Y.get(this,i))||e?Y.set(this,i,!1):n={},r!==n)return t.stopImmediatePropagation(),t.preventDefault(),n.value}else r.length&&(Y.set(this,i,{value:k.event.trigger(k.extend(r[0],k.Event.prototype),r.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Y.get(t,i)&&k.event.add(t,i,St)}k.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,l,c,h,f,d,p,g,v=Y.get(e);if(v)for(n.handler&&(n=(o=n).handler,i=o.selector),i&&k.find.matchesSelector(rt,i),n.guid||(n.guid=k.guid++),(u=v.events)||(u=v.events={}),(s=v.handle)||(s=v.handle=function(t){return void 0!==k&&k.event.triggered!==t.type?k.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(D)||[""]).length;l--;)d=g=(a=_t.exec(t[l])||[])[1],p=(a[2]||"").split(".").sort(),d&&(h=k.event.special[d]||{},d=(i?h.delegateType:h.bindType)||d,h=k.event.special[d]||{},c=k.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&k.expr.match.needsContext.test(i),namespace:p.join(".")},o),(f=u[d])||((f=u[d]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,r,p,s)||e.addEventListener&&e.addEventListener(d,s)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,c):f.push(c),k.event.global[d]=!0)},remove:function(t,e,n,r,i){var o,s,a,u,l,c,h,f,d,p,g,v=Y.hasData(t)&&Y.get(t);if(v&&(u=v.events)){for(l=(e=(e||"").match(D)||[""]).length;l--;)if(d=g=(a=_t.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),d){for(h=k.event.special[d]||{},f=u[d=(r?h.delegateType:h.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;o--;)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,h.remove&&h.remove.call(t,c));s&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,p,v.handle)||k.removeEvent(t,d,v.handle),delete u[d])}else for(d in u)k.event.remove(t,d+e[l],n,r,!0);k.isEmptyObject(u)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,o,s,a=k.event.fix(t),u=new Array(arguments.length),l=(Y.get(this,"events")||{})[a.type]||[],c=k.event.special[a.type]||{};for(u[0]=a,e=1;e<arguments.length;e++)u[e]=arguments[e];if(a.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,a)){for(s=k.event.handlers.call(this,a,l),e=0;(i=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==o.namespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(r=((k.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(a.result=r)&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(t,e){var n,r,i,o,s,a=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&1<=t.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],s={},n=0;n<u;n++)void 0===s[i=(r=e[n]).selector+" "]&&(s[i]=r.needsContext?-1<k(i,this).index(l):k.find(i,this,null,[l]).length),s[i]&&o.push(r);o.length&&a.push({elem:l,handlers:o})}return l=this,u<e.length&&a.push({elem:l,handlers:e.slice(u)}),a},addProp:function(e,t){Object.defineProperty(k.Event.prototype,e,{enumerable:!0,configurable:!0,get:b(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(t){return t[k.expando]?t:new k.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return ht.test(e.type)&&e.click&&E(e,"input")&&Ct(e,"click",St),!1},trigger:function(t){var e=this||t;return ht.test(e.type)&&e.click&&E(e,"input")&&Ct(e,"click"),!0},_default:function(t){var e=t.target;return ht.test(e.type)&&e.click&&E(e,"input")&&Y.get(e,"click")||E(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},k.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},k.Event=function(t,e){if(!(this instanceof k.Event))return new k.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:kt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&k.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[k.expando]=!0},k.Event.prototype={constructor:k.Event,isDefaultPrevented:kt,isPropagationStopped:kt,isImmediatePropagationStopped:kt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},k.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&xt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&At.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},k.event.addProp),k.each({focus:"focusin",blur:"focusout"},function(t,e){k.event.special[t]={setup:function(){return Ct(this,t,Pt),!1},trigger:function(){return Ct(this,t),!0},delegateType:e}}),k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,i){k.event.special[t]={delegateType:i,bindType:i,handle:function(t){var e,n=t.relatedTarget,r=t.handleObj;return n&&(n===this||k.contains(this,n))||(t.type=r.origType,e=r.handler.apply(this,arguments),t.type=i),e}}}),k.fn.extend({on:function(t,e,n,r){return Et(this,t,e,n,r)},one:function(t,e,n,r){return Et(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,k(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=kt),this.each(function(){k.event.remove(this,t,n,e)});for(i in t)this.off(i,e,t[i]);return this}});var Tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Nt=/<script|<style|<link/i,Lt=/checked\s*(?:[^=]|=\s*.checked.)/i,Mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ot(t,e){return E(t,"table")&&E(11!==e.nodeType?e:e.firstChild,"tr")&&k(t).children("tbody")[0]||t}function Rt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Dt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function jt(t,e){var n,r,i,o,s,a,u,l;if(1===e.nodeType){if(Y.hasData(t)&&(o=Y.access(t),s=Y.set(e,o),l=o.events))for(i in delete s.handle,s.events={},l)for(n=0,r=l[i].length;n<r;n++)k.event.add(e,i,l[i][n]);J.hasData(t)&&(a=J.access(t),u=k.extend({},a),J.set(e,u))}}function Ft(n,r,i,o){r=v.apply([],r);var t,e,s,a,u,l,c=0,h=n.length,f=h-1,d=r[0],p=b(d);if(p||1<h&&"string"==typeof d&&!y.checkClone&&Lt.test(d))return n.each(function(t){var e=n.eq(t);p&&(r[0]=d.call(this,t,e.html())),Ft(e,r,i,o)});if(h&&(e=(t=wt(r,n[0].ownerDocument,!1,n,o)).firstChild,1===t.childNodes.length&&(t=e),e||o)){for(a=(s=k.map(gt(t,"script"),Rt)).length;c<h;c++)u=t,c!==f&&(u=k.clone(u,!0,!0),a&&k.merge(s,gt(u,"script"))),i.call(n[c],u,c);if(a)for(l=s[s.length-1].ownerDocument,k.map(s,Dt),c=0;c<a;c++)u=s[c],dt.test(u.type||"")&&!Y.access(u,"globalEval")&&k.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?k._evalUrl&&!u.noModule&&k._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")}):w(u.textContent.replace(Mt,""),u,l))}return n}function Bt(t,e,n){for(var r,i=e?k.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||k.cleanData(gt(r)),r.parentNode&&(n&&it(r)&&vt(gt(r,"script")),r.parentNode.removeChild(r));return t}k.extend({htmlPrefilter:function(t){return t.replace(Tt,"<$1></$2>")},clone:function(t,e,n){var r,i,o,s,a,u,l,c=t.cloneNode(!0),h=it(t);if(!(y.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||k.isXMLDoc(t)))for(s=gt(c),r=0,i=(o=gt(t)).length;r<i;r++)a=o[r],u=s[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&ht.test(a.type)?u.checked=a.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=a.defaultValue);if(e)if(n)for(o=o||gt(t),s=s||gt(c),r=0,i=o.length;r<i;r++)jt(o[r],s[r]);else jt(t,c);return 0<(s=gt(c,"script")).length&&vt(s,!h&&gt(t,"script")),c},cleanData:function(t){for(var e,n,r,i=k.event.special,o=0;void 0!==(n=t[o]);o++)if(W(n)){if(e=n[Y.expando]){if(e.events)for(r in e.events)i[r]?k.event.remove(n,r):k.removeEvent(n,r,e.handle);n[Y.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),k.fn.extend({detach:function(t){return Bt(this,t,!0)},remove:function(t){return Bt(this,t)},text:function(t){return q(this,function(t){return void 0===t?k.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Ft(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ot(this,t).appendChild(t)})},prepend:function(){return Ft(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ot(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Ft(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Ft(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(k.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return k.clone(this,t,e)})},html:function(t){return q(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Nt.test(t)&&!pt[(ft.exec(t)||["",""])[1].toLowerCase()]){t=k.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(k.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var n=[];return Ft(this,arguments,function(t){var e=this.parentNode;k.inArray(this,n)<0&&(k.cleanData(gt(this)),e&&e.replaceChild(t,this))},n)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,s){k.fn[t]=function(t){for(var e,n=[],r=k(t),i=r.length-1,o=0;o<=i;o++)e=o===i?this:this.clone(!0),k(r[o])[s](e),u.apply(n,e.get());return this.pushStack(n)}});var Vt,It,zt,qt,Ht,Ut,$t,Gt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),Wt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=_),e.getComputedStyle(t)},Xt=new RegExp(nt.join("|"),"i");function Yt(){if($t){Ut.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",$t.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",rt.appendChild(Ut).appendChild($t);var t=_.getComputedStyle($t);Vt="1%"!==t.top,Ht=12===Jt(t.marginLeft),$t.style.right="60%",qt=36===Jt(t.right),It=36===Jt(t.width),$t.style.position="absolute",zt=12===Jt($t.offsetWidth/3),rt.removeChild(Ut),$t=null}}function Jt(t){return Math.round(parseFloat(t))}function Zt(t,e,n){var r,i,o,s,a=t.style;return(n=n||Wt(t))&&(""!==(s=n.getPropertyValue(e)||n[e])||it(t)||(s=k.style(t,e)),!y.pixelBoxStyles()&&Gt.test(s)&&Xt.test(e)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function Kt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}Ut=S.createElement("div"),($t=S.createElement("div")).style&&($t.style.backgroundClip="content-box",$t.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===$t.style.backgroundClip,k.extend(y,{boxSizingReliable:function(){return Yt(),It},pixelBoxStyles:function(){return Yt(),qt},pixelPosition:function(){return Yt(),Vt},reliableMarginLeft:function(){return Yt(),Ht},scrollboxSize:function(){return Yt(),zt}}));var Qt=["Webkit","Moz","ms"],te=S.createElement("div").style,ee={};function ne(t){var e=k.cssProps[t]||ee[t];return e||(t in te?t:ee[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Qt.length;n--;)if((t=Qt[n]+e)in te)return t}(t)||t)}var re=/^(none|table(?!-c[ea]).+)/,ie=/^--/,oe={position:"absolute",visibility:"hidden",display:"block"},se={letterSpacing:"0",fontWeight:"400"};function ae(t,e,n){var r=et.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function ue(t,e,n,r,i,o){var s="width"===e?1:0,a=0,u=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(u+=k.css(t,n+nt[s],!0,i)),r?("content"===n&&(u-=k.css(t,"padding"+nt[s],!0,i)),"margin"!==n&&(u-=k.css(t,"border"+nt[s]+"Width",!0,i))):(u+=k.css(t,"padding"+nt[s],!0,i),"padding"!==n?u+=k.css(t,"border"+nt[s]+"Width",!0,i):a+=k.css(t,"border"+nt[s]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-u-a-.5))||0),u}function le(t,e,n){var r=Wt(t),i=(!y.boxSizingReliable()||n)&&"border-box"===k.css(t,"boxSizing",!1,r),o=i,s=Zt(t,e,r),a="offset"+e[0].toUpperCase()+e.slice(1);if(Gt.test(s)){if(!n)return s;s="auto"}return(!y.boxSizingReliable()&&i||"auto"===s||!parseFloat(s)&&"inline"===k.css(t,"display",!1,r))&&t.getClientRects().length&&(i="border-box"===k.css(t,"boxSizing",!1,r),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+ue(t,e,n||(i?"border":"content"),o,r,s)+"px"}function ce(t,e,n,r,i){return new ce.prototype.init(t,e,n,r,i)}k.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Zt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,s,a=G(e),u=ie.test(e),l=t.style;if(u||(e=ne(a)),s=k.cssHooks[e]||k.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(t,!1,r))?i:l[e];"string"===(o=typeof n)&&(i=et.exec(n))&&i[1]&&(n=ut(t,e,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(k.cssNumber[a]?"":"px")),y.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,r))||(u?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,r){var i,o,s,a=G(e);return ie.test(e)||(e=ne(a)),(s=k.cssHooks[e]||k.cssHooks[a])&&"get"in s&&(i=s.get(t,!0,n)),void 0===i&&(i=Zt(t,e,r)),"normal"===i&&e in se&&(i=se[e]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),k.each(["height","width"],function(t,u){k.cssHooks[u]={get:function(t,e,n){if(e)return!re.test(k.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?le(t,u,n):st(t,oe,function(){return le(t,u,n)})},set:function(t,e,n){var r,i=Wt(t),o=!y.scrollboxSize()&&"absolute"===i.position,s=(o||n)&&"border-box"===k.css(t,"boxSizing",!1,i),a=n?ue(t,u,n,s,i):0;return s&&o&&(a-=Math.ceil(t["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-ue(t,u,"border",!1,i)-.5)),a&&(r=et.exec(e))&&"px"!==(r[3]||"px")&&(t.style[u]=e,e=k.css(t,u)),ae(0,e,a)}}}),k.cssHooks.marginLeft=Kt(y.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Zt(t,"marginLeft"))||t.getBoundingClientRect().left-st(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),k.each({margin:"",padding:"",border:"Width"},function(i,o){k.cssHooks[i+o]={expand:function(t){for(var e=0,n={},r="string"==typeof t?t.split(" "):[t];e<4;e++)n[i+nt[e]+o]=r[e]||r[e-2]||r[0];return n}},"margin"!==i&&(k.cssHooks[i+o].set=ae)}),k.fn.extend({css:function(t,e){return q(this,function(t,e,n){var r,i,o={},s=0;if(Array.isArray(e)){for(r=Wt(t),i=e.length;s<i;s++)o[e[s]]=k.css(t,e[s],!1,r);return o}return void 0!==n?k.style(t,e,n):k.css(t,e)},t,e,1<arguments.length)}}),((k.Tween=ce).prototype={constructor:ce,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||k.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(k.cssNumber[n]?"":"px")},cur:function(){var t=ce.propHooks[this.prop];return t&&t.get?t.get(this):ce.propHooks._default.get(this)},run:function(t){var e,n=ce.propHooks[this.prop];return this.options.duration?this.pos=e=k.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ce.propHooks._default.set(this),this}}).init.prototype=ce.prototype,(ce.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=k.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){k.fx.step[t.prop]?k.fx.step[t.prop](t):1!==t.elem.nodeType||!k.cssHooks[t.prop]&&null==t.elem.style[ne(t.prop)]?t.elem[t.prop]=t.now:k.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=ce.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},k.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},k.fx=ce.prototype.init,k.fx.step={};var he,fe,de,pe,ge=/^(?:toggle|show|hide)$/,ve=/queueHooks$/;function me(){fe&&(!1===S.hidden&&_.requestAnimationFrame?_.requestAnimationFrame(me):_.setTimeout(me,k.fx.interval),k.fx.tick())}function ye(){return _.setTimeout(function(){he=void 0}),he=Date.now()}function be(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=nt[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function we(t,e,n){for(var r,i=(xe.tweeners[e]||[]).concat(xe.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,e,t))return r}function xe(o,t,e){var n,s,r=0,i=xe.prefilters.length,a=k.Deferred().always(function(){delete u.elem}),u=function(){if(s)return!1;for(var t=he||ye(),e=Math.max(0,l.startTime+l.duration-t),n=1-(e/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return a.notifyWith(o,[l,n,e]),n<1&&i?e:(i||a.notifyWith(o,[l,1,0]),a.resolveWith(o,[l]),!1)},l=a.promise({elem:o,props:k.extend({},t),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},e),originalProperties:t,originalOptions:e,startTime:he||ye(),duration:e.duration,tweens:[],createTween:function(t,e){var n=k.Tween(o,l.opts,t,e,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var e=0,n=t?l.tweens.length:0;if(s)return this;for(s=!0;e<n;e++)l.tweens[e].run(1);return t?(a.notifyWith(o,[l,1,0]),a.resolveWith(o,[l,t])):a.rejectWith(o,[l,t]),this}}),c=l.props;for(!function(t,e){var n,r,i,o,s;for(n in t)if(i=e[r=G(n)],o=t[n],Array.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(s=k.cssHooks[r])&&"expand"in s)for(n in o=s.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=xe.prefilters[r].call(l,o,c,l.opts))return b(n.stop)&&(k._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return k.map(c,we,l),b(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),k.fx.timer(k.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}k.Animation=k.extend(xe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ut(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){for(var n,r=0,i=(t=b(t)?(e=t,["*"]):t.match(D)).length;r<i;r++)n=t[r],xe.tweeners[n]=xe.tweeners[n]||[],xe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var r,i,o,s,a,u,l,c,h="width"in e||"height"in e,f=this,d={},p=t.style,g=t.nodeType&&at(t),v=Y.get(t,"fxshow");for(r in n.queue||(null==(s=k._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,f.always(function(){f.always(function(){s.unqueued--,k.queue(t,"fx").length||s.empty.fire()})})),e)if(i=e[r],ge.test(i)){if(delete e[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||k.style(t,r)}if((u=!k.isEmptyObject(e))||!k.isEmptyObject(d))for(r in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=v&&v.display)&&(l=Y.get(t,"display")),"none"===(c=k.css(t,"display"))&&(l?c=l:(ct([t],!0),l=t.style.display||l,c=k.css(t,"display"),ct([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===k.css(t,"float")&&(u||(f.done(function(){p.display=l}),null==l&&(c=p.display,l="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",f.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(t,"fxshow",{display:l}),o&&(v.hidden=!g),g&&ct([t],!0),f.done(function(){for(r in g||ct([t]),Y.remove(t,"fxshow"),d)k.style(t,r,d[r])})),u=we(g?v[r]:0,r,f),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?xe.prefilters.unshift(t):xe.prefilters.push(t)}}),k.speed=function(t,e,n){var r=t&&"object"==typeof t?k.extend({},t):{complete:n||!n&&e||b(t)&&t,duration:t,easing:n&&e||e&&!b(e)&&e};return k.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in k.fx.speeds?r.duration=k.fx.speeds[r.duration]:r.duration=k.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){b(r.old)&&r.old.call(this),r.queue&&k.dequeue(this,r.queue)},r},k.fn.extend({fadeTo:function(t,e,n,r){return this.filter(at).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(e,t,n,r){function i(){var t=xe(this,k.extend({},e),s);(o||Y.get(this,"finish"))&&t.stop(!0)}var o=k.isEmptyObject(e),s=k.speed(t,n,r);return i.finish=i,o||!1===s.queue?this.each(i):this.queue(s.queue,i)},stop:function(i,t,o){function s(t){var e=t.stop;delete t.stop,e(o)}return"string"!=typeof i&&(o=t,t=i,i=void 0),t&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var t=!0,e=null!=i&&i+"queueHooks",n=k.timers,r=Y.get(this);if(e)r[e]&&r[e].stop&&s(r[e]);else for(e in r)r[e]&&r[e].stop&&ve.test(e)&&s(r[e]);for(e=n.length;e--;)n[e].elem!==this||null!=i&&n[e].queue!==i||(n[e].anim.stop(o),t=!1,n.splice(e,1));!t&&o||k.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var t,e=Y.get(this),n=e[s+"queue"],r=e[s+"queueHooks"],i=k.timers,o=n?n.length:0;for(e.finish=!0,k.queue(this,s,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===s&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete e.finish})}}),k.each(["toggle","show","hide"],function(t,r){var i=k.fn[r];k.fn[r]=function(t,e,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(be(r,!0),t,e,n)}}),k.each({slideDown:be("show"),slideUp:be("hide"),slideToggle:be("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,r){k.fn[t]=function(t,e,n){return this.animate(r,t,e,n)}}),k.timers=[],k.fx.tick=function(){var t,e=0,n=k.timers;for(he=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||k.fx.stop(),he=void 0},k.fx.timer=function(t){k.timers.push(t),k.fx.start()},k.fx.interval=13,k.fx.start=function(){fe||(fe=!0,me())},k.fx.stop=function(){fe=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(r,t){return r=k.fx&&k.fx.speeds[r]||r,t=t||"fx",this.queue(t,function(t,e){var n=_.setTimeout(t,r);e.stop=function(){_.clearTimeout(n)}})},de=S.createElement("input"),pe=S.createElement("select").appendChild(S.createElement("option")),de.type="checkbox",y.checkOn=""!==de.value,y.optSelected=pe.selected,(de=S.createElement("input")).value="t",de.type="radio",y.radioValue="t"===de.value;var Ae,_e=k.expr.attrHandle;k.fn.extend({attr:function(t,e){return q(this,k.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){k.removeAttr(this,t)})}}),k.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?k.prop(t,e,n):(1===o&&k.isXMLDoc(t)||(i=k.attrHooks[e.toLowerCase()]||(k.expr.match.bool.test(e)?Ae:void 0)),void 0!==n?null===n?void k.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=k.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!y.radioValue&&"radio"===e&&E(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(D);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),Ae={set:function(t,e,n){return!1===e?k.removeAttr(t,n):t.setAttribute(n,n),n}},k.each(k.expr.match.bool.source.match(/\w+/g),function(t,e){var s=_e[e]||k.find.attr;_e[e]=function(t,e,n){var r,i,o=e.toLowerCase();return n||(i=_e[o],_e[o]=r,r=null!=s(t,e,n)?o:null,_e[o]=i),r}});var Se=/^(?:input|select|textarea|button)$/i,ke=/^(?:a|area)$/i;function Pe(t){return(t.match(D)||[]).join(" ")}function Ee(t){return t.getAttribute&&t.getAttribute("class")||""}function Ce(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(D)||[]}k.fn.extend({prop:function(t,e){return q(this,k.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[k.propFix[t]||t]})}}),k.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&k.isXMLDoc(t)||(e=k.propFix[e]||e,i=k.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=k.find.attr(t,"tabindex");return e?parseInt(e,10):Se.test(t.nodeName)||ke.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),y.optSelected||(k.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){k.propFix[this.toLowerCase()]=this}),k.fn.extend({addClass:function(e){var t,n,r,i,o,s,a,u=0;if(b(e))return this.each(function(t){k(this).addClass(e.call(this,t,Ee(this)))});if((t=Ce(e)).length)for(;n=this[u++];)if(i=Ee(n),r=1===n.nodeType&&" "+Pe(i)+" "){for(s=0;o=t[s++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(a=Pe(r))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,r,i,o,s,a,u=0;if(b(e))return this.each(function(t){k(this).removeClass(e.call(this,t,Ee(this)))});if(!arguments.length)return this.attr("class","");if((t=Ce(e)).length)for(;n=this[u++];)if(i=Ee(n),r=1===n.nodeType&&" "+Pe(i)+" "){for(s=0;o=t[s++];)for(;-1<r.indexOf(" "+o+" ");)r=r.replace(" "+o+" "," ");i!==(a=Pe(r))&&n.setAttribute("class",a)}return this},toggleClass:function(i,e){var o=typeof i,s="string"==o||Array.isArray(i);return"boolean"==typeof e&&s?e?this.addClass(i):this.removeClass(i):b(i)?this.each(function(t){k(this).toggleClass(i.call(this,t,Ee(this),e),e)}):this.each(function(){var t,e,n,r;if(s)for(e=0,n=k(this),r=Ce(i);t=r[e++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else void 0!==i&&"boolean"!=o||((t=Ee(this))&&Y.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&-1<(" "+Pe(Ee(n))+" ").indexOf(e))return!0;return!1}});var Te=/\r/g;k.fn.extend({val:function(n){var r,t,i,e=this[0];return arguments.length?(i=b(n),this.each(function(t){var e;1===this.nodeType&&(null==(e=i?n.call(this,t,k(this).val()):n)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=k.map(e,function(t){return null==t?"":t+""})),(r=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,e,"value")||(this.value=e))})):e?(r=k.valHooks[e.type]||k.valHooks[e.nodeName.toLowerCase()])&&"get"in r&&void 0!==(t=r.get(e,"value"))?t:"string"==typeof(t=e.value)?t.replace(Te,""):null==t?"":t:void 0}}),k.extend({valHooks:{option:{get:function(t){var e=k.find.attr(t,"value");return null!=e?e:Pe(k.text(t))}},select:{get:function(t){var e,n,r,i=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],u=s?o+1:i.length;for(r=o<0?u:s?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!E(n.parentNode,"optgroup"))){if(e=k(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,r,i=t.options,o=k.makeArray(e),s=i.length;s--;)((r=i[s]).selected=-1<k.inArray(k.valHooks.option.get(r),o))&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<k.inArray(k(t).val(),e)}},y.checkOn||(k.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),y.focusin="onfocusin"in _;function Ne(t){t.stopPropagation()}var Le=/^(?:focusinfocus|focusoutblur)$/;k.extend(k.event,{trigger:function(t,e,n,r){var i,o,s,a,u,l,c,h,f=[n||S],d=m.call(t,"type")?t.type:t,p=m.call(t,"namespace")?t.namespace.split("."):[];if(o=h=s=n=n||S,3!==n.nodeType&&8!==n.nodeType&&!Le.test(d+k.event.triggered)&&(-1<d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),u=d.indexOf(":")<0&&"on"+d,(t=t[k.expando]?t:new k.Event(d,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:k.makeArray(e,[t]),c=k.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,e))){if(!r&&!c.noBubble&&!g(n)){for(a=c.delegateType||d,Le.test(a+d)||(o=o.parentNode);o;o=o.parentNode)f.push(o),s=o;s===(n.ownerDocument||S)&&f.push(s.defaultView||s.parentWindow||_)}for(i=0;(o=f[i++])&&!t.isPropagationStopped();)h=o,t.type=1<i?a:c.bindType||d,(l=(Y.get(o,"events")||{})[t.type]&&Y.get(o,"handle"))&&l.apply(o,e),(l=u&&o[u])&&l.apply&&W(o)&&(t.result=l.apply(o,e),!1===t.result&&t.preventDefault());return t.type=d,r||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(f.pop(),e)||!W(n)||u&&b(n[d])&&!g(n)&&((s=n[u])&&(n[u]=null),k.event.triggered=d,t.isPropagationStopped()&&h.addEventListener(d,Ne),n[d](),t.isPropagationStopped()&&h.removeEventListener(d,Ne),k.event.triggered=void 0,s&&(n[u]=s)),t.result}},simulate:function(t,e,n){var r=k.extend(new k.Event,n,{type:t,isSimulated:!0});k.event.trigger(r,null,e)}}),k.fn.extend({trigger:function(t,e){return this.each(function(){k.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return k.event.trigger(t,e,n,!0)}}),y.focusin||k.each({focus:"focusin",blur:"focusout"},function(n,r){function i(t){k.event.simulate(r,t.target,k.event.fix(t))}k.event.special[r]={setup:function(){var t=this.ownerDocument||this,e=Y.access(t,r);e||t.addEventListener(n,i,!0),Y.access(t,r,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=Y.access(t,r)-1;e?Y.access(t,r,e):(t.removeEventListener(n,i,!0),Y.remove(t,r))}}});var Me=_.location,Oe=Date.now(),Re=/\?/;k.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new _.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||k.error("Invalid XML: "+t),e};var De=/\[\]$/,je=/\r?\n/g,Fe=/^(?:submit|button|image|reset|file)$/i,Be=/^(?:input|select|textarea|keygen)/i;function Ve(n,t,r,i){var e;if(Array.isArray(t))k.each(t,function(t,e){r||De.test(n)?i(n,e):Ve(n+"["+("object"==typeof e&&null!=e?t:"")+"]",e,r,i)});else if(r||"object"!==x(t))i(n,t);else for(e in t)Ve(n+"["+e+"]",t[e],r,i)}k.param=function(t,e){function n(t,e){var n=b(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)}var r,i=[];if(null==t)return"";if(Array.isArray(t)||t.jquery&&!k.isPlainObject(t))k.each(t,function(){n(this.name,this.value)});else for(r in t)Ve(r,t[r],e,n);return i.join("&")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=k.prop(this,"elements");return t?k.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!k(this).is(":disabled")&&Be.test(this.nodeName)&&!Fe.test(t)&&(this.checked||!ht.test(t))}).map(function(t,e){var n=k(this).val();return null==n?null:Array.isArray(n)?k.map(n,function(t){return{name:e.name,value:t.replace(je,"\r\n")}}):{name:e.name,value:n.replace(je,"\r\n")}}).get()}});var Ie=/%20/g,ze=/#.*$/,qe=/([?&])_=[^&]*/,He=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ue=/^(?:GET|HEAD)$/,$e=/^\/\//,Ge={},We={},Xe="*/".concat("*"),Ye=S.createElement("a");function Je(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var n,r=0,i=t.toLowerCase().match(D)||[];if(b(e))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(e)):(o[n]=o[n]||[]).push(e)}}function Ze(e,i,o,s){var a={},u=e===We;function l(t){var r;return a[t]=!0,k.each(e[t]||[],function(t,e){var n=e(i,o,s);return"string"!=typeof n||u||a[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!a["*"]&&l("*")}function Ke(t,e){var n,r,i=k.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r=r||{})[n]=e[n]);return r&&k.extend(!0,t,r),t}Ye.href=Me.href,k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Me.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Me.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ke(Ke(t,k.ajaxSettings),e):Ke(k.ajaxSettings,t)},ajaxPrefilter:Je(Ge),ajaxTransport:Je(We),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var c,h,f,n,d,r,p,g,i,o,v=k.ajaxSetup({},e),m=v.context||v,y=v.context&&(m.nodeType||m.jquery)?k(m):k.event,b=k.Deferred(),w=k.Callbacks("once memory"),x=v.statusCode||{},s={},a={},u="canceled",A={readyState:0,getResponseHeader:function(t){var e;if(p){if(!n)for(n={};e=He.exec(f);)n[e[1].toLowerCase()+" "]=(n[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=n[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return p?f:null},setRequestHeader:function(t,e){return null==p&&(t=a[t.toLowerCase()]=a[t.toLowerCase()]||t,s[t]=e),this},overrideMimeType:function(t){return null==p&&(v.mimeType=t),this},statusCode:function(t){var e;if(t)if(p)A.always(t[A.status]);else for(e in t)x[e]=[x[e],t[e]];return this},abort:function(t){var e=t||u;return c&&c.abort(e),l(0,e),this}};if(b.promise(A),v.url=((t||v.url||Me.href)+"").replace($e,Me.protocol+"//"),v.type=e.method||e.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||[""],null==v.crossDomain){r=S.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Ye.protocol+"//"+Ye.host!=r.protocol+"//"+r.host}catch(t){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=k.param(v.data,v.traditional)),Ze(Ge,v,e,A),p)return A;for(i in(g=k.event&&v.global)&&0==k.active++&&k.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ue.test(v.type),h=v.url.replace(ze,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Ie,"+")):(o=v.url.slice(h.length),v.data&&(v.processData||"string"==typeof v.data)&&(h+=(Re.test(h)?"&":"?")+v.data,delete v.data),!1===v.cache&&(h=h.replace(qe,"$1"),o=(Re.test(h)?"&":"?")+"_="+Oe+++o),v.url=h+o),v.ifModified&&(k.lastModified[h]&&A.setRequestHeader("If-Modified-Since",k.lastModified[h]),k.etag[h]&&A.setRequestHeader("If-None-Match",k.etag[h])),(v.data&&v.hasContent&&!1!==v.contentType||e.contentType)&&A.setRequestHeader("Content-Type",v.contentType),A.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Xe+"; q=0.01":""):v.accepts["*"]),v.headers)A.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(m,A,v)||p))return A.abort();if(u="abort",w.add(v.complete),A.done(v.success),A.fail(v.error),c=Ze(We,v,e,A)){if(A.readyState=1,g&&y.trigger("ajaxSend",[A,v]),p)return A;v.async&&0<v.timeout&&(d=_.setTimeout(function(){A.abort("timeout")},v.timeout));try{p=!1,c.send(s,l)}catch(t){if(p)throw t;l(-1,t)}}else l(-1,"No Transport");function l(t,e,n,r){var i,o,s,a,u,l=e;p||(p=!0,d&&_.clearTimeout(d),c=void 0,f=r||"",A.readyState=0<t?4:0,i=200<=t&&t<300||304===t,n&&(a=function(t,e,n){for(var r,i,o,s,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||t.converters[i+" "+u[0]]){o=i;break}s=s||i}o=o||s}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,A,n)),a=function(t,e,n,r){var i,o,s,a,u,l={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(i in l)if((a=i.split(" "))[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[i]:!0!==l[i]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}(v,a,A,i),i?(v.ifModified&&((u=A.getResponseHeader("Last-Modified"))&&(k.lastModified[h]=u),(u=A.getResponseHeader("etag"))&&(k.etag[h]=u)),204===t||"HEAD"===v.type?l="nocontent":304===t?l="notmodified":(l=a.state,o=a.data,i=!(s=a.error))):(s=l,!t&&l||(l="error",t<0&&(t=0))),A.status=t,A.statusText=(e||l)+"",i?b.resolveWith(m,[o,l,A]):b.rejectWith(m,[A,l,s]),A.statusCode(x),x=void 0,g&&y.trigger(i?"ajaxSuccess":"ajaxError",[A,v,i?o:s]),w.fireWith(m,[A,l]),g&&(y.trigger("ajaxComplete",[A,v]),--k.active||k.event.trigger("ajaxStop")))}return A},getJSON:function(t,e,n){return k.get(t,e,n,"json")},getScript:function(t,e){return k.get(t,void 0,e,"script")}}),k.each(["get","post"],function(t,i){k[i]=function(t,e,n,r){return b(e)&&(r=r||n,n=e,e=void 0),k.ajax(k.extend({url:t,type:i,dataType:r,data:e,success:n},k.isPlainObject(t)&&t))}}),k._evalUrl=function(t,e){return k.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){k.globalEval(t,e)}})},k.fn.extend({wrapAll:function(t){var e;return this[0]&&(b(t)&&(t=t.call(this[0])),e=k(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(n){return b(n)?this.each(function(t){k(this).wrapInner(n.call(this,t))}):this.each(function(){var t=k(this),e=t.contents();e.length?e.wrapAll(n):t.append(n)})},wrap:function(e){var n=b(e);return this.each(function(t){k(this).wrapAll(n?e.call(this,t):e)})},unwrap:function(t){return this.parent(t).not("body").each(function(){k(this).replaceWith(this.childNodes)}),this}}),k.expr.pseudos.hidden=function(t){return!k.expr.pseudos.visible(t)},k.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},k.ajaxSettings.xhr=function(){try{return new _.XMLHttpRequest}catch(t){}};var Qe={0:200,1223:204},tn=k.ajaxSettings.xhr();y.cors=!!tn&&"withCredentials"in tn,y.ajax=tn=!!tn,k.ajaxTransport(function(i){var o,s;if(y.cors||tn&&!i.crossDomain)return{send:function(t,e){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)r.setRequestHeader(n,t[n]);o=function(t){return function(){o&&(o=s=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?e(0,"error"):e(r.status,r.statusText):e(Qe[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),s=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=s:r.onreadystatechange=function(){4===r.readyState&&_.setTimeout(function(){o&&s()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(t){if(o)throw t}},abort:function(){o&&o()}}}),k.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return k.globalEval(t),t}}}),k.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),k.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(t,e){r=k("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(t){r.remove(),i=null,t&&e("error"===t.type?404:200,t.type)}),S.head.appendChild(r[0])},abort:function(){i&&i()}}});var en,nn=[],rn=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=nn.pop()||k.expando+"_"+Oe++;return this[t]=!0,t}}),k.ajaxPrefilter("json jsonp",function(t,e,n){var r,i,o,s=!1!==t.jsonp&&(rn.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&rn.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=b(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(rn,"$1"+r):!1!==t.jsonp&&(t.url+=(Re.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||k.error(r+" was not called"),o[0]},t.dataTypes[0]="json",i=_[r],_[r]=function(){o=arguments},n.always(function(){void 0===i?k(_).removeProp(r):_[r]=i,t[r]&&(t.jsonpCallback=e.jsonpCallback,nn.push(r)),o&&b(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((en=S.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===en.childNodes.length),k.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(y.createHTMLDocument?((r=(e=S.implementation.createHTMLDocument("")).createElement("base")).href=S.location.href,e.head.appendChild(r)):e=S),o=!n&&[],(i=C.exec(t))?[e.createElement(i[1])]:(i=wt([t],e,o),o&&o.length&&k(o).remove(),k.merge([],i.childNodes)));var r,i,o},k.fn.load=function(t,e,n){var r,i,o,s=this,a=t.indexOf(" ");return-1<a&&(r=Pe(t.slice(a)),t=t.slice(0,a)),b(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),0<s.length&&k.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(r?k("<div>").append(k.parseHTML(t)).find(r):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){k.fn[e]=function(t){return this.on(e,t)}}),k.expr.pseudos.animated=function(e){return k.grep(k.timers,function(t){return e===t.elem}).length},k.offset={setOffset:function(t,e,n){var r,i,o,s,a,u,l=k.css(t,"position"),c=k(t),h={};"static"===l&&(t.style.position="relative"),a=c.offset(),o=k.css(t,"top"),u=k.css(t,"left"),i=("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(s=(r=c.position()).top,r.left):(s=parseFloat(o)||0,parseFloat(u)||0),b(e)&&(e=e.call(t,n,k.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+i),"using"in e?e.using.call(t,h):c.css(h)}},k.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){k.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,r=this[0],i={top:0,left:0};if("fixed"===k.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),n=r.ownerDocument,t=r.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===k.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&((i=k(t).offset()).top+=k.css(t,"borderTopWidth",!0),i.left+=k.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-k.css(r,"marginTop",!0),left:e.left-i.left-k.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===k.css(t,"position");)t=t.offsetParent;return t||rt})}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var o="pageYOffset"===i;k.fn[e]=function(t){return q(this,function(t,e,n){var r;if(g(t)?r=t:9===t.nodeType&&(r=t.defaultView),void 0===n)return r?r[i]:t[e];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):t[e]=n},e,t,arguments.length)}}),k.each(["top","left"],function(t,n){k.cssHooks[n]=Kt(y.pixelPosition,function(t,e){if(e)return e=Zt(t,n),Gt.test(e)?k(t).position()[n]+"px":e})}),k.each({Height:"height",Width:"width"},function(s,a){k.each({padding:"inner"+s,content:a,"":"outer"+s},function(r,o){k.fn[o]=function(t,e){var n=arguments.length&&(r||"boolean"!=typeof t),i=r||(!0===t||!0===e?"margin":"border");return q(this,function(t,e,n){var r;return g(t)?0===o.indexOf("outer")?t["inner"+s]:t.document.documentElement["client"+s]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+s],r["scroll"+s],t.body["offset"+s],r["offset"+s],r["client"+s])):void 0===n?k.css(t,e,i):k.style(t,e,n,i)},a,n?t:void 0,n)}})}),k.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,n){k.fn[n]=function(t,e){return 0<arguments.length?this.on(n,null,t,e):this.trigger(n)}}),k.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),k.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),k.proxy=function(t,e){var n,r,i;if("string"==typeof e&&(n=t[e],e=t,t=n),b(t))return r=a.call(arguments,2),(i=function(){return t.apply(e||this,r.concat(a.call(arguments)))}).guid=t.guid=t.guid||k.guid++,i},k.holdReady=function(t){t?k.readyWait++:k.ready(!0)},k.isArray=Array.isArray,k.parseJSON=JSON.parse,k.nodeName=E,k.isFunction=b,k.isWindow=g,k.camelCase=G,k.type=x,k.now=Date.now,k.isNumeric=function(t){var e=k.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},void 0===(ln=function(){return k}.apply(un,[]))||(an.exports=ln);var on=_.jQuery,sn=_.$;return k.noConflict=function(t){return _.$===k&&(_.$=sn),t&&_.jQuery===k&&(_.jQuery=on),k},t||(_.jQuery=_.$=k),k})},function(t,e,n){},function(i,o,s){(function(t){var e,n,r;r="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t,e=[s(6),s(3),o],void 0===(n=function(t,e,n){r.Backbone=function(t,u,x,e){var n=t.Backbone,s=Array.prototype.slice;u.VERSION="1.4.0",u.$=e,u.noConflict=function(){return t.Backbone=n,this},u.emulateHTTP=!1,u.emulateJSON=!1;var a,r=u.Events={},l=/\s+/,c=function(t,e,n,r,i){var o,s=0;if(n&&"object"==typeof n){void 0!==r&&"context"in i&&void 0===i.context&&(i.context=r);for(o=x.keys(n);s<o.length;s++)e=c(t,e,o[s],n[o[s]],i)}else if(n&&l.test(n))for(o=n.split(l);s<o.length;s++)e=t(e,o[s],r,i);else e=t(e,n,r,i);return e};r.on=function(t,e,n){if(this._events=c(i,this._events||{},t,e,{context:n,ctx:this,listening:a}),a){var r=this._listeners||(this._listeners={});(r[a.id]=a).interop=!1}return this},r.listenTo=function(t,e,n){if(!t)return this;var r=t._listenId||(t._listenId=x.uniqueId("l")),i=this._listeningTo||(this._listeningTo={}),o=a=i[r];o||(this._listenId||(this._listenId=x.uniqueId("l")),o=a=i[r]=new g(this,t));var s=h(t,e,n,this);if(a=void 0,s)throw s;return o.interop&&o.on(e,n),this};var i=function(t,e,n,r){if(n){var i=t[e]||(t[e]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return t},h=function(t,e,n,r){try{t.on(e,n,r)}catch(t){return t}};r.off=function(t,e,n){return this._events&&(this._events=c(o,this._events,t,e,{context:n,listeners:this._listeners})),this},r.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;for(var i=t?[t._listenId]:x.keys(r),o=0;o<i.length;o++){var s=r[i[o]];if(!s)break;s.obj.off(e,n,this),s.interop&&s.off(e,n)}return x.isEmpty(r)&&(this._listeningTo=void 0),this};var o=function(t,e,n,r){if(t){var i,o=r.context,s=r.listeners,a=0;if(e||o||n){for(i=e?[e]:x.keys(t);a<i.length;a++){e=i[a];var u=t[e];if(!u)break;for(var l=[],c=0;c<u.length;c++){var h=u[c];if(n&&n!==h.callback&&n!==h.callback._callback||o&&o!==h.context)l.push(h);else{var f=h.listening;f&&f.off(e,n)}}l.length?t[e]=l:delete t[e]}return t}for(i=x.keys(s);a<i.length;a++)s[i[a]].cleanup()}};r.once=function(t,e,n){var r=c(f,{},t,e,this.off.bind(this));return"string"==typeof t&&null==n&&(e=void 0),this.on(r,e,n)},r.listenToOnce=function(t,e,n){var r=c(f,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,r)};var f=function(t,e,n,r){if(n){var i=t[e]=x.once(function(){r(e,i),n.apply(this,arguments)});i._callback=n}return t};r.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),r=0;r<e;r++)n[r]=arguments[r+1];return c(d,this._events,t,void 0,n),this};var d=function(t,e,n,r){if(t){var i=t[e],o=t.all;i&&o&&(o=o.slice()),i&&p(i,r),o&&p(o,[e].concat(r))}return t},p=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}},g=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};g.prototype.on=r.on,g.prototype.off=function(t,e){(this.interop?(this._events=c(o,this._events,t,e,{context:void 0,listeners:void 0}),this._events):(this.count--,0!==this.count))||this.cleanup()},g.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},r.bind=r.on,r.unbind=r.off,x.extend(u,r);var v=u.Model=function(t,e){var n=t||{};e=e||{},this.preinitialize.apply(this,arguments),this.cid=x.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{});var r=x.result(this,"defaults");n=x.defaults(x.extend({},r,n),r),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};x.extend(v.prototype,r,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return x.clone(this.attributes)},sync:function(){return u.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return x.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!x.iteratee(t,this)(this.attributes)},set:function(t,e,n){if(null==t)return this;var r;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n=n||{},!this._validate(r,n))return!1;var i=n.unset,o=n.silent,s=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=x.clone(this.attributes),this.changed={});var u=this.attributes,l=this.changed,c=this._previousAttributes;for(var h in r)e=r[h],x.isEqual(u[h],e)||s.push(h),x.isEqual(c[h],e)?delete l[h]:l[h]=e,i?delete u[h]:u[h]=e;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!o){s.length&&(this._pending=n);for(var f=0;f<s.length;f++)this.trigger("change:"+s[f],this,u[s[f]],n)}if(a)return this;if(!o)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,x.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,x.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!x.isEmpty(this.changed):x.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&x.clone(this.changed);var e,n=this._changing?this._previousAttributes:this.attributes,r={};for(var i in t){var o=t[i];x.isEqual(n[i],o)||(r[i]=o,e=!0)}return!!e&&r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return x.clone(this._previousAttributes)},fetch:function(n){n=x.extend({parse:!0},n);var r=this,i=n.success;return n.success=function(t){var e=n.parse?r.parse(t,n):t;if(!r.set(e,n))return!1;i&&i.call(n.context,r,t,n),r.trigger("sync",r,t,n)},U(this,n),this.sync("read",this,n)},save:function(t,e,n){var r;null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e;var i=(n=x.extend({validate:!0,parse:!0},n)).wait;if(r&&!i){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;var o=this,s=n.success,a=this.attributes;n.success=function(t){o.attributes=a;var e=n.parse?o.parse(t,n):t;if(i&&(e=x.extend({},r,e)),e&&!o.set(e,n))return!1;s&&s.call(n.context,o,t,n),o.trigger("sync",o,t,n)},U(this,n),r&&i&&(this.attributes=x.extend({},a,r));var u=this.isNew()?"create":n.patch?"patch":"update";"patch"!=u||n.attrs||(n.attrs=r);var l=this.sync(u,this,n);return this.attributes=a,l},destroy:function(e){e=e?x.clone(e):{};var n=this,r=e.success,i=e.wait,o=function(){n.stopListening(),n.trigger("destroy",n,n.collection,e)},t=!(e.success=function(t){i&&o(),r&&r.call(e.context,n,t,e),n.isNew()||n.trigger("sync",n,t,e)});return this.isNew()?x.defer(e.success):(U(this,e),t=this.sync("delete",this,e)),i||o(),t},url:function(){var t=x.result(this,"urlRoot")||x.result(this.collection,"url")||H();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},x.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=x.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,x.extend(e,{validationError:n})),!1)}});var m=u.Collection=function(t,e){e=e||{},this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,x.extend({silent:!0},e))},A={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1},_=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var r,i=Array(t.length-n),o=e.length;for(r=0;r<i.length;r++)i[r]=t[r+n];for(r=0;r<o;r++)t[r+n]=e[r];for(r=0;r<i.length;r++)t[r+o+n]=i[r]};x.extend(m.prototype,r,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return u.sync.apply(this,arguments)},add:function(t,e){return this.set(t,x.extend({merge:!1},e,y))},remove:function(t,e){e=x.extend({},e);var n=!x.isArray(t);t=n?[t]:t.slice();var r=this._removeModels(t,e);return!e.silent&&r.length&&(e.changes={added:[],merged:[],removed:r},this.trigger("update",this,e)),n?r[0]:r},set:function(t,e){if(null!=t){(e=x.extend({},A,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var n=!x.isArray(t);t=n?[t]:t.slice();var r=e.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var i,o,s=[],a=[],u=[],l=[],c={},h=e.add,f=e.merge,d=e.remove,p=!1,g=this.comparator&&null==r&&!1!==e.sort,v=x.isString(this.comparator)?this.comparator:null;for(o=0;o<t.length;o++){i=t[o];var m=this.get(i);if(m){if(f&&i!==m){var y=this._isModel(i)?i.attributes:i;e.parse&&(y=m.parse(y,e)),m.set(y,e),u.push(m),g&&!p&&(p=m.hasChanged(v))}c[m.cid]||(c[m.cid]=!0,s.push(m)),t[o]=m}else h&&(i=t[o]=this._prepareModel(i,e))&&(a.push(i),this._addReference(i,e),c[i.cid]=!0,s.push(i))}if(d){for(o=0;o<this.length;o++)i=this.models[o],c[i.cid]||l.push(i);l.length&&this._removeModels(l,e)}var b=!1,w=!g&&h&&d;if(s.length&&w?(b=this.length!==s.length||x.some(this.models,function(t,e){return t!==s[e]}),this.models.length=0,_(this.models,s,0),this.length=this.models.length):a.length&&(g&&(p=!0),_(this.models,a,null==r?this.length:r),this.length=this.models.length),p&&this.sort({silent:!0}),!e.silent){for(o=0;o<a.length;o++)null!=r&&(e.index=r+o),(i=a[o]).trigger("add",i,this,e);(p||b)&&this.trigger("sort",this,e),(a.length||l.length||u.length)&&(e.changes={added:a,removed:l,merged:u},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?x.clone(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,x.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,x.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,x.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t=t||{};var n=e.length;return x.isFunction(e)&&(e=e.bind(this)),1===n||x.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(n){var r=(n=x.extend({parse:!0},n)).success,i=this;return n.success=function(t){var e=n.reset?"reset":"set";i[e](t,n),r&&r.call(n.context,i,t,n),i.trigger("sync",i,t,n)},U(this,n),this.sync("read",this,n)},create:function(t,e){var r=(e=e?x.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;r||this.add(t,e);var i=this,o=e.success;return e.success=function(t,e,n){r&&i.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new w(this,S)},keys:function(){return new w(this,k)},entries:function(){return new w(this,P)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;var n=new(((e=e?x.clone(e):{}).collection=this).model)(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=this.get(t[r]);if(i){var o=this.indexOf(i);this.models.splice(o,1),this.length--,delete this._byId[i.cid];var s=this.modelId(i.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,i.trigger("remove",i,this,e)),n.push(i),this._removeReference(i,e)}}return n},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,r),"change"===t){var i=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);i!==o&&(null!=i&&delete this._byId[i],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}});var b="function"==typeof Symbol&&Symbol.iterator;b&&(m.prototype[b]=m.prototype.values);var w=function(t,e){this._collection=t,this._kind=e,this._index=0},S=1,k=2,P=3;b&&(w.prototype[b]=function(){return this}),w.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===S)t=e;else{var n=this._collection.modelId(e.attributes);t=this._kind===k?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var E=u.View=function(t){this.cid=x.uniqueId("view"),this.preinitialize.apply(this,arguments),x.extend(this,x.pick(t,T)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];x.extend(E.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof u.$?t:u.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(!(t=t||x.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var n=t[e];if(x.isFunction(n)||(n=this[n]),n){var r=e.match(C);this.delegate(r[1],r[2],n.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(x.result(this,"el"));else{var t=x.extend({},x.result(this,"attributes"));this.id&&(t.id=x.result(this,"id")),this.className&&(t.class=x.result(this,"className")),this.setElement(this._createElement(x.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var N=function(n,r,t,i){x.each(t,function(t,e){r[e]&&(n.prototype[e]=function(r,t,i,o){switch(t){case 1:return function(){return r[i](this[o])};case 2:return function(t){return r[i](this[o],t)};case 3:return function(t,e){return r[i](this[o],L(t,this),e)};case 4:return function(t,e,n){return r[i](this[o],L(t,this),e,n)};default:return function(){var t=s.call(arguments);t.unshift(this[o]);return r[i].apply(r,t)}}}(r,t,e,i))})},L=function(e,t){return x.isFunction(e)?e:x.isObject(e)&&!t._isModel(e)?M(e):x.isString(e)?function(t){return t.get(e)}:e},M=function(t){var e=x.matches(t);return function(t){return e(t.attributes)}};x.each([[m,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],function(t){var n=t[0],e=t[1],r=t[2];n.mixin=function(t){var e=x.reduce(x.functions(t),function(t,e){return t[e]=0,t},{});N(n,t,e,r)},N(n,x,e,r)}),u.sync=function(t,e,r){var n=O[t];x.defaults(r=r||{},{emulateHTTP:u.emulateHTTP,emulateJSON:u.emulateJSON});var i={type:n,dataType:"json"};if(r.url||(i.url=x.result(e,"url")||H()),null!=r.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(i.contentType="application/json",i.data=JSON.stringify(r.attrs||e.toJSON(r))),r.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{}),r.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){i.type="POST",r.emulateJSON&&(i.data._method=n);var o=r.beforeSend;r.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",n),o)return o.apply(this,arguments)}}"GET"===i.type||r.emulateJSON||(i.processData=!1);var s=r.error;r.error=function(t,e,n){r.textStatus=e,r.errorThrown=n,s&&s.call(r.context,t,e,n)};var a=r.xhr=u.ajax(x.extend(i,r));return e.trigger("request",e,a,r),a};var O={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};u.ajax=function(){return u.$.ajax.apply(u.$,arguments)};var R=u.Router=function(t){t=t||{},this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},D=/\((.*?)\)/g,j=/(\(\?)?:\w+/g,F=/\*\w+/g,B=/[\-{}\[\]+?.,\\\^$|#\s]/g;x.extend(R.prototype,r,{preinitialize:function(){},initialize:function(){},route:function(n,r,i){x.isRegExp(n)||(n=this._routeToRegExp(n)),x.isFunction(r)&&(i=r,r=""),i=i||this[r];var o=this;return u.history.route(n,function(t){var e=o._extractParameters(n,t);!1!==o.execute(i,e,r)&&(o.trigger.apply(o,["route:"+r].concat(e)),o.trigger("route",r,e),u.history.trigger("route",o,r,e))}),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,e){return u.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=x.result(this,"routes");for(var t,e=x.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(B,"\\$&").replace(D,"(?:$1)?").replace(j,function(t,e){return e?t:"([^/?]+)"}).replace(F,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return x.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var V=u.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,z=/^\/+|\/+$/g,q=/#.*$/;V.started=!1,x.extend(V.prototype,r,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(I,"")},start:function(t){if(V.started)throw new Error("Backbone.history has already been started");if(V.started=!0,this.options=x.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(z,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,r=n.insertBefore(this.iframe,n.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var i=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?i("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?i("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),V.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),x.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(t,e){if(!V.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+t;t=t.replace(q,"");var i=this.decodeFragment(t);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),u.history=new V;v.extend=m.extend=R.extend=E.extend=V.extend=function(t,e){var n=this,r;if(t&&x.has(t,"constructor")){r=t.constructor}else{r=function(){return n.apply(this,arguments)}}return x.extend(r,n,e),r.prototype=x.create(n.prototype,t),(r.prototype.constructor=r).__super__=n.prototype,r};var H=function(){throw new Error('A "url" property or function must be specified')},U=function(e,n){var r=n.error;n.error=function(t){r&&r.call(n.context,e,t,n),e.trigger("error",e,t,n)}};return u}(r,n,t,e)}.apply(o,e))||(i.exports=n)}).call(this,s(1))},function(t,K,e){(function(Y,J){var Z;!function(){function n(){}var t="object"==typeof self&&self.self===self&&self||"object"==typeof Y&&Y.global===Y&&Y||this||{},e=t._,r=Array.prototype,s=Object.prototype,h="undefined"!=typeof Symbol?Symbol.prototype:null,i=r.push,u=r.slice,f=s.toString,o=s.hasOwnProperty,a=Array.isArray,l=Object.keys,c=Object.create,d=function(t){return t instanceof d?t:this instanceof d?void(this._wrapped=t):new d(t)};K.nodeType?t._=d:(!J.nodeType&&J.exports&&(K=J.exports=d),K._=d),d.VERSION="1.9.1";function p(i,o,t){if(void 0===o)return i;switch(null==t?3:t){case 1:return function(t){return i.call(o,t)};case 3:return function(t,e,n){return i.call(o,t,e,n)};case 4:return function(t,e,n,r){return i.call(o,t,e,n,r)}}return function(){return i.apply(o,arguments)}}function g(t,e,n){return d.iteratee!==v?d.iteratee(t,e):null==t?d.identity:d.isFunction(t)?p(t,e,n):d.isObject(t)&&!d.isArray(t)?d.matcher(t):d.property(t)}var v;d.iteratee=v=function(t,e){return g(t,e,1/0)};function m(i,o){return o=null==o?i.length-1:+o,function(){for(var t=Math.max(arguments.length-o,0),e=Array(t),n=0;n<t;n++)e[n]=arguments[n+o];switch(o){case 0:return i.call(this,e);case 1:return i.call(this,arguments[0],e);case 2:return i.call(this,arguments[0],arguments[1],e)}var r=Array(o+1);for(n=0;n<o;n++)r[n]=arguments[n];return r[o]=e,i.apply(this,r)}}function y(t){if(!d.isObject(t))return{};if(c)return c(t);n.prototype=t;var e=new n;return n.prototype=null,e}function b(e){return function(t){return null==t?void 0:t[e]}}function w(t,e){return null!=t&&o.call(t,e)}function x(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function A(t){var e=S(t);return"number"==typeof e&&0<=e&&e<=_}var _=Math.pow(2,53)-1,S=b("length");d.each=d.forEach=function(t,e,n){var r,i;if(e=p(e,n),A(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=d.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},d.map=d.collect=function(t,e,n){e=g(e,n);for(var r=!A(t)&&d.keys(t),i=(r||t).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=e(t[a],a,t)}return o};function k(u){return function(t,e,n,r){var i=3<=arguments.length;return function(t,e,n,r){var i=!A(t)&&d.keys(t),o=(i||t).length,s=0<u?0:o-1;for(r||(n=t[i?i[s]:s],s+=u);0<=s&&s<o;s+=u){var a=i?i[s]:s;n=e(n,t[a],a,t)}return n}(t,p(e,r,4),n,i)}}d.reduce=d.foldl=d.inject=k(1),d.reduceRight=d.foldr=k(-1),d.find=d.detect=function(t,e,n){var r=(A(t)?d.findIndex:d.findKey)(t,e,n);if(void 0!==r&&-1!==r)return t[r]},d.filter=d.select=function(t,r,e){var i=[];return r=g(r,e),d.each(t,function(t,e,n){r(t,e,n)&&i.push(t)}),i},d.reject=function(t,e,n){return d.filter(t,d.negate(g(e)),n)},d.every=d.all=function(t,e,n){e=g(e,n);for(var r=!A(t)&&d.keys(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(!e(t[s],s,t))return!1}return!0},d.some=d.any=function(t,e,n){e=g(e,n);for(var r=!A(t)&&d.keys(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(e(t[s],s,t))return!0}return!1},d.contains=d.includes=d.include=function(t,e,n,r){return A(t)||(t=d.values(t)),"number"==typeof n&&!r||(n=0),0<=d.indexOf(t,e,n)},d.invoke=m(function(t,n,r){var i,o;return d.isFunction(n)?o=n:d.isArray(n)&&(i=n.slice(0,-1),n=n[n.length-1]),d.map(t,function(t){var e=o;if(!e){if(i&&i.length&&(t=x(t,i)),null==t)return;e=t[n]}return null==e?e:e.apply(t,r)})}),d.pluck=function(t,e){return d.map(t,d.property(e))},d.where=function(t,e){return d.filter(t,d.matcher(e))},d.findWhere=function(t,e){return d.find(t,d.matcher(e))},d.max=function(t,r,e){var n,i,o=-1/0,s=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=A(t)?t:d.values(t)).length;a<u;a++)null!=(n=t[a])&&o<n&&(o=n);else r=g(r,e),d.each(t,function(t,e,n){i=r(t,e,n),(s<i||i===-1/0&&o===-1/0)&&(o=t,s=i)});return o},d.min=function(t,r,e){var n,i,o=1/0,s=1/0;if(null==r||"number"==typeof r&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=A(t)?t:d.values(t)).length;a<u;a++)null!=(n=t[a])&&n<o&&(o=n);else r=g(r,e),d.each(t,function(t,e,n){((i=r(t,e,n))<s||i===1/0&&o===1/0)&&(o=t,s=i)});return o},d.shuffle=function(t){return d.sample(t,1/0)},d.sample=function(t,e,n){if(null==e||n)return A(t)||(t=d.values(t)),t[d.random(t.length-1)];var r=A(t)?d.clone(t):d.values(t),i=S(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,s=0;s<e;s++){var a=d.random(s,o),u=r[s];r[s]=r[a],r[a]=u}return r.slice(0,e)},d.sortBy=function(t,r,e){var i=0;return r=g(r,e),d.pluck(d.map(t,function(t,e,n){return{value:t,index:i++,criteria:r(t,e,n)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};function P(s,e){return function(r,i,t){var o=e?[[],[]]:{};return i=g(i,t),d.each(r,function(t,e){var n=i(t,e,r);s(o,t,n)}),o}}d.groupBy=P(function(t,e,n){w(t,n)?t[n].push(e):t[n]=[e]}),d.indexBy=P(function(t,e,n){t[n]=e}),d.countBy=P(function(t,e,n){w(t,n)?t[n]++:t[n]=1});var E=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;d.toArray=function(t){return t?d.isArray(t)?u.call(t):d.isString(t)?t.match(E):A(t)?d.map(t,d.identity):d.values(t):[]},d.size=function(t){return null==t?0:A(t)?t.length:d.keys(t).length},d.partition=P(function(t,e,n){t[n?0:1].push(e)},!0),d.first=d.head=d.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:d.initial(t,t.length-e)},d.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},d.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:d.rest(t,Math.max(0,t.length-e))},d.rest=d.tail=d.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},d.compact=function(t){return d.filter(t,Boolean)};var C=function(t,e,n,r){for(var i=(r=r||[]).length,o=0,s=S(t);o<s;o++){var a=t[o];if(A(a)&&(d.isArray(a)||d.isArguments(a)))if(e)for(var u=0,l=a.length;u<l;)r[i++]=a[u++];else C(a,e,n,r),i=r.length;else n||(r[i++]=a)}return r};d.flatten=function(t,e){return C(t,e,!1)},d.without=m(function(t,e){return d.difference(t,e)}),d.uniq=d.unique=function(t,e,n,r){d.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=g(n,r));for(var i=[],o=[],s=0,a=S(t);s<a;s++){var u=t[s],l=n?n(u,s,t):u;e&&!n?(s&&o===l||i.push(u),o=l):n?d.contains(o,l)||(o.push(l),i.push(u)):d.contains(i,u)||i.push(u)}return i},d.union=m(function(t){return d.uniq(C(t,!0,!0))}),d.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=S(t);r<i;r++){var o=t[r];if(!d.contains(e,o)){var s;for(s=1;s<n&&d.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},d.difference=m(function(t,e){return e=C(e,!0,!0),d.filter(t,function(t){return!d.contains(e,t)})}),d.unzip=function(t){for(var e=t&&d.max(t,S).length||0,n=Array(e),r=0;r<e;r++)n[r]=d.pluck(t,r);return n},d.zip=m(d.unzip),d.object=function(t,e){for(var n={},r=0,i=S(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n};function T(o){return function(t,e,n){e=g(e,n);for(var r=S(t),i=0<o?0:r-1;0<=i&&i<r;i+=o)if(e(t[i],i,t))return i;return-1}}d.findIndex=T(1),d.findLastIndex=T(-1),d.sortedIndex=function(t,e,n,r){for(var i=(n=g(n,r,1))(e),o=0,s=S(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<i?o=a+1:s=a}return o};function N(o,s,a){return function(t,e,n){var r=0,i=S(t);if("number"==typeof n)0<o?r=0<=n?n:Math.max(n+i,r):i=0<=n?Math.min(n+1,i):n+i+1;else if(a&&n&&i)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=s(u.call(t,r,i),d.isNaN))?n+r:-1;for(n=0<o?r:i-1;0<=n&&n<i;n+=o)if(t[n]===e)return n;return-1}}d.indexOf=N(1,d.findIndex,d.sortedIndex),d.lastIndexOf=N(-1,d.findLastIndex),d.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||(e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i},d.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(u.call(t,r,r+=e));return n};function L(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=y(t.prototype),s=t.apply(o,i);return d.isObject(s)?s:o}d.bind=m(function(e,n,r){if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");var i=m(function(t){return L(e,i,n,this,r.concat(t))});return i}),d.partial=m(function(i,o){var s=d.partial.placeholder,a=function(){for(var t=0,e=o.length,n=Array(e),r=0;r<e;r++)n[r]=o[r]===s?arguments[t++]:o[r];for(;t<arguments.length;)n.push(arguments[t++]);return L(i,a,this,this,n)};return a}),(d.partial.placeholder=d).bindAll=m(function(t,e){var n=(e=C(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=d.bind(t[r],t)}}),d.memoize=function(r,i){var o=function(t){var e=o.cache,n=""+(i?i.apply(this,arguments):t);return w(e,n)||(e[n]=r.apply(this,arguments)),e[n]};return o.cache={},o},d.delay=m(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),d.defer=d.partial(d.delay,d,1),d.throttle=function(n,r,i){var o,s,a,u,l=0;i=i||{};function c(){l=!1===i.leading?0:d.now(),o=null,u=n.apply(s,a),o||(s=a=null)}function t(){var t=d.now();l||!1!==i.leading||(l=t);var e=r-(t-l);return s=this,a=arguments,e<=0||r<e?(o&&(clearTimeout(o),o=null),l=t,u=n.apply(s,a),o||(s=a=null)):o||!1===i.trailing||(o=setTimeout(c,e)),u}return t.cancel=function(){clearTimeout(o),l=0,o=s=a=null},t},d.debounce=function(n,r,i){function o(t,e){s=null,e&&(a=n.apply(t,e))}var s,a,t=m(function(t){if(s&&clearTimeout(s),i){var e=!s;s=setTimeout(o,r),e&&(a=n.apply(this,t))}else s=d.delay(o,r,this,t);return a});return t.cancel=function(){clearTimeout(s),s=null},t},d.wrap=function(t,e){return d.partial(e,t)},d.negate=function(t){return function(){return!t.apply(this,arguments)}},d.compose=function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},d.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},d.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},d.once=d.partial(d.before,2),d.restArguments=m;function M(t,e){var n=R.length,r=t.constructor,i=d.isFunction(r)&&r.prototype||s,o="constructor";for(w(t,o)&&!d.contains(e,o)&&e.push(o);n--;)(o=R[n])in t&&t[o]!==i[o]&&!d.contains(e,o)&&e.push(o)}var O=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];d.keys=function(t){if(!d.isObject(t))return[];if(l)return l(t);var e=[];for(var n in t)w(t,n)&&e.push(n);return O&&M(t,e),e},d.allKeys=function(t){if(!d.isObject(t))return[];var e=[];for(var n in t)e.push(n);return O&&M(t,e),e},d.values=function(t){for(var e=d.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},d.mapObject=function(t,e,n){e=g(e,n);for(var r=d.keys(t),i=r.length,o={},s=0;s<i;s++){var a=r[s];o[a]=e(t[a],a,t)}return o},d.pairs=function(t){for(var e=d.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},d.invert=function(t){for(var e={},n=d.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},d.functions=d.methods=function(t){var e=[];for(var n in t)d.isFunction(t[n])&&e.push(n);return e.sort()};function D(u,l){return function(t){var e=arguments.length;if(l&&(t=Object(t)),e<2||null==t)return t;for(var n=1;n<e;n++)for(var r=arguments[n],i=u(r),o=i.length,s=0;s<o;s++){var a=i[s];l&&void 0!==t[a]||(t[a]=r[a])}return t}}d.extend=D(d.allKeys),d.extendOwn=d.assign=D(d.keys),d.findKey=function(t,e,n){e=g(e,n);for(var r,i=d.keys(t),o=0,s=i.length;o<s;o++)if(e(t[r=i[o]],r,t))return r};function j(t,e,n){return e in n}var F,B;d.pick=m(function(t,e){var n={},r=e[0];if(null==t)return n;d.isFunction(r)?(1<e.length&&(r=p(r,e[1])),e=d.allKeys(t)):(r=j,e=C(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var s=e[i],a=t[s];r(a,s,t)&&(n[s]=a)}return n}),d.omit=m(function(t,n){var e,r=n[0];return d.isFunction(r)?(r=d.negate(r),1<n.length&&(e=n[1])):(n=d.map(C(n,!1,!1),String),r=function(t,e){return!d.contains(n,e)}),d.pick(t,r,e)}),d.defaults=D(d.allKeys,!0),d.create=function(t,e){var n=y(t);return e&&d.extendOwn(n,e),n},d.clone=function(t){return d.isObject(t)?d.isArray(t)?t.slice():d.extend({},t):t},d.tap=function(t,e){return e(t),t},d.isMatch=function(t,e){var n=d.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var s=n[o];if(e[s]!==i[s]||!(s in i))return!1}return!0},F=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"==i||"object"==i||"object"==typeof e)&&B(t,e,n,r)},B=function(t,e,n,r){t instanceof d&&(t=t._wrapped),e instanceof d&&(e=e._wrapped);var i=f.call(t);if(i!==f.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return h.valueOf.call(t)===h.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(d.isFunction(s)&&s instanceof s&&d.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return r[u]===e;if(n.push(t),r.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!F(t[u],e[u],n,r))return!1}else{var l,c=d.keys(t);if(u=c.length,d.keys(e).length!==u)return!1;for(;u--;)if(l=c[u],!w(e,l)||!F(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0},d.isEqual=function(t,e){return F(t,e)},d.isEmpty=function(t){return null==t||(A(t)&&(d.isArray(t)||d.isString(t)||d.isArguments(t))?0===t.length:0===d.keys(t).length)},d.isElement=function(t){return!(!t||1!==t.nodeType)},d.isArray=a||function(t){return"[object Array]"===f.call(t)},d.isObject=function(t){var e=typeof t;return"function"==e||"object"==e&&!!t},d.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){d["is"+e]=function(t){return f.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(t){return w(t,"callee")});var V=t.document&&t.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof V&&(d.isFunction=function(t){return"function"==typeof t||!1}),d.isFinite=function(t){return!d.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},d.isNaN=function(t){return d.isNumber(t)&&isNaN(t)},d.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===f.call(t)},d.isNull=function(t){return null===t},d.isUndefined=function(t){return void 0===t},d.has=function(t,e){if(!d.isArray(e))return w(t,e);for(var n=e.length,r=0;r<n;r++){var i=e[r];if(null==t||!o.call(t,i))return!1;t=t[i]}return!!n},d.noConflict=function(){return t._=e,this},d.identity=function(t){return t},d.constant=function(t){return function(){return t}},d.noop=function(){},d.property=function(e){return d.isArray(e)?function(t){return x(t,e)}:b(e)},d.propertyOf=function(e){return null==e?function(){}:function(t){return d.isArray(t)?x(e,t):e[t]}},d.matcher=d.matches=function(e){return e=d.extendOwn({},e),function(t){return d.isMatch(t,e)}},d.times=function(t,e,n){var r=Array(Math.max(0,t));e=p(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},d.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},d.now=Date.now||function(){return(new Date).getTime()};function I(e){function n(t){return e[t]}var t="(?:"+d.keys(e).join("|")+")",r=RegExp(t),i=RegExp(t,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,n):t}}var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},q=d.invert(z);d.escape=I(z),d.unescape=I(q),d.result=function(t,e,n){d.isArray(e)||(e=[e]);var r=e.length;if(!r)return d.isFunction(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=d.isFunction(o)?o.call(t):o}return t};var H=0;d.uniqueId=function(t){var e=++H+"";return t?t+e:e},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};function U(t){return"\\"+G[t]}var $=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g;d.template=function(o,t,e){!t&&e&&(t=e),t=d.defaults({},t,d.templateSettings);var n,r=RegExp([(t.escape||$).source,(t.interpolate||$).source,(t.evaluate||$).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(r,function(t,e,n,r,i){return a+=o.slice(s,i).replace(W,U),s=i+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(t.variable||"obj","_",a)}catch(t){throw t.source=a,t}function i(t){return n.call(this,t,d)}var u=t.variable||"obj";return i.source="function("+u+"){\n"+a+"}",i},d.chain=function(t){var e=d(t);return e._chain=!0,e};function X(t,e){return t._chain?d(e).chain():e}d.mixin=function(n){return d.each(d.functions(n),function(t){var e=d[t]=n[t];d.prototype[t]=function(){var t=[this._wrapped];return i.apply(t,arguments),X(this,e.apply(d,t))}}),d},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=r[e];d.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],X(this,t)}}),d.each(["concat","join","slice"],function(t){var e=r[t];d.prototype[t]=function(){return X(this,e.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},d.prototype.valueOf=d.prototype.toJSON=d.prototype.value,d.prototype.toString=function(){return String(this._wrapped)},void 0===(Z=function(){return d}.apply(K,[]))||(J.exports=Z)}()}).call(this,e(1),e(2)(t))},function(t,q,H){(function(V,I){var z;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var rs,is="Expected a function",os="__lodash_hash_undefined__",ss="__lodash_placeholder__",as=9007199254740991,us=NaN,ls=4294967295,cs=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],hs="[object Arguments]",fs="[object Array]",ds="[object Boolean]",ps="[object Date]",gs="[object Error]",vs="[object Function]",ms="[object GeneratorFunction]",ys="[object Map]",bs="[object Number]",ws="[object Object]",xs="[object Promise]",As="[object RegExp]",_s="[object Set]",Ss="[object String]",ks="[object Symbol]",Ps="[object WeakMap]",Es="[object ArrayBuffer]",Cs="[object DataView]",Ts="[object Float32Array]",Ns="[object Float64Array]",Ls="[object Int8Array]",Ms="[object Int16Array]",Os="[object Int32Array]",Rs="[object Uint8Array]",Ds="[object Uint8ClampedArray]",js="[object Uint16Array]",Fs="[object Uint32Array]",Bs=/\b__p \+= '';/g,Vs=/\b(__p \+=) '' \+/g,Is=/(__e\(.*?\)|\b__t\)) \+\n'';/g,zs=/&(?:amp|lt|gt|quot|#39);/g,qs=/[&<>"']/g,Hs=RegExp(zs.source),Us=RegExp(qs.source),$s=/<%-([\s\S]+?)%>/g,Gs=/<%([\s\S]+?)%>/g,Ws=/<%=([\s\S]+?)%>/g,Xs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ys=/^\w*$/,Js=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zs=/[\\^$.*+?()[\]{}|]/g,Ks=RegExp(Zs.source),Qs=/^\s+|\s+$/g,ta=/^\s+/,ea=/\s+$/,na=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ra=/\{\n\/\* \[wrapped with (.+)\] \*/,ia=/,? & /,oa=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sa=/\\(\\)?/g,aa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ua=/\w*$/,la=/^[-+]0x[0-9a-f]+$/i,ca=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,fa=/^0o[0-7]+$/i,da=/^(?:0|[1-9]\d*)$/,pa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ga=/($^)/,va=/['\n\r\u2028\u2029\\]/g,t="\\ud800-\\udfff",e="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",n="\\u2700-\\u27bf",r="a-z\\xdf-\\xf6\\xf8-\\xff",i="A-Z\\xc0-\\xd6\\xd8-\\xde",o="\\ufe0e\\ufe0f",s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",a="["+t+"]",u="["+s+"]",l="["+e+"]",c="\\d+",h="["+n+"]",f="["+r+"]",d="[^"+t+s+c+n+r+i+"]",p="\\ud83c[\\udffb-\\udfff]",g="[^"+t+"]",v="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",y="["+i+"]",b="(?:"+f+"|"+d+")",w="(?:"+y+"|"+d+")",x="(?:['](?:d|ll|m|re|s|t|ve))?",A="(?:['](?:D|LL|M|RE|S|T|VE))?",_="(?:"+l+"|"+p+")"+"?",S="["+o+"]?",k=S+_+("(?:\\u200d(?:"+[g,v,m].join("|")+")"+S+_+")*"),P="(?:"+[h,v,m].join("|")+")"+k,E="(?:"+[g+l+"?",l,v,m,a].join("|")+")",ma=RegExp("[']","g"),ya=RegExp(l,"g"),C=RegExp(p+"(?="+p+")|"+E+k,"g"),ba=RegExp([y+"?"+f+"+"+x+"(?="+[u,y,"$"].join("|")+")",w+"+"+A+"(?="+[u,y+b,"$"].join("|")+")",y+"?"+b+"+"+x,y+"+"+A,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",c,P].join("|"),"g"),T=RegExp("[\\u200d"+t+e+o+"]"),wa=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xa=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Aa=-1,_a={};_a[Ts]=_a[Ns]=_a[Ls]=_a[Ms]=_a[Os]=_a[Rs]=_a[Ds]=_a[js]=_a[Fs]=!0,_a[hs]=_a[fs]=_a[Es]=_a[ds]=_a[Cs]=_a[ps]=_a[gs]=_a[vs]=_a[ys]=_a[bs]=_a[ws]=_a[As]=_a[_s]=_a[Ss]=_a[Ps]=!1;var Sa={};Sa[hs]=Sa[fs]=Sa[Es]=Sa[Cs]=Sa[ds]=Sa[ps]=Sa[Ts]=Sa[Ns]=Sa[Ls]=Sa[Ms]=Sa[Os]=Sa[ys]=Sa[bs]=Sa[ws]=Sa[As]=Sa[_s]=Sa[Ss]=Sa[ks]=Sa[Rs]=Sa[Ds]=Sa[js]=Sa[Fs]=!0,Sa[gs]=Sa[vs]=Sa[Ps]=!1;var N={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ka=parseFloat,Pa=parseInt,L="object"==typeof V&&V&&V.Object===Object&&V,M="object"==typeof self&&self&&self.Object===Object&&self,Ea=L||M||Function("return this")(),O=q&&!q.nodeType&&q,R=O&&"object"==typeof I&&I&&!I.nodeType&&I,Ca=R&&R.exports===O,D=Ca&&L.process,j=function(){try{var t=R&&R.require&&R.require("util").types;return t||D&&D.binding&&D.binding("util")}catch(t){}}(),Ta=j&&j.isArrayBuffer,Na=j&&j.isDate,La=j&&j.isMap,Ma=j&&j.isRegExp,Oa=j&&j.isSet,Ra=j&&j.isTypedArray;function Da(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ja(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function Fa(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Ba(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Va(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ia(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function za(t,e){return!!(null==t?0:t.length)&&-1<Ja(t,e,0)}function qa(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ha(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Ua(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function $a(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Ga(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function Wa(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var F=tu("length");function Xa(t,r,e){var i;return e(t,function(t,e,n){if(r(t,e,n))return i=e,!1}),i}function Ya(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function Ja(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Ya(t,Ka,n)}function Za(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Ka(t){return t!=t}function Qa(t,e){var n=null==t?0:t.length;return n?nu(t,e)/n:us}function tu(e){return function(t){return null==t?rs:t[e]}}function B(e){return function(t){return null==e?rs:e[t]}}function eu(t,r,i,o,e){return e(t,function(t,e,n){i=o?(o=!1,t):r(i,t,e,n)}),i}function nu(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==rs&&(n=n===rs?o:n+o)}return n}function ru(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function iu(e){return function(t){return e(t)}}function ou(e,t){return Ha(t,function(t){return e[t]})}function su(t,e){return t.has(e)}function au(t,e){for(var n=-1,r=t.length;++n<r&&-1<Ja(e,t[n],0););return n}function uu(t,e){for(var n=t.length;n--&&-1<Ja(e,t[n],0););return n}var lu=B({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),cu=B({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function hu(t){return"\\"+N[t]}function fu(t){return T.test(t)}function du(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}function pu(e,n){return function(t){return e(n(t))}}function gu(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==ss||(t[n]=ss,o[i++]=n)}return o}function vu(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function mu(t){return fu(t)?function(t){var e=C.lastIndex=0;for(;C.test(t);)++e;return e}(t):F(t)}function yu(t){return fu(t)?function(t){return t.match(C)||[]}(t):function(t){return t.split("")}(t)}var bu=B({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var wu=function t(e){var n,k=(e=null==e?Ea:wu.defaults(Ea.Object(),e,wu.pick(Ea,xa))).Array,r=e.Date,i=e.Error,v=e.Function,o=e.Math,g=e.Object,m=e.RegExp,c=e.String,y=e.TypeError,s=k.prototype,a=v.prototype,h=g.prototype,u=e["__core-js_shared__"],l=a.toString,w=h.hasOwnProperty,f=0,d=(n=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",p=h.toString,b=l.call(g),x=Ea._,A=m("^"+l.call(w).replace(Zs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=Ca?e.Buffer:rs,S=e.Symbol,P=e.Uint8Array,E=_?_.allocUnsafe:rs,C=pu(g.getPrototypeOf,g),T=g.create,N=h.propertyIsEnumerable,L=s.splice,M=S?S.isConcatSpreadable:rs,O=S?S.iterator:rs,R=S?S.toStringTag:rs,D=function(){try{var t=zn(g,"defineProperty");return t({},"",{}),t}catch(t){}}(),j=e.clearTimeout!==Ea.clearTimeout&&e.clearTimeout,F=r&&r.now!==Ea.Date.now&&r.now,B=e.setTimeout!==Ea.setTimeout&&e.setTimeout,V=o.ceil,I=o.floor,z=g.getOwnPropertySymbols,q=_?_.isBuffer:rs,H=e.isFinite,U=s.join,$=pu(g.keys,g),G=o.max,W=o.min,X=r.now,Y=e.parseInt,J=o.random,Z=s.reverse,K=zn(e,"DataView"),Q=zn(e,"Map"),tt=zn(e,"Promise"),et=zn(e,"Set"),nt=zn(e,"WeakMap"),rt=zn(g,"create"),it=nt&&new nt,ot={},st=gr(K),at=gr(Q),ut=gr(tt),lt=gr(et),ct=gr(nt),ht=S?S.prototype:rs,ft=ht?ht.valueOf:rs,dt=ht?ht.toString:rs;function pt(t){if(Mi(t)&&!xi(t)&&!(t instanceof bt)){if(t instanceof yt)return t;if(w.call(t,"__wrapped__"))return vr(t)}return new yt(t)}var gt=function(t){if(!Li(t))return{};if(T)return T(t);vt.prototype=t;var e=new vt;return vt.prototype=rs,e};function vt(){}function mt(){}function yt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=rs}function bt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ls,this.__views__=[]}function wt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function xt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function At(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function _t(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new At;++e<n;)this.add(t[e])}function St(t){var e=this.__data__=new xt(t);this.size=e.size}function kt(t,e){var n=xi(t),r=!n&&wi(t),i=!n&&!r&&ki(t),o=!n&&!r&&!i&&Ii(t),s=n||r||i||o,a=s?ru(t.length,c):[],u=a.length;for(var l in t)!e&&!w.call(t,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Xn(l,u))||a.push(l);return a}function Pt(t){var e=t.length;return e?t[_e(0,e-1)]:rs}function Et(t,e){return cr(on(t),jt(e,0,t.length))}function Ct(t){return cr(on(t))}function Tt(t,e,n){(n===rs||mi(t[e],n))&&(n!==rs||e in t)||Rt(t,e,n)}function Nt(t,e,n){var r=t[e];w.call(t,e)&&mi(r,n)&&(n!==rs||e in t)||Rt(t,e,n)}function Lt(t,e){for(var n=t.length;n--;)if(mi(t[n][0],e))return n;return-1}function Mt(t,r,i,o){return zt(t,function(t,e,n){r(o,t,i(t),n)}),o}function Ot(t,e){return t&&sn(e,uo(e),t)}function Rt(t,e,n){"__proto__"==e&&D?D(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Dt(t,e){for(var n=-1,r=e.length,i=k(r),o=null==t;++n<r;)i[n]=o?rs:ro(t,e[n]);return i}function jt(t,e,n){return t==t&&(n!==rs&&(t=t<=n?t:n),e!==rs&&(t=e<=t?t:e)),t}function Ft(n,r,i,t,e,o){var s,a=1&r,u=2&r,l=4&r;if(i&&(s=e?i(n,t,e,o):i(n)),s!==rs)return s;if(!Li(n))return n;var c=xi(n);if(c){if(s=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&w.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(n),!a)return on(n,s)}else{var h=Un(n),f=h==vs||h==ms;if(ki(n))return Ke(n,a);if(h==ws||h==hs||f&&!e){if(s=u||f?{}:Gn(n),!a)return u?function(t,e){return sn(t,Hn(t),e)}(n,function(t,e){return t&&sn(e,lo(e),t)}(s,n)):function(t,e){return sn(t,qn(t),e)}(n,Ot(s,n))}else{if(!Sa[h])return e?n:{};s=function(t,e,n){var r=t.constructor;switch(e){case Es:return Qe(t);case ds:case ps:return new r(+t);case Cs:return function(t,e){var n=e?Qe(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case Ts:case Ns:case Ls:case Ms:case Os:case Rs:case Ds:case js:case Fs:return tn(t,n);case ys:return new r;case bs:case Ss:return new r(t);case As:return function(t){var e=new t.constructor(t.source,ua.exec(t));return e.lastIndex=t.lastIndex,e}(t);case _s:return new r;case ks:return function(t){return ft?g(ft.call(t)):{}}(t)}}(n,h,a)}}var d=(o=o||new St).get(n);if(d)return d;o.set(n,s),Fi(n)?n.forEach(function(t){s.add(Ft(t,r,i,t,n,o))}):Oi(n)&&n.forEach(function(t,e){s.set(e,Ft(t,r,i,e,n,o))});var p=c?rs:(l?u?Rn:On:u?lo:uo)(n);return Fa(p||n,function(t,e){p&&(t=n[e=t]),Nt(s,e,Ft(t,r,i,e,n,o))}),s}function Bt(t,e,n){var r=n.length;if(null==t)return!r;for(t=g(t);r--;){var i=n[r],o=e[i],s=t[i];if(s===rs&&!(i in t)||!o(s))return!1}return!0}function Vt(t,e,n){if("function"!=typeof t)throw new y(is);return sr(function(){t.apply(rs,n)},e)}function It(t,e,n,r){var i=-1,o=za,s=!0,a=t.length,u=[],l=e.length;if(!a)return u;n&&(e=Ha(e,iu(n))),r?(o=qa,s=!1):200<=e.length&&(o=su,s=!1,e=new _t(e));t:for(;++i<a;){var c=t[i],h=null==n?c:n(c);if(c=r||0!==c?c:0,s&&h==h){for(var f=l;f--;)if(e[f]===h)continue t;u.push(c)}else o(e,h,r)||u.push(c)}return u}pt.templateSettings={escape:$s,evaluate:Gs,interpolate:Ws,variable:"",imports:{_:pt}},(pt.prototype=mt.prototype).constructor=pt,(yt.prototype=gt(mt.prototype)).constructor=yt,(bt.prototype=gt(mt.prototype)).constructor=bt,wt.prototype.clear=function(){this.__data__=rt?rt(null):{},this.size=0},wt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},wt.prototype.get=function(t){var e=this.__data__;if(rt){var n=e[t];return n===os?rs:n}return w.call(e,t)?e[t]:rs},wt.prototype.has=function(t){var e=this.__data__;return rt?e[t]!==rs:w.call(e,t)},wt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rt&&e===rs?os:e,this},xt.prototype.clear=function(){this.__data__=[],this.size=0},xt.prototype.delete=function(t){var e=this.__data__,n=Lt(e,t);return!(n<0)&&(n==e.length-1?e.pop():L.call(e,n,1),--this.size,!0)},xt.prototype.get=function(t){var e=this.__data__,n=Lt(e,t);return n<0?rs:e[n][1]},xt.prototype.has=function(t){return-1<Lt(this.__data__,t)},xt.prototype.set=function(t,e){var n=this.__data__,r=Lt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},At.prototype.clear=function(){this.size=0,this.__data__={hash:new wt,map:new(Q||xt),string:new wt}},At.prototype.delete=function(t){var e=Vn(this,t).delete(t);return this.size-=e?1:0,e},At.prototype.get=function(t){return Vn(this,t).get(t)},At.prototype.has=function(t){return Vn(this,t).has(t)},At.prototype.set=function(t,e){var n=Vn(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},_t.prototype.add=_t.prototype.push=function(t){return this.__data__.set(t,os),this},_t.prototype.has=function(t){return this.__data__.has(t)},St.prototype.clear=function(){this.__data__=new xt,this.size=0},St.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},St.prototype.get=function(t){return this.__data__.get(t)},St.prototype.has=function(t){return this.__data__.has(t)},St.prototype.set=function(t,e){var n=this.__data__;if(n instanceof xt){var r=n.__data__;if(!Q||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new At(r)}return n.set(t,e),this.size=n.size,this};var zt=ln(Yt),qt=ln(Jt,!0);function Ht(t,r){var i=!0;return zt(t,function(t,e,n){return i=!!r(t,e,n)}),i}function Ut(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],s=e(o);if(null!=s&&(a===rs?s==s&&!Vi(s):n(s,a)))var a=s,u=o}return u}function $t(t,r){var i=[];return zt(t,function(t,e,n){r(t,e,n)&&i.push(t)}),i}function Gt(t,e,n,r,i){var o=-1,s=t.length;for(n=n||Wn,i=i||[];++o<s;){var a=t[o];0<e&&n(a)?1<e?Gt(a,e-1,n,r,i):Ua(i,a):r||(i[i.length]=a)}return i}var Wt=cn(),Xt=cn(!0);function Yt(t,e){return t&&Wt(t,e,uo)}function Jt(t,e){return t&&Xt(t,e,uo)}function Zt(e,t){return Ia(t,function(t){return Ci(e[t])})}function Kt(t,e){for(var n=0,r=(e=Xe(e,t)).length;null!=t&&n<r;)t=t[pr(e[n++])];return n&&n==r?t:rs}function Qt(t,e,n){var r=e(t);return xi(t)?r:Ua(r,n(t))}function te(t){return null==t?t===rs?"[object Undefined]":"[object Null]":R&&R in g(t)?function(t){var e=w.call(t,R),n=t[R];try{t[R]=rs;var r=!0}catch(t){}var i=p.call(t);r&&(e?t[R]=n:delete t[R]);return i}(t):function(t){return p.call(t)}(t)}function ee(t,e){return e<t}function ne(t,e){return null!=t&&w.call(t,e)}function re(t,e){return null!=t&&e in g(t)}function ie(t,e,n){for(var r=n?qa:za,i=t[0].length,o=t.length,s=o,a=k(o),u=1/0,l=[];s--;){var c=t[s];s&&e&&(c=Ha(c,iu(e))),u=W(c.length,u),a[s]=!n&&(e||120<=i&&120<=c.length)?new _t(s&&c):rs}c=t[0];var h=-1,f=a[0];t:for(;++h<i&&l.length<u;){var d=c[h],p=e?e(d):d;if(d=n||0!==d?d:0,!(f?su(f,p):r(l,p,n))){for(s=o;--s;){var g=a[s];if(!(g?su(g,p):r(t[s],p,n)))continue t}f&&f.push(p),l.push(d)}}return l}function oe(t,e,n){var r=null==(t=rr(t,e=Xe(e,t)))?t:t[pr(Er(e))];return null==r?rs:Da(r,t,n)}function se(t){return Mi(t)&&te(t)==hs}function ae(t,e,n,r,i){return t===e||(null==t||null==e||!Mi(t)&&!Mi(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var s=xi(t),a=xi(e),u=s?fs:Un(t),l=a?fs:Un(e),c=(u=u==hs?ws:u)==ws,h=(l=l==hs?ws:l)==ws,f=u==l;if(f&&ki(t)){if(!ki(e))return!1;c=!(s=!0)}if(f&&!c)return o=o||new St,s||Ii(t)?Ln(t,e,n,r,i,o):function(t,e,n,r,i,o,s){switch(n){case Cs:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Es:return!(t.byteLength!=e.byteLength||!o(new P(t),new P(e)));case ds:case ps:case bs:return mi(+t,+e);case gs:return t.name==e.name&&t.message==e.message;case As:case Ss:return t==e+"";case ys:var a=du;case _s:var u=1&r;if(a=a||vu,t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;r|=2,s.set(t,e);var c=Ln(a(t),a(e),r,i,o,s);return s.delete(t),c;case ks:if(ft)return ft.call(t)==ft.call(e)}return!1}(t,e,u,n,r,i,o);if(!(1&n)){var d=c&&w.call(t,"__wrapped__"),p=h&&w.call(e,"__wrapped__");if(d||p){var g=d?t.value():t,v=p?e.value():e;return o=o||new St,i(g,v,n,r,o)}}return f&&(o=o||new St,function(t,e,n,r,i,o){var s=1&n,a=On(t),u=a.length,l=On(e).length;if(u!=l&&!s)return!1;var c=u;for(;c--;){var h=a[c];if(!(s?h in e:w.call(e,h)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var d=!0;o.set(t,e),o.set(e,t);var p=s;for(;++c<u;){h=a[c];var g=t[h],v=e[h];if(r)var m=s?r(v,g,h,e,t,o):r(g,v,h,t,e,o);if(!(m===rs?g===v||i(g,v,n,r,o):m)){d=!1;break}p=p||"constructor"==h}if(d&&!p){var y=t.constructor,b=e.constructor;y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(d=!1)}return o.delete(t),o.delete(e),d}(t,e,n,r,i,o))}(t,e,n,r,ae,i))}function ue(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=g(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var u=(a=n[i])[0],l=t[u],c=a[1];if(s&&a[2]){if(l===rs&&!(u in t))return!1}else{var h=new St;if(r)var f=r(l,c,u,t,e,h);if(!(f===rs?ae(c,l,3,r,h):f))return!1}}return!0}function le(t){return!(!Li(t)||function(t){return!!d&&d in t}(t))&&(Ci(t)?A:ha).test(gr(t))}function ce(t){return"function"==typeof t?t:null==t?Do:"object"==typeof t?xi(t)?ve(t[0],t[1]):ge(t):Uo(t)}function he(t){if(!Qn(t))return $(t);var e=[];for(var n in g(t))w.call(t,n)&&"constructor"!=n&&e.push(n);return e}function fe(t){if(!Li(t))return function(t){var e=[];if(null!=t)for(var n in g(t))e.push(n);return e}(t);var e=Qn(t),n=[];for(var r in t)("constructor"!=r||!e&&w.call(t,r))&&n.push(r);return n}function de(t,e){return t<e}function pe(t,r){var i=-1,o=_i(t)?k(t.length):[];return zt(t,function(t,e,n){o[++i]=r(t,e,n)}),o}function ge(e){var n=In(e);return 1==n.length&&n[0][2]?er(n[0][0],n[0][1]):function(t){return t===e||ue(t,e,n)}}function ve(n,r){return Jn(n)&&tr(r)?er(pr(n),r):function(t){var e=ro(t,n);return e===rs&&e===r?io(t,n):ae(r,e,3)}}function me(r,i,o,s,a){r!==i&&Wt(i,function(t,e){if(a=a||new St,Li(t))!function(t,e,n,r,i,o,s){var a=ir(t,n),u=ir(e,n),l=s.get(u);if(l)return Tt(t,n,l);var c=o?o(a,u,n+"",t,e,s):rs,h=c===rs;if(h){var f=xi(u),d=!f&&ki(u),p=!f&&!d&&Ii(u);c=u,f||d||p?c=xi(a)?a:Si(a)?on(a):d?Ke(u,!(h=!1)):p?tn(u,!(h=!1)):[]:Di(u)||wi(u)?wi(c=a)?c=Xi(a):Li(a)&&!Ci(a)||(c=Gn(u)):h=!1}h&&(s.set(u,c),i(c,u,r,o,s),s.delete(u));Tt(t,n,c)}(r,i,e,o,me,s,a);else{var n=s?s(ir(r,e),t,e+"",r,i,a):rs;n===rs&&(n=t),Tt(r,e,n)}},lo)}function ye(t,e){var n=t.length;if(n)return Xn(e+=e<0?n:0,n)?t[e]:rs}function be(t,r,n){var i=-1;return r=Ha(r.length?r:[Do],iu(Bn())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(pe(t,function(e,t,n){return{criteria:Ha(r,function(t){return t(e)}),index:++i,value:e}}),function(t,e){return function(t,e,n){var r=-1,i=t.criteria,o=e.criteria,s=i.length,a=n.length;for(;++r<s;){var u=en(i[r],o[r]);if(u){if(a<=r)return u;var l=n[r];return u*("desc"==l?-1:1)}}return t.index-e.index}(t,e,n)})}function we(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=Kt(t,s);n(a,s)&&Ce(o,Xe(s,t),a)}return o}function xe(t,e,n,r){var i=r?Za:Ja,o=-1,s=e.length,a=t;for(t===e&&(e=on(e)),n&&(a=Ha(t,iu(n)));++o<s;)for(var u=0,l=e[o],c=n?n(l):l;-1<(u=i(a,c,u,r));)a!==t&&L.call(a,u,1),L.call(t,u,1);return t}function Ae(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Xn(i)?L.call(t,i,1):Ie(t,i)}}return t}function _e(t,e){return t+I(J()*(e-t+1))}function Se(t,e){var n="";if(!t||e<1||as<e)return n;for(;e%2&&(n+=t),(e=I(e/2))&&(t+=t),e;);return n}function ke(t,e){return ar(nr(t,e,Do),t+"")}function Pe(t){return Pt(yo(t))}function Ee(t,e){var n=yo(t);return cr(n,jt(e,0,n.length))}function Ce(t,e,n,r){if(!Li(t))return t;for(var i=-1,o=(e=Xe(e,t)).length,s=o-1,a=t;null!=a&&++i<o;){var u=pr(e[i]),l=n;if(i!=s){var c=a[u];(l=r?r(c,u,a):rs)===rs&&(l=Li(c)?c:Xn(e[i+1])?[]:{})}Nt(a,u,l),a=a[u]}return t}var Te=it?function(t,e){return it.set(t,e),t}:Do,Ne=D?function(t,e){return D(t,"toString",{configurable:!0,enumerable:!1,value:Mo(e),writable:!0})}:Do;function Le(t){return cr(yo(t))}function Me(t,e,n){var r=-1,i=t.length;e<0&&(e=i<-e?0:i+e),(n=i<n?i:n)<0&&(n+=i),i=n<e?0:n-e>>>0,e>>>=0;for(var o=k(i);++r<i;)o[r]=t[r+e];return o}function Oe(t,r){var i;return zt(t,function(t,e,n){return!(i=r(t,e,n))}),!!i}function Re(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!Vi(s)&&(n?s<=e:s<e)?r=1+o:i=o}return i}return De(t,e,Do,n)}function De(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,s=e!=e,a=null===e,u=Vi(e),l=e===rs;i<o;){var c=I((i+o)/2),h=n(t[c]),f=h!==rs,d=null===h,p=h==h,g=Vi(h);if(s)var v=r||p;else v=l?p&&(r||f):a?p&&f&&(r||!d):u?p&&f&&!d&&(r||!g):!d&&!g&&(r?h<=e:h<e);v?i=c+1:o=c}return W(o,4294967294)}function je(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!mi(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function Fe(t){return"number"==typeof t?t:Vi(t)?us:+t}function Be(t){if("string"==typeof t)return t;if(xi(t))return Ha(t,Be)+"";if(Vi(t))return dt?dt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ve(t,e,n){var r=-1,i=za,o=t.length,s=!0,a=[],u=a;if(n)s=!1,i=qa;else if(200<=o){var l=e?null:kn(t);if(l)return vu(l);s=!1,i=su,u=new _t}else u=e?[]:a;t:for(;++r<o;){var c=t[r],h=e?e(c):c;if(c=n||0!==c?c:0,s&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),a.push(c)}else i(u,h,n)||(u!==a&&u.push(h),a.push(c))}return a}function Ie(t,e){return null==(t=rr(t,e=Xe(e,t)))||delete t[pr(Er(e))]}function ze(t,e,n,r){return Ce(t,e,n(Kt(t,e)),r)}function qe(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Me(t,r?0:o,r?o+1:i):Me(t,r?o+1:0,r?i:o)}function He(t,e){var n=t;return n instanceof bt&&(n=n.value()),$a(e,function(t,e){return e.func.apply(e.thisArg,Ua([t],e.args))},n)}function Ue(t,e,n){var r=t.length;if(r<2)return r?Ve(t[0]):[];for(var i=-1,o=k(r);++i<r;)for(var s=t[i],a=-1;++a<r;)a!=i&&(o[i]=It(o[i]||s,t[a],e,n));return Ve(Gt(o,1),e,n)}function $e(t,e,n){for(var r=-1,i=t.length,o=e.length,s={};++r<i;){var a=r<o?e[r]:rs;n(s,t[r],a)}return s}function Ge(t){return Si(t)?t:[]}function We(t){return"function"==typeof t?t:Do}function Xe(t,e){return xi(t)?t:Jn(t,e)?[t]:dr(Yi(t))}var Ye=ke;function Je(t,e,n){var r=t.length;return n=n===rs?r:n,!e&&r<=n?t:Me(t,e,n)}var Ze=j||function(t){return Ea.clearTimeout(t)};function Ke(t,e){if(e)return t.slice();var n=t.length,r=E?E(n):new t.constructor(n);return t.copy(r),r}function Qe(t){var e=new t.constructor(t.byteLength);return new P(e).set(new P(t)),e}function tn(t,e){var n=e?Qe(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function en(t,e){if(t!==e){var n=t!==rs,r=null===t,i=t==t,o=Vi(t),s=e!==rs,a=null===e,u=e==e,l=Vi(e);if(!a&&!l&&!o&&e<t||o&&s&&u&&!a&&!l||r&&s&&u||!n&&u||!i)return 1;if(!r&&!o&&!l&&t<e||l&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!u)return-1}return 0}function nn(t,e,n,r){for(var i=-1,o=t.length,s=n.length,a=-1,u=e.length,l=G(o-s,0),c=k(u+l),h=!r;++a<u;)c[a]=e[a];for(;++i<s;)(h||i<o)&&(c[n[i]]=t[i]);for(;l--;)c[a++]=t[i++];return c}function rn(t,e,n,r){for(var i=-1,o=t.length,s=-1,a=n.length,u=-1,l=e.length,c=G(o-a,0),h=k(c+l),f=!r;++i<c;)h[i]=t[i];for(var d=i;++u<l;)h[d+u]=e[u];for(;++s<a;)(f||i<o)&&(h[d+n[s]]=t[i++]);return h}function on(t,e){var n=-1,r=t.length;for(e=e||k(r);++n<r;)e[n]=t[n];return e}function sn(t,e,n,r){var i=!n;n=n||{};for(var o=-1,s=e.length;++o<s;){var a=e[o],u=r?r(n[a],t[a],a,n,t):rs;u===rs&&(u=t[a]),i?Rt(n,a,u):Nt(n,a,u)}return n}function an(i,o){return function(t,e){var n=xi(t)?ja:Mt,r=o?o():{};return n(t,i,Bn(e,2),r)}}function un(a){return ke(function(t,e){var n=-1,r=e.length,i=1<r?e[r-1]:rs,o=2<r?e[2]:rs;for(i=3<a.length&&"function"==typeof i?(r--,i):rs,o&&Yn(e[0],e[1],o)&&(i=r<3?rs:i,r=1),t=g(t);++n<r;){var s=e[n];s&&a(t,s,n,i)}return t})}function ln(o,s){return function(t,e){if(null==t)return t;if(!_i(t))return o(t,e);for(var n=t.length,r=s?n:-1,i=g(t);(s?r--:++r<n)&&!1!==e(i[r],r,i););return t}}function cn(u){return function(t,e,n){for(var r=-1,i=g(t),o=n(t),s=o.length;s--;){var a=o[u?s:++r];if(!1===e(i[a],a,i))break}return t}}function hn(i){return function(t){var e=fu(t=Yi(t))?yu(t):rs,n=e?e[0]:t.charAt(0),r=e?Je(e,1).join(""):t.slice(1);return n[i]()+r}}function fn(e){return function(t){return $a(To(xo(t).replace(ma,"")),e,"")}}function dn(r){return function(){var t=arguments;switch(t.length){case 0:return new r;case 1:return new r(t[0]);case 2:return new r(t[0],t[1]);case 3:return new r(t[0],t[1],t[2]);case 4:return new r(t[0],t[1],t[2],t[3]);case 5:return new r(t[0],t[1],t[2],t[3],t[4]);case 6:return new r(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new r(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=gt(r.prototype),n=r.apply(e,t);return Li(n)?n:e}}function pn(s){return function(t,e,n){var r=g(t);if(!_i(t)){var i=Bn(e,3);t=uo(t),e=function(t){return i(r[t],t,r)}}var o=s(t,e,n);return-1<o?r[i?t[o]:o]:rs}}function gn(u){return Mn(function(i){var o=i.length,t=o,e=yt.prototype.thru;for(u&&i.reverse();t--;){var n=i[t];if("function"!=typeof n)throw new y(is);if(e&&!s&&"wrapper"==jn(n))var s=new yt([],!0)}for(t=s?t:o;++t<o;){var r=jn(n=i[t]),a="wrapper"==r?Dn(n):rs;s=a&&Zn(a[0])&&424==a[1]&&!a[4].length&&1==a[9]?s[jn(a[0])].apply(s,a[3]):1==n.length&&Zn(n)?s[r]():s.thru(n)}return function(){var t=arguments,e=t[0];if(s&&1==t.length&&xi(e))return s.plant(e).value();for(var n=0,r=o?i[n].apply(this,t):e;++n<o;)r=i[n].call(this,r);return r}})}function vn(l,c,h,f,d,p,g,v,m,y){var b=128&c,w=1&c,x=2&c,A=24&c,_=512&c,S=x?rs:dn(l);return function t(){for(var e=arguments.length,n=k(e),r=e;r--;)n[r]=arguments[r];if(A)var i=Fn(t),o=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(n,i);if(f&&(n=nn(n,f,d,A)),p&&(n=rn(n,p,g,A)),e-=o,A&&e<y){var s=gu(n,i);return _n(l,c,vn,t.placeholder,h,n,s,v,m,y-e)}var a=w?h:this,u=x?a[l]:l;return e=n.length,v?n=function(t,e){for(var n=t.length,r=W(e.length,n),i=on(t);r--;){var o=e[r];t[r]=Xn(o,n)?i[o]:rs}return t}(n,v):_&&1<e&&n.reverse(),b&&m<e&&(n.length=m),this&&this!==Ea&&this instanceof t&&(u=S||dn(u)),u.apply(a,n)}}function mn(n,r){return function(t,e){return function(t,r,i,o){return Yt(t,function(t,e,n){r(o,i(t),e,n)}),o}(t,n,r(e),{})}}function yn(r,i){return function(t,e){var n;if(t===rs&&e===rs)return i;if(t!==rs&&(n=t),e!==rs){if(n===rs)return e;e="string"==typeof t||"string"==typeof e?(t=Be(t),Be(e)):(t=Fe(t),Fe(e)),n=r(t,e)}return n}}function bn(r){return Mn(function(t){return t=Ha(t,iu(Bn())),ke(function(e){var n=this;return r(t,function(t){return Da(t,n,e)})})})}function wn(t,e){var n=(e=e===rs?" ":Be(e)).length;if(n<2)return n?Se(e,t):e;var r=Se(e,V(t/mu(e)));return fu(e)?Je(yu(r),0,t).join(""):r.slice(0,t)}function xn(r){return function(t,e,n){return n&&"number"!=typeof n&&Yn(t,e,n)&&(e=n=rs),t=Ui(t),e===rs?(e=t,t=0):e=Ui(e),function(t,e,n,r){for(var i=-1,o=G(V((e-t)/(n||1)),0),s=k(o);o--;)s[r?o:++i]=t,t+=n;return s}(t,e,n=n===rs?t<e?1:-1:Ui(n),r)}}function An(n){return function(t,e){return"string"==typeof t&&"string"==typeof e||(t=Wi(t),e=Wi(e)),n(t,e)}}function _n(t,e,n,r,i,o,s,a,u,l){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var h=[t,e,i,c?o:rs,c?s:rs,c?rs:o,c?rs:s,a,u,l],f=n.apply(rs,h);return Zn(t)&&or(f,h),f.placeholder=r,ur(f,t,e)}function Sn(t){var r=o[t];return function(t,e){if(t=Wi(t),(e=null==e?0:W($i(e),292))&&H(t)){var n=(Yi(t)+"e").split("e");return+((n=(Yi(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}var kn=et&&1/vu(new et([,-0]))[1]==1/0?function(t){return new et(t)}:Io;function Pn(n){return function(t){var e=Un(t);return e==ys?du(t):e==_s?function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}(t):function(e,t){return Ha(t,function(t){return[t,e[t]]})}(t,n(t))}}function En(t,e,n,r,i,o,s,a){var u=2&e;if(!u&&"function"!=typeof t)throw new y(is);var l=r?r.length:0;if(l||(e&=-97,r=i=rs),s=s===rs?s:G($i(s),0),a=a===rs?a:$i(a),l-=i?i.length:0,64&e){var c=r,h=i;r=i=rs}var f=u?rs:Dn(t),d=[t,e,n,r,i,c,h,o,s,a];if(f&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,s=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!s)return;1&r&&(t[2]=e[2],i|=1&n?0:4);var a=e[3];if(a){var u=t[3];t[3]=u?nn(u,a,e[4]):a,t[4]=u?gu(t[3],ss):e[4]}(a=e[5])&&(u=t[5],t[5]=u?rn(u,a,e[6]):a,t[6]=u?gu(t[5],ss):e[6]);(a=e[7])&&(t[7]=a);128&r&&(t[8]=null==t[8]?e[8]:W(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(d,f),t=d[0],e=d[1],n=d[2],r=d[3],i=d[4],!(a=d[9]=d[9]===rs?u?0:t.length:G(d[9]-l,0))&&24&e&&(e&=-25),e&&1!=e)p=8==e||16==e?function(s,a,u){var l=dn(s);return function t(){for(var e=arguments.length,n=k(e),r=e,i=Fn(t);r--;)n[r]=arguments[r];var o=e<3&&n[0]!==i&&n[e-1]!==i?[]:gu(n,i);return(e-=o.length)<u?_n(s,a,vn,t.placeholder,rs,n,o,rs,rs,u-e):Da(this&&this!==Ea&&this instanceof t?l:s,this,n)}}(t,e,a):32!=e&&33!=e||i.length?vn.apply(rs,d):function(a,t,u,l){var c=1&t,h=dn(a);return function t(){for(var e=-1,n=arguments.length,r=-1,i=l.length,o=k(i+n),s=this&&this!==Ea&&this instanceof t?h:a;++r<i;)o[r]=l[r];for(;n--;)o[r++]=arguments[++e];return Da(s,c?u:this,o)}}(t,e,n,r);else var p=function(e,t,n){var r=1&t,i=dn(e);return function t(){return(this&&this!==Ea&&this instanceof t?i:e).apply(r?n:this,arguments)}}(t,e,n);return ur((f?Te:or)(p,d),t,e)}function Cn(t,e,n,r){return t===rs||mi(t,h[n])&&!w.call(r,n)?e:t}function Tn(t,e,n,r,i,o){return Li(t)&&Li(e)&&(o.set(e,t),me(t,e,rs,Tn,o),o.delete(e)),t}function Nn(t){return Di(t)?rs:t}function Ln(t,e,n,r,i,o){var s=1&n,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;var l=o.get(t);if(l&&o.get(e))return l==e;var c=-1,h=!0,f=2&n?new _t:rs;for(o.set(t,e),o.set(e,t);++c<a;){var d=t[c],p=e[c];if(r)var g=s?r(p,d,c,e,t,o):r(d,p,c,t,e,o);if(g!==rs){if(g)continue;h=!1;break}if(f){if(!Wa(e,function(t,e){if(!su(f,e)&&(d===t||i(d,t,n,r,o)))return f.push(e)})){h=!1;break}}else if(d!==p&&!i(d,p,n,r,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function Mn(t){return ar(nr(t,rs,Ar),t+"")}function On(t){return Qt(t,uo,qn)}function Rn(t){return Qt(t,lo,Hn)}var Dn=it?function(t){return it.get(t)}:Io;function jn(t){for(var e=t.name+"",n=ot[e],r=w.call(ot,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Fn(t){return(w.call(pt,"placeholder")?pt:t).placeholder}function Bn(){var t=pt.iteratee||jo;return t=t===jo?ce:t,arguments.length?t(arguments[0],arguments[1]):t}function Vn(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function In(t){for(var e=uo(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,tr(i)]}return e}function zn(t,e){var n=function(t,e){return null==t?rs:t[e]}(t,e);return le(n)?n:rs}var qn=z?function(e){return null==e?[]:(e=g(e),Ia(z(e),function(t){return N.call(e,t)}))}:Wo,Hn=z?function(t){for(var e=[];t;)Ua(e,qn(t)),t=C(t);return e}:Wo,Un=te;function $n(t,e,n){for(var r=-1,i=(e=Xe(e,t)).length,o=!1;++r<i;){var s=pr(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Ni(i)&&Xn(s,i)&&(xi(t)||wi(t))}function Gn(t){return"function"!=typeof t.constructor||Qn(t)?{}:gt(C(t))}function Wn(t){return xi(t)||wi(t)||!!(M&&t&&t[M])}function Xn(t,e){var n=typeof t;return!!(e=null==e?as:e)&&("number"==n||"symbol"!=n&&da.test(t))&&-1<t&&t%1==0&&t<e}function Yn(t,e,n){if(!Li(n))return!1;var r=typeof e;return!!("number"==r?_i(n)&&Xn(e,n.length):"string"==r&&e in n)&&mi(n[e],t)}function Jn(t,e){if(xi(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Vi(t))||(Ys.test(t)||!Xs.test(t)||null!=e&&t in g(e))}function Zn(t){var e=jn(t),n=pt[e];if("function"!=typeof n||!(e in bt.prototype))return!1;if(t===n)return!0;var r=Dn(n);return!!r&&t===r[0]}(K&&Un(new K(new ArrayBuffer(1)))!=Cs||Q&&Un(new Q)!=ys||tt&&Un(tt.resolve())!=xs||et&&Un(new et)!=_s||nt&&Un(new nt)!=Ps)&&(Un=function(t){var e=te(t),n=e==ws?t.constructor:rs,r=n?gr(n):"";if(r)switch(r){case st:return Cs;case at:return ys;case ut:return xs;case lt:return _s;case ct:return Ps}return e});var Kn=u?Ci:Xo;function Qn(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||h)}function tr(t){return t==t&&!Li(t)}function er(e,n){return function(t){return null!=t&&(t[e]===n&&(n!==rs||e in g(t)))}}function nr(o,s,a){return s=G(s===rs?o.length-1:s,0),function(){for(var t=arguments,e=-1,n=G(t.length-s,0),r=k(n);++e<n;)r[e]=t[s+e];e=-1;for(var i=k(s+1);++e<s;)i[e]=t[e];return i[s]=a(r),Da(o,this,i)}}function rr(t,e){return e.length<2?t:Kt(t,Me(e,0,-1))}function ir(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var or=lr(Te),sr=B||function(t,e){return Ea.setTimeout(t,e)},ar=lr(Ne);function ur(t,e,n){var r=e+"";return ar(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(1<n?"& ":"")+e[r],e=e.join(2<n?", ":" "),t.replace(na,"{\n/* [wrapped with "+e+"] */\n")}(r,function(n,r){return Fa(cs,function(t){var e="_."+t[0];r&t[1]&&!za(n,e)&&n.push(e)}),n.sort()}(function(t){var e=t.match(ra);return e?e[1].split(ia):[]}(r),n)))}function lr(n){var r=0,i=0;return function(){var t=X(),e=16-(t-i);if(i=t,0<e){if(800<=++r)return arguments[0]}else r=0;return n.apply(rs,arguments)}}function cr(t,e){var n=-1,r=t.length,i=r-1;for(e=e===rs?r:e;++n<e;){var o=_e(n,i),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}var hr,fr,dr=(fr=(hr=hi(function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(Js,function(t,e,n,r){i.push(n?r.replace(sa,"$1"):e||t)}),i},function(t){return 500===fr.size&&fr.clear(),t})).cache,hr);function pr(t){if("string"==typeof t||Vi(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function gr(t){if(null!=t){try{return l.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function vr(t){if(t instanceof bt)return t.clone();var e=new yt(t.__wrapped__,t.__chain__);return e.__actions__=on(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var mr=ke(function(t,e){return Si(t)?It(t,Gt(e,1,Si,!0)):[]}),yr=ke(function(t,e){var n=Er(e);return Si(n)&&(n=rs),Si(t)?It(t,Gt(e,1,Si,!0),Bn(n,2)):[]}),br=ke(function(t,e){var n=Er(e);return Si(n)&&(n=rs),Si(t)?It(t,Gt(e,1,Si,!0),rs,n):[]});function wr(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:$i(n);return i<0&&(i=G(r+i,0)),Ya(t,Bn(e,3),i)}function xr(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==rs&&(i=$i(n),i=n<0?G(r+i,0):W(i,r-1)),Ya(t,Bn(e,3),i,!0)}function Ar(t){return(null==t?0:t.length)?Gt(t,1):[]}function _r(t){return t&&t.length?t[0]:rs}var Sr=ke(function(t){var e=Ha(t,Ge);return e.length&&e[0]===t[0]?ie(e):[]}),kr=ke(function(t){var e=Er(t),n=Ha(t,Ge);return e===Er(n)?e=rs:n.pop(),n.length&&n[0]===t[0]?ie(n,Bn(e,2)):[]}),Pr=ke(function(t){var e=Er(t),n=Ha(t,Ge);return(e="function"==typeof e?e:rs)&&n.pop(),n.length&&n[0]===t[0]?ie(n,rs,e):[]});function Er(t){var e=null==t?0:t.length;return e?t[e-1]:rs}var Cr=ke(Tr);function Tr(t,e){return t&&t.length&&e&&e.length?xe(t,e):t}var Nr=Mn(function(t,e){var n=null==t?0:t.length,r=Dt(t,e);return Ae(t,Ha(e,function(t){return Xn(t,n)?+t:t}).sort(en)),r});function Lr(t){return null==t?t:Z.call(t)}var Mr=ke(function(t){return Ve(Gt(t,1,Si,!0))}),Or=ke(function(t){var e=Er(t);return Si(e)&&(e=rs),Ve(Gt(t,1,Si,!0),Bn(e,2))}),Rr=ke(function(t){var e=Er(t);return e="function"==typeof e?e:rs,Ve(Gt(t,1,Si,!0),rs,e)});function Dr(e){if(!e||!e.length)return[];var n=0;return e=Ia(e,function(t){if(Si(t))return n=G(t.length,n),!0}),ru(n,function(t){return Ha(e,tu(t))})}function jr(t,e){if(!t||!t.length)return[];var n=Dr(t);return null==e?n:Ha(n,function(t){return Da(e,rs,t)})}var Fr=ke(function(t,e){return Si(t)?It(t,e):[]}),Br=ke(function(t){return Ue(Ia(t,Si))}),Vr=ke(function(t){var e=Er(t);return Si(e)&&(e=rs),Ue(Ia(t,Si),Bn(e,2))}),Ir=ke(function(t){var e=Er(t);return e="function"==typeof e?e:rs,Ue(Ia(t,Si),rs,e)}),zr=ke(Dr);var qr=ke(function(t){var e=t.length,n=1<e?t[e-1]:rs;return n="function"==typeof n?(t.pop(),n):rs,jr(t,n)});function Hr(t){var e=pt(t);return e.__chain__=!0,e}function Ur(t,e){return e(t)}var $r=Mn(function(e){function t(t){return Dt(t,e)}var n=e.length,r=n?e[0]:0,i=this.__wrapped__;return!(1<n||this.__actions__.length)&&i instanceof bt&&Xn(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:Ur,args:[t],thisArg:rs}),new yt(i,this.__chain__).thru(function(t){return n&&!t.length&&t.push(rs),t})):this.thru(t)});var Gr=an(function(t,e,n){w.call(t,n)?++t[n]:Rt(t,n,1)});var Wr=pn(wr),Xr=pn(xr);function Yr(t,e){return(xi(t)?Fa:zt)(t,Bn(e,3))}function Jr(t,e){return(xi(t)?Ba:qt)(t,Bn(e,3))}var Zr=an(function(t,e,n){w.call(t,n)?t[n].push(e):Rt(t,n,[e])});var Kr=ke(function(t,e,n){var r=-1,i="function"==typeof e,o=_i(t)?k(t.length):[];return zt(t,function(t){o[++r]=i?Da(e,t,n):oe(t,e,n)}),o}),Qr=an(function(t,e,n){Rt(t,n,e)});function ti(t,e){return(xi(t)?Ha:pe)(t,Bn(e,3))}var ei=an(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var ni=ke(function(t,e){if(null==t)return[];var n=e.length;return 1<n&&Yn(t,e[0],e[1])?e=[]:2<n&&Yn(e[0],e[1],e[2])&&(e=[e[0]]),be(t,Gt(e,1),[])}),ri=F||function(){return Ea.Date.now()};function ii(t,e,n){return e=n?rs:e,e=t&&null==e?t.length:e,En(t,128,rs,rs,rs,rs,e)}function oi(t,e){var n;if("function"!=typeof e)throw new y(is);return t=$i(t),function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=rs),n}}var si=ke(function(t,e,n){var r=1;if(n.length){var i=gu(n,Fn(si));r|=32}return En(t,r,e,n,i)}),ai=ke(function(t,e,n){var r=3;if(n.length){var i=gu(n,Fn(ai));r|=32}return En(e,r,t,n,i)});function ui(r,n,t){var i,o,s,a,u,l,c=0,h=!1,f=!1,e=!0;if("function"!=typeof r)throw new y(is);function d(t){var e=i,n=o;return i=o=rs,c=t,a=r.apply(n,e)}function p(t){var e=t-l;return l===rs||n<=e||e<0||f&&s<=t-c}function g(){var t=ri();if(p(t))return v(t);u=sr(g,function(t){var e=n-(t-l);return f?W(e,s-(t-c)):e}(t))}function v(t){return u=rs,e&&i?d(t):(i=o=rs,a)}function m(){var t=ri(),e=p(t);if(i=arguments,o=this,l=t,e){if(u===rs)return function(t){return c=t,u=sr(g,n),h?d(t):a}(l);if(f)return Ze(u),u=sr(g,n),d(l)}return u===rs&&(u=sr(g,n)),a}return n=Wi(n)||0,Li(t)&&(h=!!t.leading,s=(f="maxWait"in t)?G(Wi(t.maxWait)||0,n):s,e="trailing"in t?!!t.trailing:e),m.cancel=function(){u!==rs&&Ze(u),c=0,i=l=o=u=rs},m.flush=function(){return u===rs?a:v(ri())},m}var li=ke(function(t,e){return Vt(t,1,e)}),ci=ke(function(t,e,n){return Vt(t,Wi(e)||0,n)});function hi(i,o){if("function"!=typeof i||null!=o&&"function"!=typeof o)throw new y(is);var s=function(){var t=arguments,e=o?o.apply(this,t):t[0],n=s.cache;if(n.has(e))return n.get(e);var r=i.apply(this,t);return s.cache=n.set(e,r)||n,r};return s.cache=new(hi.Cache||At),s}function fi(e){if("function"!=typeof e)throw new y(is);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}hi.Cache=At;var di=Ye(function(r,i){var o=(i=1==i.length&&xi(i[0])?Ha(i[0],iu(Bn())):Ha(Gt(i,1),iu(Bn()))).length;return ke(function(t){for(var e=-1,n=W(t.length,o);++e<n;)t[e]=i[e].call(this,t[e]);return Da(r,this,t)})}),pi=ke(function(t,e){var n=gu(e,Fn(pi));return En(t,32,rs,e,n)}),gi=ke(function(t,e){var n=gu(e,Fn(gi));return En(t,64,rs,e,n)}),vi=Mn(function(t,e){return En(t,256,rs,rs,rs,e)});function mi(t,e){return t===e||t!=t&&e!=e}var yi=An(ee),bi=An(function(t,e){return e<=t}),wi=se(function(){return arguments}())?se:function(t){return Mi(t)&&w.call(t,"callee")&&!N.call(t,"callee")},xi=k.isArray,Ai=Ta?iu(Ta):function(t){return Mi(t)&&te(t)==Es};function _i(t){return null!=t&&Ni(t.length)&&!Ci(t)}function Si(t){return Mi(t)&&_i(t)}var ki=q||Xo,Pi=Na?iu(Na):function(t){return Mi(t)&&te(t)==ps};function Ei(t){if(!Mi(t))return!1;var e=te(t);return e==gs||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Di(t)}function Ci(t){if(!Li(t))return!1;var e=te(t);return e==vs||e==ms||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ti(t){return"number"==typeof t&&t==$i(t)}function Ni(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=as}function Li(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Mi(t){return null!=t&&"object"==typeof t}var Oi=La?iu(La):function(t){return Mi(t)&&Un(t)==ys};function Ri(t){return"number"==typeof t||Mi(t)&&te(t)==bs}function Di(t){if(!Mi(t)||te(t)!=ws)return!1;var e=C(t);if(null===e)return!0;var n=w.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==b}var ji=Ma?iu(Ma):function(t){return Mi(t)&&te(t)==As};var Fi=Oa?iu(Oa):function(t){return Mi(t)&&Un(t)==_s};function Bi(t){return"string"==typeof t||!xi(t)&&Mi(t)&&te(t)==Ss}function Vi(t){return"symbol"==typeof t||Mi(t)&&te(t)==ks}var Ii=Ra?iu(Ra):function(t){return Mi(t)&&Ni(t.length)&&!!_a[te(t)]};var zi=An(de),qi=An(function(t,e){return t<=e});function Hi(t){if(!t)return[];if(_i(t))return Bi(t)?yu(t):on(t);if(O&&t[O])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[O]());var e=Un(t);return(e==ys?du:e==_s?vu:yo)(t)}function Ui(t){return t?(t=Wi(t))!==1/0&&t!==-1/0?t==t?t:0:17976931348623157e292*(t<0?-1:1):0===t?t:0}function $i(t){var e=Ui(t),n=e%1;return e==e?n?e-n:e:0}function Gi(t){return t?jt($i(t),0,ls):0}function Wi(t){if("number"==typeof t)return t;if(Vi(t))return us;if(Li(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Li(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Qs,"");var n=ca.test(t);return n||fa.test(t)?Pa(t.slice(2),n?2:8):la.test(t)?us:+t}function Xi(t){return sn(t,lo(t))}function Yi(t){return null==t?"":Be(t)}var Ji=un(function(t,e){if(Qn(e)||_i(e))sn(e,uo(e),t);else for(var n in e)w.call(e,n)&&Nt(t,n,e[n])}),Zi=un(function(t,e){sn(e,lo(e),t)}),Ki=un(function(t,e,n,r){sn(e,lo(e),t,r)}),Qi=un(function(t,e,n,r){sn(e,uo(e),t,r)}),to=Mn(Dt);var eo=ke(function(t,e){t=g(t);var n=-1,r=e.length,i=2<r?e[2]:rs;for(i&&Yn(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],s=lo(o),a=-1,u=s.length;++a<u;){var l=s[a],c=t[l];(c===rs||mi(c,h[l])&&!w.call(t,l))&&(t[l]=o[l])}return t}),no=ke(function(t){return t.push(rs,Tn),Da(ho,rs,t)});function ro(t,e,n){var r=null==t?rs:Kt(t,e);return r===rs?n:r}function io(t,e){return null!=t&&$n(t,e,re)}var oo=mn(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=p.call(e)),t[e]=n},Mo(Do)),so=mn(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=p.call(e)),w.call(t,e)?t[e].push(n):t[e]=[n]},Bn),ao=ke(oe);function uo(t){return _i(t)?kt(t):he(t)}function lo(t){return _i(t)?kt(t,!0):fe(t)}var co=un(function(t,e,n){me(t,e,n)}),ho=un(function(t,e,n,r){me(t,e,n,r)}),fo=Mn(function(e,t){var n={};if(null==e)return n;var r=!1;t=Ha(t,function(t){return t=Xe(t,e),r=r||1<t.length,t}),sn(e,Rn(e),n),r&&(n=Ft(n,7,Nn));for(var i=t.length;i--;)Ie(n,t[i]);return n});var po=Mn(function(t,e){return null==t?{}:function(n,t){return we(n,t,function(t,e){return io(n,e)})}(t,e)});function go(t,n){if(null==t)return{};var e=Ha(Rn(t),function(t){return[t]});return n=Bn(n),we(t,e,function(t,e){return n(t,e[0])})}var vo=Pn(uo),mo=Pn(lo);function yo(t){return null==t?[]:ou(t,uo(t))}var bo=fn(function(t,e,n){return e=e.toLowerCase(),t+(n?wo(e):e)});function wo(t){return Co(Yi(t).toLowerCase())}function xo(t){return(t=Yi(t))&&t.replace(pa,lu).replace(ya,"")}var Ao=fn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),_o=fn(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),So=hn("toLowerCase");var ko=fn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});var Po=fn(function(t,e,n){return t+(n?" ":"")+Co(e)});var Eo=fn(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Co=hn("toUpperCase");function To(t,e,n){return t=Yi(t),(e=n?rs:e)===rs?function(t){return wa.test(t)}(t)?function(t){return t.match(ba)||[]}(t):function(t){return t.match(oa)||[]}(t):t.match(e)||[]}var No=ke(function(t,e){try{return Da(t,rs,e)}catch(t){return Ei(t)?t:new i(t)}}),Lo=Mn(function(e,t){return Fa(t,function(t){t=pr(t),Rt(e,t,si(e[t],e))}),e});function Mo(t){return function(){return t}}var Oo=gn(),Ro=gn(!0);function Do(t){return t}function jo(t){return ce("function"==typeof t?t:Ft(t,1))}var Fo=ke(function(e,n){return function(t){return oe(t,e,n)}}),Bo=ke(function(e,n){return function(t){return oe(e,t,n)}});function Vo(r,e,t){var n=uo(e),i=Zt(e,n);null!=t||Li(e)&&(i.length||!n.length)||(t=e,e=r,r=this,i=Zt(e,uo(e)));var o=!(Li(t)&&"chain"in t&&!t.chain),s=Ci(r);return Fa(i,function(t){var n=e[t];r[t]=n,s&&(r.prototype[t]=function(){var t=this.__chain__;if(o||t){var e=r(this.__wrapped__);return(e.__actions__=on(this.__actions__)).push({func:n,args:arguments,thisArg:r}),e.__chain__=t,e}return n.apply(r,Ua([this.value()],arguments))})}),r}function Io(){}var zo=bn(Ha),qo=bn(Va),Ho=bn(Wa);function Uo(t){return Jn(t)?tu(pr(t)):function(e){return function(t){return Kt(t,e)}}(t)}var $o=xn(),Go=xn(!0);function Wo(){return[]}function Xo(){return!1}var Yo=yn(function(t,e){return t+e},0),Jo=Sn("ceil"),Zo=yn(function(t,e){return t/e},1),Ko=Sn("floor");var Qo,ts=yn(function(t,e){return t*e},1),es=Sn("round"),ns=yn(function(t,e){return t-e},0);return pt.after=function(t,e){if("function"!=typeof e)throw new y(is);return t=$i(t),function(){if(--t<1)return e.apply(this,arguments)}},pt.ary=ii,pt.assign=Ji,pt.assignIn=Zi,pt.assignInWith=Ki,pt.assignWith=Qi,pt.at=to,pt.before=oi,pt.bind=si,pt.bindAll=Lo,pt.bindKey=ai,pt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return xi(t)?t:[t]},pt.chain=Hr,pt.chunk=function(t,e,n){e=(n?Yn(t,e,n):e===rs)?1:G($i(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,s=k(V(r/e));i<r;)s[o++]=Me(t,i,i+=e);return s},pt.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},pt.concat=function(){var t=arguments.length;if(!t)return[];for(var e=k(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Ua(xi(n)?on(n):[n],Gt(e,1))},pt.cond=function(r){var i=null==r?0:r.length,e=Bn();return r=i?Ha(r,function(t){if("function"!=typeof t[1])throw new y(is);return[e(t[0]),t[1]]}):[],ke(function(t){for(var e=-1;++e<i;){var n=r[e];if(Da(n[0],this,t))return Da(n[1],this,t)}})},pt.conforms=function(t){return function(e){var n=uo(e);return function(t){return Bt(t,e,n)}}(Ft(t,1))},pt.constant=Mo,pt.countBy=Gr,pt.create=function(t,e){var n=gt(t);return null==e?n:Ot(n,e)},pt.curry=function t(e,n,r){var i=En(e,8,rs,rs,rs,rs,rs,n=r?rs:n);return i.placeholder=t.placeholder,i},pt.curryRight=function t(e,n,r){var i=En(e,16,rs,rs,rs,rs,rs,n=r?rs:n);return i.placeholder=t.placeholder,i},pt.debounce=ui,pt.defaults=eo,pt.defaultsDeep=no,pt.defer=li,pt.delay=ci,pt.difference=mr,pt.differenceBy=yr,pt.differenceWith=br,pt.drop=function(t,e,n){var r=null==t?0:t.length;return r?Me(t,(e=n||e===rs?1:$i(e))<0?0:e,r):[]},pt.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?Me(t,0,(e=r-(e=n||e===rs?1:$i(e)))<0?0:e):[]},pt.dropRightWhile=function(t,e){return t&&t.length?qe(t,Bn(e,3),!0,!0):[]},pt.dropWhile=function(t,e){return t&&t.length?qe(t,Bn(e,3),!0):[]},pt.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Yn(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=$i(n))<0&&(n=i<-n?0:i+n),(r=r===rs||i<r?i:$i(r))<0&&(r+=i),r=r<n?0:Gi(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},pt.filter=function(t,e){return(xi(t)?Ia:$t)(t,Bn(e,3))},pt.flatMap=function(t,e){return Gt(ti(t,e),1)},pt.flatMapDeep=function(t,e){return Gt(ti(t,e),1/0)},pt.flatMapDepth=function(t,e,n){return n=n===rs?1:$i(n),Gt(ti(t,e),n)},pt.flatten=Ar,pt.flattenDeep=function(t){return(null==t?0:t.length)?Gt(t,1/0):[]},pt.flattenDepth=function(t,e){return(null==t?0:t.length)?Gt(t,e=e===rs?1:$i(e)):[]},pt.flip=function(t){return En(t,512)},pt.flow=Oo,pt.flowRight=Ro,pt.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},pt.functions=function(t){return null==t?[]:Zt(t,uo(t))},pt.functionsIn=function(t){return null==t?[]:Zt(t,lo(t))},pt.groupBy=Zr,pt.initial=function(t){return(null==t?0:t.length)?Me(t,0,-1):[]},pt.intersection=Sr,pt.intersectionBy=kr,pt.intersectionWith=Pr,pt.invert=oo,pt.invertBy=so,pt.invokeMap=Kr,pt.iteratee=jo,pt.keyBy=Qr,pt.keys=uo,pt.keysIn=lo,pt.map=ti,pt.mapKeys=function(t,r){var i={};return r=Bn(r,3),Yt(t,function(t,e,n){Rt(i,r(t,e,n),t)}),i},pt.mapValues=function(t,r){var i={};return r=Bn(r,3),Yt(t,function(t,e,n){Rt(i,e,r(t,e,n))}),i},pt.matches=function(t){return ge(Ft(t,1))},pt.matchesProperty=function(t,e){return ve(t,Ft(e,1))},pt.memoize=hi,pt.merge=co,pt.mergeWith=ho,pt.method=Fo,pt.methodOf=Bo,pt.mixin=Vo,pt.negate=fi,pt.nthArg=function(e){return e=$i(e),ke(function(t){return ye(t,e)})},pt.omit=fo,pt.omitBy=function(t,e){return go(t,fi(Bn(e)))},pt.once=function(t){return oi(2,t)},pt.orderBy=function(t,e,n,r){return null==t?[]:(xi(e)||(e=null==e?[]:[e]),xi(n=r?rs:n)||(n=null==n?[]:[n]),be(t,e,n))},pt.over=zo,pt.overArgs=di,pt.overEvery=qo,pt.overSome=Ho,pt.partial=pi,pt.partialRight=gi,pt.partition=ei,pt.pick=po,pt.pickBy=go,pt.property=Uo,pt.propertyOf=function(e){return function(t){return null==e?rs:Kt(e,t)}},pt.pull=Cr,pt.pullAll=Tr,pt.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?xe(t,e,Bn(n,2)):t},pt.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?xe(t,e,rs,n):t},pt.pullAt=Nr,pt.range=$o,pt.rangeRight=Go,pt.rearg=vi,pt.reject=function(t,e){return(xi(t)?Ia:$t)(t,fi(Bn(e,3)))},pt.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Bn(e,3);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return Ae(t,i),n},pt.rest=function(t,e){if("function"!=typeof t)throw new y(is);return ke(t,e=e===rs?e:$i(e))},pt.reverse=Lr,pt.sampleSize=function(t,e,n){return e=(n?Yn(t,e,n):e===rs)?1:$i(e),(xi(t)?Et:Ee)(t,e)},pt.set=function(t,e,n){return null==t?t:Ce(t,e,n)},pt.setWith=function(t,e,n,r){return r="function"==typeof r?r:rs,null==t?t:Ce(t,e,n,r)},pt.shuffle=function(t){return(xi(t)?Ct:Le)(t)},pt.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n=n&&"number"!=typeof n&&Yn(t,e,n)?(e=0,r):(e=null==e?0:$i(e),n===rs?r:$i(n)),Me(t,e,n)):[]},pt.sortBy=ni,pt.sortedUniq=function(t){return t&&t.length?je(t):[]},pt.sortedUniqBy=function(t,e){return t&&t.length?je(t,Bn(e,2)):[]},pt.split=function(t,e,n){return n&&"number"!=typeof n&&Yn(t,e,n)&&(e=n=rs),(n=n===rs?ls:n>>>0)?(t=Yi(t))&&("string"==typeof e||null!=e&&!ji(e))&&!(e=Be(e))&&fu(t)?Je(yu(t),0,n):t.split(e,n):[]},pt.spread=function(r,i){if("function"!=typeof r)throw new y(is);return i=null==i?0:G($i(i),0),ke(function(t){var e=t[i],n=Je(t,0,i);return e&&Ua(n,e),Da(r,this,n)})},pt.tail=function(t){var e=null==t?0:t.length;return e?Me(t,1,e):[]},pt.take=function(t,e,n){return t&&t.length?Me(t,0,(e=n||e===rs?1:$i(e))<0?0:e):[]},pt.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?Me(t,(e=r-(e=n||e===rs?1:$i(e)))<0?0:e,r):[]},pt.takeRightWhile=function(t,e){return t&&t.length?qe(t,Bn(e,3),!1,!0):[]},pt.takeWhile=function(t,e){return t&&t.length?qe(t,Bn(e,3)):[]},pt.tap=function(t,e){return e(t),t},pt.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new y(is);return Li(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ui(t,e,{leading:r,maxWait:e,trailing:i})},pt.thru=Ur,pt.toArray=Hi,pt.toPairs=vo,pt.toPairsIn=mo,pt.toPath=function(t){return xi(t)?Ha(t,pr):Vi(t)?[t]:on(dr(Yi(t)))},pt.toPlainObject=Xi,pt.transform=function(t,r,i){var e=xi(t),n=e||ki(t)||Ii(t);if(r=Bn(r,4),null==i){var o=t&&t.constructor;i=n?e?new o:[]:Li(t)&&Ci(o)?gt(C(t)):{}}return(n?Fa:Yt)(t,function(t,e,n){return r(i,t,e,n)}),i},pt.unary=function(t){return ii(t,1)},pt.union=Mr,pt.unionBy=Or,pt.unionWith=Rr,pt.uniq=function(t){return t&&t.length?Ve(t):[]},pt.uniqBy=function(t,e){return t&&t.length?Ve(t,Bn(e,2)):[]},pt.uniqWith=function(t,e){return e="function"==typeof e?e:rs,t&&t.length?Ve(t,rs,e):[]},pt.unset=function(t,e){return null==t||Ie(t,e)},pt.unzip=Dr,pt.unzipWith=jr,pt.update=function(t,e,n){return null==t?t:ze(t,e,We(n))},pt.updateWith=function(t,e,n,r){return r="function"==typeof r?r:rs,null==t?t:ze(t,e,We(n),r)},pt.values=yo,pt.valuesIn=function(t){return null==t?[]:ou(t,lo(t))},pt.without=Fr,pt.words=To,pt.wrap=function(t,e){return pi(We(e),t)},pt.xor=Br,pt.xorBy=Vr,pt.xorWith=Ir,pt.zip=zr,pt.zipObject=function(t,e){return $e(t||[],e||[],Nt)},pt.zipObjectDeep=function(t,e){return $e(t||[],e||[],Ce)},pt.zipWith=qr,pt.entries=vo,pt.entriesIn=mo,pt.extend=Zi,pt.extendWith=Ki,Vo(pt,pt),pt.add=Yo,pt.attempt=No,pt.camelCase=bo,pt.capitalize=wo,pt.ceil=Jo,pt.clamp=function(t,e,n){return n===rs&&(n=e,e=rs),n!==rs&&(n=(n=Wi(n))==n?n:0),e!==rs&&(e=(e=Wi(e))==e?e:0),jt(Wi(t),e,n)},pt.clone=function(t){return Ft(t,4)},pt.cloneDeep=function(t){return Ft(t,5)},pt.cloneDeepWith=function(t,e){return Ft(t,5,e="function"==typeof e?e:rs)},pt.cloneWith=function(t,e){return Ft(t,4,e="function"==typeof e?e:rs)},pt.conformsTo=function(t,e){return null==e||Bt(t,e,uo(e))},pt.deburr=xo,pt.defaultTo=function(t,e){return null==t||t!=t?e:t},pt.divide=Zo,pt.endsWith=function(t,e,n){t=Yi(t),e=Be(e);var r=t.length,i=n=n===rs?r:jt($i(n),0,r);return 0<=(n-=e.length)&&t.slice(n,i)==e},pt.eq=mi,pt.escape=function(t){return(t=Yi(t))&&Us.test(t)?t.replace(qs,cu):t},pt.escapeRegExp=function(t){return(t=Yi(t))&&Ks.test(t)?t.replace(Zs,"\\$&"):t},pt.every=function(t,e,n){var r=xi(t)?Va:Ht;return n&&Yn(t,e,n)&&(e=rs),r(t,Bn(e,3))},pt.find=Wr,pt.findIndex=wr,pt.findKey=function(t,e){return Xa(t,Bn(e,3),Yt)},pt.findLast=Xr,pt.findLastIndex=xr,pt.findLastKey=function(t,e){return Xa(t,Bn(e,3),Jt)},pt.floor=Ko,pt.forEach=Yr,pt.forEachRight=Jr,pt.forIn=function(t,e){return null==t?t:Wt(t,Bn(e,3),lo)},pt.forInRight=function(t,e){return null==t?t:Xt(t,Bn(e,3),lo)},pt.forOwn=function(t,e){return t&&Yt(t,Bn(e,3))},pt.forOwnRight=function(t,e){return t&&Jt(t,Bn(e,3))},pt.get=ro,pt.gt=yi,pt.gte=bi,pt.has=function(t,e){return null!=t&&$n(t,e,ne)},pt.hasIn=io,pt.head=_r,pt.identity=Do,pt.includes=function(t,e,n,r){t=_i(t)?t:yo(t),n=n&&!r?$i(n):0;var i=t.length;return n<0&&(n=G(i+n,0)),Bi(t)?n<=i&&-1<t.indexOf(e,n):!!i&&-1<Ja(t,e,n)},pt.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:$i(n);return i<0&&(i=G(r+i,0)),Ja(t,e,i)},pt.inRange=function(t,e,n){return e=Ui(e),n===rs?(n=e,e=0):n=Ui(n),function(t,e,n){return t>=W(e,n)&&t<G(e,n)}(t=Wi(t),e,n)},pt.invoke=ao,pt.isArguments=wi,pt.isArray=xi,pt.isArrayBuffer=Ai,pt.isArrayLike=_i,pt.isArrayLikeObject=Si,pt.isBoolean=function(t){return!0===t||!1===t||Mi(t)&&te(t)==ds},pt.isBuffer=ki,pt.isDate=Pi,pt.isElement=function(t){return Mi(t)&&1===t.nodeType&&!Di(t)},pt.isEmpty=function(t){if(null==t)return!0;if(_i(t)&&(xi(t)||"string"==typeof t||"function"==typeof t.splice||ki(t)||Ii(t)||wi(t)))return!t.length;var e=Un(t);if(e==ys||e==_s)return!t.size;if(Qn(t))return!he(t).length;for(var n in t)if(w.call(t,n))return!1;return!0},pt.isEqual=function(t,e){return ae(t,e)},pt.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:rs)?n(t,e):rs;return r===rs?ae(t,e,rs,n):!!r},pt.isError=Ei,pt.isFinite=function(t){return"number"==typeof t&&H(t)},pt.isFunction=Ci,pt.isInteger=Ti,pt.isLength=Ni,pt.isMap=Oi,pt.isMatch=function(t,e){return t===e||ue(t,e,In(e))},pt.isMatchWith=function(t,e,n){return n="function"==typeof n?n:rs,ue(t,e,In(e),n)},pt.isNaN=function(t){return Ri(t)&&t!=+t},pt.isNative=function(t){if(Kn(t))throw new i("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return le(t)},pt.isNil=function(t){return null==t},pt.isNull=function(t){return null===t},pt.isNumber=Ri,pt.isObject=Li,pt.isObjectLike=Mi,pt.isPlainObject=Di,pt.isRegExp=ji,pt.isSafeInteger=function(t){return Ti(t)&&-as<=t&&t<=as},pt.isSet=Fi,pt.isString=Bi,pt.isSymbol=Vi,pt.isTypedArray=Ii,pt.isUndefined=function(t){return t===rs},pt.isWeakMap=function(t){return Mi(t)&&Un(t)==Ps},pt.isWeakSet=function(t){return Mi(t)&&"[object WeakSet]"==te(t)},pt.join=function(t,e){return null==t?"":U.call(t,e)},pt.kebabCase=Ao,pt.last=Er,pt.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==rs&&(i=(i=$i(n))<0?G(r+i,0):W(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):Ya(t,Ka,i,!0)},pt.lowerCase=_o,pt.lowerFirst=So,pt.lt=zi,pt.lte=qi,pt.max=function(t){return t&&t.length?Ut(t,Do,ee):rs},pt.maxBy=function(t,e){return t&&t.length?Ut(t,Bn(e,2),ee):rs},pt.mean=function(t){return Qa(t,Do)},pt.meanBy=function(t,e){return Qa(t,Bn(e,2))},pt.min=function(t){return t&&t.length?Ut(t,Do,de):rs},pt.minBy=function(t,e){return t&&t.length?Ut(t,Bn(e,2),de):rs},pt.stubArray=Wo,pt.stubFalse=Xo,pt.stubObject=function(){return{}},pt.stubString=function(){return""},pt.stubTrue=function(){return!0},pt.multiply=ts,pt.nth=function(t,e){return t&&t.length?ye(t,$i(e)):rs},pt.noConflict=function(){return Ea._===this&&(Ea._=x),this},pt.noop=Io,pt.now=ri,pt.pad=function(t,e,n){t=Yi(t);var r=(e=$i(e))?mu(t):0;if(!e||e<=r)return t;var i=(e-r)/2;return wn(I(i),n)+t+wn(V(i),n)},pt.padEnd=function(t,e,n){t=Yi(t);var r=(e=$i(e))?mu(t):0;return e&&r<e?t+wn(e-r,n):t},pt.padStart=function(t,e,n){t=Yi(t);var r=(e=$i(e))?mu(t):0;return e&&r<e?wn(e-r,n)+t:t},pt.parseInt=function(t,e,n){return e=n||null==e?0:e&&+e,Y(Yi(t).replace(ta,""),e||0)},pt.random=function(t,e,n){if(n&&"boolean"!=typeof n&&Yn(t,e,n)&&(e=n=rs),n===rs&&("boolean"==typeof e?(n=e,e=rs):"boolean"==typeof t&&(n=t,t=rs)),t===rs&&e===rs?(t=0,e=1):(t=Ui(t),e===rs?(e=t,t=0):e=Ui(e)),e<t){var r=t;t=e,e=r}if(n||t%1||e%1){var i=J();return W(t+i*(e-t+ka("1e-"+((i+"").length-1))),e)}return _e(t,e)},pt.reduce=function(t,e,n){var r=xi(t)?$a:eu,i=arguments.length<3;return r(t,Bn(e,4),n,i,zt)},pt.reduceRight=function(t,e,n){var r=xi(t)?Ga:eu,i=arguments.length<3;return r(t,Bn(e,4),n,i,qt)},pt.repeat=function(t,e,n){return e=(n?Yn(t,e,n):e===rs)?1:$i(e),Se(Yi(t),e)},pt.replace=function(){var t=arguments,e=Yi(t[0]);return t.length<3?e:e.replace(t[1],t[2])},pt.result=function(t,e,n){var r=-1,i=(e=Xe(e,t)).length;for(i||(i=1,t=rs);++r<i;){var o=null==t?rs:t[pr(e[r])];o===rs&&(r=i,o=n),t=Ci(o)?o.call(t):o}return t},pt.round=es,pt.runInContext=t,pt.sample=function(t){return(xi(t)?Pt:Pe)(t)},pt.size=function(t){if(null==t)return 0;if(_i(t))return Bi(t)?mu(t):t.length;var e=Un(t);return e==ys||e==_s?t.size:he(t).length},pt.snakeCase=ko,pt.some=function(t,e,n){var r=xi(t)?Wa:Oe;return n&&Yn(t,e,n)&&(e=rs),r(t,Bn(e,3))},pt.sortedIndex=function(t,e){return Re(t,e)},pt.sortedIndexBy=function(t,e,n){return De(t,e,Bn(n,2))},pt.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Re(t,e);if(r<n&&mi(t[r],e))return r}return-1},pt.sortedLastIndex=function(t,e){return Re(t,e,!0)},pt.sortedLastIndexBy=function(t,e,n){return De(t,e,Bn(n,2),!0)},pt.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Re(t,e,!0)-1;if(mi(t[n],e))return n}return-1},pt.startCase=Po,pt.startsWith=function(t,e,n){return t=Yi(t),n=null==n?0:jt($i(n),0,t.length),e=Be(e),t.slice(n,n+e.length)==e},pt.subtract=ns,pt.sum=function(t){return t&&t.length?nu(t,Do):0},pt.sumBy=function(t,e){return t&&t.length?nu(t,Bn(e,2)):0},pt.template=function(s,t,e){var n=pt.templateSettings;e&&Yn(s,t,e)&&(t=rs),s=Yi(s),t=Ki({},t,n,Cn);var a,u,r=Ki({},t.imports,n.imports,Cn),i=uo(r),o=ou(r,i),l=0,c=t.interpolate||ga,h="__p += '",f=m((t.escape||ga).source+"|"+c.source+"|"+(c===Ws?aa:ga).source+"|"+(t.evaluate||ga).source+"|$","g"),d="//# sourceURL="+(w.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Aa+"]")+"\n";s.replace(f,function(t,e,n,r,i,o){return n=n||r,h+=s.slice(l,o).replace(va,hu),e&&(a=!0,h+="' +\n__e("+e+") +\n'"),i&&(u=!0,h+="';\n"+i+";\n__p += '"),n&&(h+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=o+t.length,t}),h+="';\n";var p=w.call(t,"variable")&&t.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(u?h.replace(Bs,""):h).replace(Vs,"$1").replace(Is,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=No(function(){return v(i,d+"return "+h).apply(rs,o)});if(g.source=h,Ei(g))throw g;return g},pt.times=function(t,e){if((t=$i(t))<1||as<t)return[];var n=ls,r=W(t,ls);e=Bn(e),t-=ls;for(var i=ru(r,e);++n<t;)e(n);return i},pt.toFinite=Ui,pt.toInteger=$i,pt.toLength=Gi,pt.toLower=function(t){return Yi(t).toLowerCase()},pt.toNumber=Wi,pt.toSafeInteger=function(t){return t?jt($i(t),-as,as):0===t?t:0},pt.toString=Yi,pt.toUpper=function(t){return Yi(t).toUpperCase()},pt.trim=function(t,e,n){if((t=Yi(t))&&(n||e===rs))return t.replace(Qs,"");if(!t||!(e=Be(e)))return t;var r=yu(t),i=yu(e);return Je(r,au(r,i),uu(r,i)+1).join("")},pt.trimEnd=function(t,e,n){if((t=Yi(t))&&(n||e===rs))return t.replace(ea,"");if(!t||!(e=Be(e)))return t;var r=yu(t);return Je(r,0,uu(r,yu(e))+1).join("")},pt.trimStart=function(t,e,n){if((t=Yi(t))&&(n||e===rs))return t.replace(ta,"");if(!t||!(e=Be(e)))return t;var r=yu(t);return Je(r,au(r,yu(e))).join("")},pt.truncate=function(t,e){var n=30,r="...";if(Li(e)){var i="separator"in e?e.separator:i;n="length"in e?$i(e.length):n,r="omission"in e?Be(e.omission):r}var o=(t=Yi(t)).length;if(fu(t)){var s=yu(t);o=s.length}if(o<=n)return t;var a=n-mu(r);if(a<1)return r;var u=s?Je(s,0,a).join(""):t.slice(0,a);if(i===rs)return u+r;if(s&&(a+=u.length-a),ji(i)){if(t.slice(a).search(i)){var l,c=u;for(i.global||(i=m(i.source,Yi(ua.exec(i))+"g")),i.lastIndex=0;l=i.exec(c);)var h=l.index;u=u.slice(0,h===rs?a:h)}}else if(t.indexOf(Be(i),a)!=a){var f=u.lastIndexOf(i);-1<f&&(u=u.slice(0,f))}return u+r},pt.unescape=function(t){return(t=Yi(t))&&Hs.test(t)?t.replace(zs,bu):t},pt.uniqueId=function(t){var e=++f;return Yi(t)+e},pt.upperCase=Eo,pt.upperFirst=Co,pt.each=Yr,pt.eachRight=Jr,pt.first=_r,Vo(pt,(Qo={},Yt(pt,function(t,e){w.call(pt.prototype,e)||(Qo[e]=t)}),Qo),{chain:!1}),pt.VERSION="4.17.15",Fa(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){pt[t].placeholder=pt}),Fa(["drop","take"],function(n,r){bt.prototype[n]=function(t){t=t===rs?1:G($i(t),0);var e=this.__filtered__&&!r?new bt(this):this.clone();return e.__filtered__?e.__takeCount__=W(t,e.__takeCount__):e.__views__.push({size:W(t,ls),type:n+(e.__dir__<0?"Right":"")}),e},bt.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),Fa(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;bt.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Bn(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Fa(["head","last"],function(t,e){var n="take"+(e?"Right":"");bt.prototype[t]=function(){return this[n](1).value()[0]}}),Fa(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");bt.prototype[t]=function(){return this.__filtered__?new bt(this):this[n](1)}}),bt.prototype.compact=function(){return this.filter(Do)},bt.prototype.find=function(t){return this.filter(t).head()},bt.prototype.findLast=function(t){return this.reverse().find(t)},bt.prototype.invokeMap=ke(function(e,n){return"function"==typeof e?new bt(this):this.map(function(t){return oe(t,e,n)})}),bt.prototype.reject=function(t){return this.filter(fi(Bn(t)))},bt.prototype.slice=function(t,e){t=$i(t);var n=this;return n.__filtered__&&(0<t||e<0)?new bt(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==rs&&(n=(e=$i(e))<0?n.dropRight(-e):n.take(e-t)),n)},bt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},bt.prototype.toArray=function(){return this.take(ls)},Yt(bt.prototype,function(h,t){var f=/^(?:filter|find|map|reject)|While$/.test(t),d=/^(?:head|last)$/.test(t),p=pt[d?"take"+("last"==t?"Right":""):t],g=d||/^find/.test(t);p&&(pt.prototype[t]=function(){function t(t){var e=p.apply(pt,Ua([t],n));return d&&s?e[0]:e}var e=this.__wrapped__,n=d?[1]:arguments,r=e instanceof bt,i=n[0],o=r||xi(e);o&&f&&"function"==typeof i&&1!=i.length&&(r=o=!1);var s=this.__chain__,a=!!this.__actions__.length,u=g&&!s,l=r&&!a;if(g||!o)return u&&l?h.apply(this,n):(c=this.thru(t),u?d?c.value()[0]:c.value():c);e=l?e:new bt(this);var c=h.apply(e,n);return c.__actions__.push({func:Ur,args:[t],thisArg:rs}),new yt(c,s)})}),Fa(["pop","push","shift","sort","splice","unshift"],function(t){var n=s[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);pt.prototype[t]=function(){var e=arguments;if(!i||this.__chain__)return this[r](function(t){return n.apply(xi(t)?t:[],e)});var t=this.value();return n.apply(xi(t)?t:[],e)}}),Yt(bt.prototype,function(t,e){var n=pt[e];if(n){var r=n.name+"";w.call(ot,r)||(ot[r]=[]),ot[r].push({name:e,func:n})}}),ot[vn(rs,2).name]=[{name:"wrapper",func:rs}],bt.prototype.clone=function(){var t=new bt(this.__wrapped__);return t.__actions__=on(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=on(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=on(this.__views__),t},bt.prototype.reverse=function(){if(this.__filtered__){var t=new bt(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},bt.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=xi(t),r=e<0,i=n?t.length:0,o=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=W(e,t+s);break;case"takeRight":t=G(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,l=r?a:s-1,c=this.__iteratees__,h=c.length,f=0,d=W(u,this.__takeCount__);if(!n||!r&&i==u&&d==u)return He(t,this.__actions__);var p=[];t:for(;u--&&f<d;){for(var g=-1,v=t[l+=e];++g<h;){var m=c[g],y=m.iteratee,b=m.type,w=y(v);if(2==b)v=w;else if(!w){if(1==b)continue t;break t}}p[f++]=v}return p},pt.prototype.at=$r,pt.prototype.chain=function(){return Hr(this)},pt.prototype.commit=function(){return new yt(this.value(),this.__chain__)},pt.prototype.next=function(){this.__values__===rs&&(this.__values__=Hi(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?rs:this.__values__[this.__index__++]}},pt.prototype.plant=function(t){for(var e,n=this;n instanceof mt;){var r=vr(n);r.__index__=0,r.__values__=rs,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},pt.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof bt){var e=t;return this.__actions__.length&&(e=new bt(this)),(e=e.reverse()).__actions__.push({func:Ur,args:[Lr],thisArg:rs}),new yt(e,this.__chain__)}return this.thru(Lr)},pt.prototype.toJSON=pt.prototype.valueOf=pt.prototype.value=function(){return He(this.__wrapped__,this.__actions__)},pt.prototype.first=pt.prototype.head,O&&(pt.prototype[O]=function(){return this}),pt}();Ea._=wu,(z=function(){return wu}.call(q,H,q,I))===rs||(I.exports=z)}).call(this)}).call(this,H(1),H(2)(t))},function(t,e,n){"use strict";n.r(e);var s=n(0);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"addTo",value:function(t){this.instance.addTo(t)}}]),t}();function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c={size:{x:30,y:30}},h=function(){function o(t){var e,n=t.position,r=t.size,i=void 0===r?c.size:r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=a(this,u(o).call(this))).instance=new s.shapes.standard.Circle,e.instance.resize(i.x,i.y),e.instance.position(n.x,n.y),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,i),o}();function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var v=function(){function r(t){var e,n=t.position;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=d(this,p(r).call(this,{position:n}))).instance.resize(30,30),e.instance.attr("body/fill","#b1c5a4"),e.instance.attr("body/stroke","#48a01d"),e.instance.attr("body/stroke-width","1.5"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(r,h),r}();function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=function(){function r(t){var e,n=t.position;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=y(this,b(r).call(this,{position:n}))).instance.resize(30,30),e.instance.attr("body/fill","#cea7a7"),e.instance.attr("body/stroke","#a81919"),e.instance.attr("body/stroke-width","5"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(r,h),r}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(){function o(t){var e,n=t.source,r=t.target;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=_(this,S(o).call(this));var i=new s.shapes.standard.Link;return i.source(n.instance),i.target(r.instance),i.attr({line:{strokeWidth:1,stroke:"#222222"}}),e.instance=i,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(o,i),o}(),E={startEvent:function(t){return new v(t)},endEvent:function(t){return new x(t)},link:function(t){return new P(t)}};function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var T=function(){function e(t){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.shapes=E,this.add=Object.keys(this.shapes).reduce(function(t,n){return t[n]=function(t){var e=r.shapes[n](t);return e.addTo(r.graph),e},t},{})}return function(t,e,n){e&&C(t.prototype,e),n&&C(t,n)}(e,[{key:"setupShapes",value:function(r){var i=this;this.add=Object.keys(this.shapes).reduce(function(t,n){return t[n]=function(t){var e=i.shapes[n](t);return e.addTo(r),e},t},{})}},{key:"makeGraph",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};return new s.dia.Graph(e,{cellNamespace:s.shapes})}},{key:"init",value:function(t){return this.graph=t||this.makeGraph(),this.paper=new s.dia.Paper({el:this.$el,width:this.$el.clientWidth,height:this.$el.clientHeight,gridSize:1,model:this.graph,cellViewNamespace:s.shapes}),this.setupShapes(this.graph),this}},{key:"clear",value:function(){this.graph.clear()}},{key:"export",value:function(){return this.graph.toJSON()}},{key:"from",value:function(t){var e=this.makeGraph();return this.init(e.fromJSON(t))}}]),e}();n(4);function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){return!e||"object"!==N(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var R=function(){function n(t){var e=t.container;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),L(this,M(n).call(this,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(n,T),n}();e.default=R}],i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=8)).default;function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,r});
//# sourceMappingURL=ApiaBoard.js.map